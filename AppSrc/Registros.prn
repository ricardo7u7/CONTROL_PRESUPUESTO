Compiling Program: C:\DataFlex Projects\PRESUPUESTO18\AppSrc\Registros.src
Memory Available: 2147483647
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\dfallent.pkd)
75288>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardCommandBarSystem.pkg)
75288>>>// these are all the packages used in a standard MDI menubar/toolbar system
75288>>>
75288>>>Use cCJCommandBarSystem.pkg
75288>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardMenuItemClasses.pkg)
75288>>>>>Use Dfpanel.pkg
75288>>>>>Use cCJCommandBarSystem.pkg
75288>>>>>Use LanguageText.pkg
75288>>>>>
75288>>>>>
75288>>>>>Class cCJUndoMenuItem is a cCJMenuItem
75289>>>>>    
75289>>>>>    Procedure Construct_Object
75291>>>>>        Forward Send Construct_Object
75293>>>>>        Set psCaption   to C_$CaptionUndo
75294>>>>>        Set psToolTip to C_$ToolTipUndo
75295>>>>>        Set psDescription to C_$DescUndo
75296>>>>>        Set psImage to "ActionUndo.ico"
75297>>>>>        Set pbActiveUpdate to True
75298>>>>>        Set psCategory to C_$CategoryEdit
75299>>>>>        Set psShortcut to C_$Key_Ctrl_Z
75300>>>>>    End_Procedure
75301>>>>>
75301>>>>>    Procedure OnExecute Variant vCommandBarControl
75303>>>>>        Send Undo of (focus(Self))
75304>>>>>    End_Procedure
75305>>>>>    
75305>>>>>    Function IsEnabled Returns Boolean
75307>>>>>        Boolean bEnabled
75307>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
75308>>>>>        Function_Return bEnabled
75309>>>>>    End_Function
75310>>>>>         
75310>>>>>End_Class
75311>>>>>
75311>>>>>
75311>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
75312>>>>>    
75312>>>>>    Procedure Construct_Object
75314>>>>>        Forward Send Construct_Object
75316>>>>>        Set psCaption   to C_$CaptionDelete
75317>>>>>        Set psToolTip to C_$ToolTipDelete
75318>>>>>        Set psDescription to C_$DescDelete
75319>>>>>        Set psImage to "actionDelete.ico"
75320>>>>>        Set psShortcut to C_$Key_Delete
75321>>>>>        Set pbActiveUpdate to True
75322>>>>>        Set psCategory to C_$CategoryEdit
75323>>>>>    End_Procedure
75324>>>>>
75324>>>>>
75324>>>>>    Procedure OnExecute Variant vCommandBarControl
75326>>>>>        Send Delete of (focus(Self))
75327>>>>>    End_Procedure
75328>>>>>    
75328>>>>>    Function IsEnabled Returns Boolean
75330>>>>>        Boolean bEnabled
75330>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
75331>>>>>        Function_Return bEnabled
75332>>>>>    End_Function
75333>>>>>         
75333>>>>>End_Class
75334>>>>>
75334>>>>>
75334>>>>>Class cCJCutMenuItem is a cCJMenuItem
75335>>>>>    
75335>>>>>    Procedure Construct_Object
75337>>>>>        Forward Send Construct_Object
75339>>>>>        Set psCaption   to C_$CaptionCut
75340>>>>>        Set psToolTip to C_$TooltipCut
75341>>>>>        Set psDescription to C_$DescCut
75342>>>>>        Set psImage to "actionCut.ico"
75343>>>>>        Set psShortcut to C_$Key_Ctrl_X
75344>>>>>        Set pbActiveUpdate to True
75345>>>>>        Set psCategory to C_$CategoryEdit
75346>>>>>    End_Procedure
75347>>>>>
75347>>>>>
75347>>>>>    Procedure OnExecute Variant vCommandBarControl
75349>>>>>        Send Cut of (focus(Self))
75350>>>>>    End_Procedure
75351>>>>>    
75351>>>>>    Function IsEnabled Returns Boolean
75353>>>>>        Boolean bEnabled
75353>>>>>        Get CanCut of (Focus(Self)) to bEnabled
75354>>>>>        Function_Return bEnabled
75355>>>>>    End_Function
75356>>>>>         
75356>>>>>End_Class
75357>>>>>
75357>>>>>
75357>>>>>Class cCJCopyMenuItem is a cCJMenuItem
75358>>>>>    
75358>>>>>    Procedure Construct_Object
75360>>>>>        Forward Send Construct_Object
75362>>>>>        Set psCaption   to C_$CaptionCopy
75363>>>>>        Set psToolTip to C_$ToolTipCopy
75364>>>>>        Set psDescription to C_$DescCopy
75365>>>>>        Set psImage to "actionCopy.ico"
75366>>>>>        Set psShortcut to C_$Key_Ctrl_C
75367>>>>>        Set pbActiveUpdate to True
75368>>>>>        Set psCategory to C_$CategoryEdit
75369>>>>>    End_Procedure
75370>>>>>
75370>>>>>
75370>>>>>    Procedure OnExecute Variant vCommandBarControl
75372>>>>>        Send Copy of (focus(Self))
75373>>>>>    End_Procedure
75374>>>>>    
75374>>>>>    Function IsEnabled Returns Boolean
75376>>>>>        Boolean bEnabled
75376>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
75377>>>>>        Function_Return bEnabled
75378>>>>>    End_Function
75379>>>>>         
75379>>>>>End_Class
75380>>>>>
75380>>>>>
75380>>>>>Class cCJPasteMenuItem is a cCJMenuItem
75381>>>>>    
75381>>>>>    Procedure Construct_Object
75383>>>>>        Forward Send Construct_Object
75385>>>>>        Set psCaption   to C_$CaptionPaste
75386>>>>>        Set psToolTip to C_$ToolTipPaste
75387>>>>>        Set psDescription to C_$DescPaste
75388>>>>>        Set psImage to "actionPaste.ico"
75389>>>>>        Set pbActiveUpdate to True
75390>>>>>        Set psShortcut to C_$Key_Ctrl_V
75391>>>>>        Set psCategory to C_$CategoryEdit
75392>>>>>    End_Procedure
75393>>>>>
75393>>>>>
75393>>>>>    Procedure OnExecute Variant vCommandBarControl
75395>>>>>        Send Paste of (focus(Self))
75396>>>>>    End_Procedure
75397>>>>>    
75397>>>>>    Function IsEnabled Returns Boolean
75399>>>>>        Boolean bEnabled
75399>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
75400>>>>>        Function_Return bEnabled
75401>>>>>    End_Function
75402>>>>>         
75402>>>>>End_Class
75403>>>>>
75403>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
75404>>>>>    
75404>>>>>    Procedure Construct_Object
75406>>>>>        Forward Send Construct_Object
75408>>>>>        Set psCaption   to C_$CaptionSelectAll
75409>>>>>        Set psToolTip to C_$ToolTipSelectAll
75410>>>>>        Set psDescription to C_$DescSelectAll
75411>>>>>        Set pbActiveUpdate to True
75412>>>>>        Set psShortcut to C_$Key_Ctrl_A
75413>>>>>        Set psCategory to C_$CategoryEdit
75414>>>>>    End_Procedure
75415>>>>>
75415>>>>>
75415>>>>>    Procedure OnExecute Variant vCommandBarControl
75417>>>>>        Send Select_All of (focus(Self))
75418>>>>>    End_Procedure
75419>>>>>    
75419>>>>>    Function IsEnabled Returns Boolean
75421>>>>>        Boolean bEnabled
75421>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
75422>>>>>        Function_Return bEnabled
75423>>>>>    End_Function
75424>>>>>         
75424>>>>>End_Class
75425>>>>>
75425>>>>> 
75425>>>>>Class cCJExitMenuItem is a cCJMenuItem
75426>>>>>
75426>>>>>    Procedure Construct_Object
75428>>>>>        Forward Send Construct_Object
75430>>>>>        Set psCaption to C_$CaptionExit
75431>>>>>        Set psToolTip to C_$ToolTipExit
75432>>>>>        Set psDescription to C_$ToolTipExit
75433>>>>>        Set psShortcut to C_$Key_Alt_F4
75434>>>>>        Set psCategory to C_$CategoryFile
75435>>>>>    End_Procedure
75436>>>>>
75436>>>>>    Procedure OnExecute Variant vCommandBarControl
75438>>>>>        Send Exit_Application of Desktop
75439>>>>>    End_Procedure
75440>>>>>
75440>>>>>End_Class           
75441>>>>>
75441>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
75442>>>>>
75442>>>>>    Procedure Construct_Object
75444>>>>>        Forward Send Construct_Object
75446>>>>>        Set psCaption to C_$CaptionHelp
75447>>>>>        Set psDescription to C_$ToolTipHelp
75448>>>>>        Set psToolTip to C_$DescHelp
75449>>>>>        Set psImage to "ActionHelp.ico"
75450>>>>>        Set psShortcut to "F1"
75451>>>>>        Set psCategory to C_$CategoryHelp
75452>>>>>    End_Procedure
75453>>>>>    
75453>>>>>    Procedure OnExecute Variant vCommandBarControl
75455>>>>>        Send Help of (Focus(Self))
75456>>>>>    End_Procedure
75457>>>>>
75457>>>>>End_Class
75458>>>>>
75458>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
75459>>>>>
75459>>>>>    Procedure Construct_Object
75461>>>>>        Forward Send Construct_Object
75463>>>>>        Set psCaption to C_$CaptionAddStatusbar
75464>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
75465>>>>>        Set psDescription to  C_$DescAddStatusbar
75466>>>>>        Set psCategory to C_$CategoryWindow
75467>>>>>    End_Procedure
75468>>>>>
75468>>>>>    Procedure OnExecute Variant vCommandBarControl
75470>>>>>        Handle hoCommandBars hoClientArea
75470>>>>>        Get CommandBarSystemObject to hoCommandBars
75471>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75472>>>>>        If hoClientArea Begin
75474>>>>>            // the clientarea's parent panel has message
75474>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
75475>>>>>        End
75475>>>>>>
75475>>>>>    End_Procedure
75476>>>>>
75476>>>>>     Function IsChecked Returns Boolean
75478>>>>>        Boolean bOn
75478>>>>>        Handle hoCommandBars hoClientArea
75478>>>>>        Get CommandBarSystemObject to hoCommandBars
75479>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75480>>>>>        If hoClientArea Begin
75482>>>>>            // the clientarea's parent panel has message
75482>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
75483>>>>>        End
75483>>>>>>
75483>>>>>        Function_Return bOn
75484>>>>>     End_Function
75485>>>>>End_Class
75486>>>>>
75486>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
75487>>>>>
75487>>>>>    Procedure Construct_Object
75489>>>>>        Forward Send Construct_Object
75491>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
75492>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
75493>>>>>        Set psDescription to C_$DescAutoArrangeIcons
75494>>>>>        Set psCategory to C_$CategoryWindow
75495>>>>>    End_Procedure
75496>>>>>
75496>>>>>    Procedure OnExecute Variant vCommandBarControl
75498>>>>>        Handle hoCommandBars hoClientArea
75498>>>>>        Get CommandBarSystemObject to hoCommandBars
75499>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75500>>>>>        If hoClientArea Begin
75502>>>>>            // the clientarea's parent panel has message
75502>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
75503>>>>>        End
75503>>>>>>
75503>>>>>    End_Procedure
75504>>>>>    
75504>>>>>     Function IsChecked Returns Boolean
75506>>>>>        Boolean bOn
75506>>>>>        Handle hoCommandBars hoClientArea
75506>>>>>        Get CommandBarSystemObject to hoCommandBars
75507>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75508>>>>>        If hoClientArea Begin
75510>>>>>            // the clientarea's parent panel has message
75510>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
75511>>>>>        End
75511>>>>>>
75511>>>>>        Function_Return bOn
75512>>>>>     End_Function
75513>>>>>End_Class
75514>>>>>
75514>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
75515>>>>>
75515>>>>>    Procedure Construct_Object
75517>>>>>        Forward Send Construct_Object
75519>>>>>        Set psCaption to C_$CaptionRestoreMenus
75520>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
75521>>>>>        Set psDescription to C_$DescRestoreMenus
75522>>>>>        Set psCategory to C_$CategoryWindow
75523>>>>>    End_Procedure
75524>>>>>
75524>>>>>    Procedure OnExecute Variant vCommandBarControl
75526>>>>>        Handle hoCommandBars
75526>>>>>        Get CommandBarSystemObject to hoCommandBars
75527>>>>>        Send RestoreLayout of hoCommandBars
75528>>>>>    End_Procedure
75529>>>>>    
75529>>>>>End_Class
75530>>>>>
75530>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
75531>>>>>
75531>>>>>    Procedure Construct_Object
75533>>>>>        Forward Send Construct_Object
75535>>>>>        Set psCaption to C_$CaptionCascade
75536>>>>>        Set psToolTip to C_$ToolTipCascade
75537>>>>>        Set psDescription to  C_$DescCascade
75538>>>>>        Set psImage to "ActionCascade.ico"
75539>>>>>        Set psCategory to C_$CategoryWindow
75540>>>>>    End_Procedure
75541>>>>>    
75541>>>>>    Procedure OnExecute Variant vCommandBarControl
75543>>>>>        Handle hoCommandBars hoClientArea
75543>>>>>        Get CommandBarSystemObject to hoCommandBars
75544>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75545>>>>>        If hoClientArea Begin
75547>>>>>            Send Cascade_Windows of hoClientArea
75548>>>>>        End
75548>>>>>>
75548>>>>>    End_Procedure
75549>>>>>End_Class
75550>>>>>
75550>>>>>Class cCJTileHorizontally is a cCJMenuItem
75551>>>>>
75551>>>>>    Procedure Construct_Object
75553>>>>>        Forward Send Construct_Object
75555>>>>>        Set psCaption to C_$CaptionTileHorizontally 
75556>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
75557>>>>>        Set psDescription to  C_$DescTileHorizontally
75558>>>>>        Set psImage to "ActionTileHorizontally.ico"
75559>>>>>        Set psCategory to C_$CategoryWindow
75560>>>>>    End_Procedure
75561>>>>>
75561>>>>>    Procedure OnExecute Variant vCommandBarControl
75563>>>>>        Handle hoCommandBars hoClientArea
75563>>>>>        Get CommandBarSystemObject to hoCommandBars
75564>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75565>>>>>        If hoClientArea Begin
75567>>>>>            Send Tile_Windows_Horizontal of hoClientArea
75568>>>>>        End
75568>>>>>>
75568>>>>>    End_Procedure
75569>>>>>End_Class
75570>>>>>
75570>>>>>Class cCJTileVertically is a cCJMenuItem
75571>>>>>
75571>>>>>    Procedure Construct_Object
75573>>>>>        Forward Send Construct_Object
75575>>>>>        Set psCaption to C_$CaptionTileVertically  
75576>>>>>        Set psToolTip to C_$ToolTipTileVertically
75577>>>>>        Set psDescription to  C_$DescTileVertically
75578>>>>>        Set psImage to "ActionTileVertically.ico"
75579>>>>>        Set psCategory to C_$CategoryWindow
75580>>>>>    End_Procedure
75581>>>>>
75581>>>>>    Procedure OnExecute Variant vCommandBarControl
75583>>>>>        Handle hoCommandBars hoClientArea
75583>>>>>        Get CommandBarSystemObject to hoCommandBars
75584>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75585>>>>>        If hoClientArea Begin
75587>>>>>            Send Tile_Windows_Vertical of hoClientArea
75588>>>>>        End
75588>>>>>>
75588>>>>>    End_Procedure
75589>>>>>End_Class
75590>>>>>
75590>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
75591>>>>>
75591>>>>>    Procedure Construct_Object
75593>>>>>        Forward Send Construct_Object
75595>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
75596>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
75597>>>>>        Set psDescription to  C_$DescMinimizeWindows
75598>>>>>        Set psCategory to C_$CategoryWindow
75599>>>>>    End_Procedure
75600>>>>>
75600>>>>>    Procedure OnExecute Variant vCommandBarControl
75602>>>>>        Handle hoCommandBars hoClientArea
75602>>>>>        Get CommandBarSystemObject to hoCommandBars
75603>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75604>>>>>        If hoClientArea Begin
75606>>>>>            // the clientarea's parent panel has message
75606>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
75607>>>>>        End
75607>>>>>>
75607>>>>>    End_Procedure
75608>>>>>End_Class
75609>>>>>
75609>>>>>
75609>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
75610>>>>>
75610>>>>>    Procedure Construct_Object
75612>>>>>        Forward Send Construct_Object
75614>>>>>        Set psCaption to C_$CaptionRestoreWindows
75615>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
75616>>>>>        Set psDescription to  C_$DescRestoreWindows
75617>>>>>        Set psCategory to C_$CategoryWindow
75618>>>>>    End_Procedure
75619>>>>>
75619>>>>>    Procedure OnExecute Variant vCommandBarControl
75621>>>>>        Handle hoCommandBars hoClientArea
75621>>>>>        Get CommandBarSystemObject to hoCommandBars
75622>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75623>>>>>        If hoClientArea Begin
75625>>>>>            // the clientarea's parent panel has message
75625>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
75626>>>>>        End
75626>>>>>>
75626>>>>>    End_Procedure
75627>>>>>End_Class
75628>>>>>
75628>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
75629>>>>>
75629>>>>>    Procedure Construct_Object
75631>>>>>        Forward Send Construct_Object
75633>>>>>        Set psCaption to C_$CaptionArrangeIcons  
75634>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
75635>>>>>        Set psDescription to  C_$DescArrangeIcons
75636>>>>>        Set psCategory to C_$CategoryWindow
75637>>>>>    End_Procedure
75638>>>>>
75638>>>>>    Procedure OnExecute Variant vCommandBarControl
75640>>>>>        Handle hoCommandBars hoClientArea
75640>>>>>        Get CommandBarSystemObject to hoCommandBars
75641>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75642>>>>>        If hoClientArea Begin
75644>>>>>            Send Arrange_Icons of hoClientArea
75645>>>>>        End
75645>>>>>>
75645>>>>>    End_Procedure
75646>>>>>
75646>>>>>End_Class
75647>>>>>    
75647>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJAboutMenuItem.pkg)
75647>>>>>Use cCJCommandBarSystem.pkg
75647>>>>>Use LanguageText.pkg
75647>>>>>
75647>>>>>// It is expected that if you use this class that you provide an about object that is
75647>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
75647>>>>>// because you may wish to create your own custom about package.
75647>>>>>
75647>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
75648>>>>>
75648>>>>>    Procedure Construct_Object
75650>>>>>        Forward Send Construct_Object
75652>>>>>        Set psCaption to C_$CaptionAbout
75653>>>>>        Set psDescription to C_$ToolTipAbout
75654>>>>>        Set psToolTip to C_$DescAbout
75655>>>>>        Set psImage to "ActionAbout.ico"
75656>>>>>        Set psCategory to C_$CategoryHelp
75657>>>>>    End_Procedure
75658>>>>>    
75658>>>>>    Procedure OnExecute Variant vCommandBarControl
75660>>>>>        Handle hoCommandBars hoClientArea
75660>>>>>        Get CommandBarSystemObject to hoCommandBars
75661>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75662>>>>>        If hoClientArea Begin
75664>>>>>            Send Activate_About of hoClientArea
75665>>>>>        End
75665>>>>>>
75665>>>>>    End_Procedure
75666>>>>>
75666>>>>>End_Class
75667>>>>>
75667>>>>>
75667>>>Use cCJDeoMenuItemClasses.pkg
75667>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJMDIWindowsMenuItem.pkg)
75667>>>>>Use cCJCommandBarSystem.pkg
75667>>>>>
75667>>>>>Register_Function Client_ID Returns Integer
75667>>>>>
75667>>>>>// only used by cCJMDIWIndowsMenuItem
75667>>>>>Class cCJMDIWindowItem is a cCJMenuItem
75668>>>>>
75668>>>>>    Procedure Construct_Object
75670>>>>>        Forward Send Construct_Object
75672>>>>>        Property Handle phWindow 0 // object id of view
75673>>>>>        Set pbControlFlagNoMovable to True
75674>>>>>        Set pbActiveUpdate to True
75675>>>>>    End_Procedure
75676>>>>>    
75676>>>>>    Procedure OnExecute Variant vCommandBarControl
75678>>>>>        Handle hWindow
75678>>>>>        Get phWindow to hWindow
75679>>>>>        Send Activate_View of hWindow
75680>>>>>    End_Procedure
75681>>>>>    
75681>>>>>End_Class                
75682>>>>>
75682>>>>>
75682>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
75683>>>>>    
75683>>>>>    Procedure Construct_Object
75685>>>>>        Forward Send Construct_Object
75687>>>>>        Property Handle[] phArrayOfWindows
75688>>>>>        Set peControlType to xtpControlPopup
75689>>>>>        Set psCategory to C_$CategoryWindow
75690>>>>>    End_Procedure
75691>>>>>    
75691>>>>>     // This adds MDI windows to the existing menu items.
75691>>>>>     // This removes any existing windows menus and always adds a new set to the end
75691>>>>>
75691>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
75693>>>>>        Handle  hClientArea hView
75693>>>>>        String  sLabel
75693>>>>>        Integer i iWindows
75693>>>>>        Handle[] hArrayOfWindows
75694>>>>>        Variant vItem
75694>>>>>        
75694>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
75694>>>>>        // also assume that destroying an action removes all menu instances of that action
75694>>>>>        Get phArrayOfWindows to hArrayOfWindows
75695>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
75696>>>>>        For i from 0 to (iWindows-1)
75702>>>>>>
75702>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
75703>>>>>        Loop
75704>>>>>>
75704>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
75705>>>>>
75705>>>>>        // Add all views to this menu. Create the action and add the item
75705>>>>>        Move 0 to i
75706>>>>>        Get Client_Id to hClientArea // object id of client area
75707>>>>>        If (hClientArea > 0) Begin
75709>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
75710>>>>>            While (hView <> 0)
75714>>>>>                If (Active_State(hView)) Begin
75716>>>>>                    // create the action
75716>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
75717>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
75718>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
75719>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
75720>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
75722>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
75723>>>>>                    End
75723>>>>>>
75723>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
75724>>>>>                    If (i=0) Begin
75726>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
75727>>>>>                    End
75727>>>>>>
75727>>>>>                    // Create a menu item for this action
75727>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
75728>>>>>                    Increment i
75729>>>>>                End
75729>>>>>>
75729>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
75730>>>>>            Loop
75731>>>>>>
75731>>>>>        End
75731>>>>>>
75731>>>>>
75731>>>>>        Set phArrayOfWindows to hArrayOfWindows
75732>>>>>
75732>>>>>     End_Procedure
75733>>>>>     
75733>>>>>End_Class
75734>>>>>
75734>
75734>Object oHtmlHelp is a cHtmlHelp
75736>End_Object
75737>
75737>Object oApplication is a cApplication
75739>    Set peHelpType to htHtmlHelp
75740>End_Object
75741>
75741>Object oToolTipController is a cToolTipController
75743>    Move Self to ghoToolTipController
75744>End_Object
75745>
75745>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oEditContextMenu.pkg)
75745>>>Use cCJStandardMenuItemClasses.pkg
75745>>>
75745>>>Object oEditContextMenu is a cCJContextMenu
75747>>>    
75747>>>    Move Self to Default_Form_Floating_Menu_ID
75748>>>    
75748>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75750>>>    End_Object
75751>>>    
75751>>>    Object oCutMenuItem is a cCJCutMenuItem
75753>>>        Set pbControlBeginGroup to True
75754>>>    End_Object
75755>>>    
75755>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75757>>>    End_Object
75758>>>
75758>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75760>>>    End_Object
75761>>>
75761>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75763>>>    End_Object
75764>>>
75764>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75766>>>        Set pbControlBeginGroup to True
75767>>>    End_Object
75768>>>
75768>>>End_Object
75769>>>
75769>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oDEOEditContextMenu17.pkg)
75769>>>Use Windows.pkg
75769>>>Use cCJStandardMenuItemClasses.pkg
75769>>>Use cCJDeoMenuItemClasses.pkg
75769>>>
75769>>>
75769>>>Object oDEOEditContextMenu17 is a cCJContextMenu
75771>>>    
75771>>>    Move Self to Default_dbFloating_Menu_ID
75772>>>    
75772>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75774>>>    End_Object
75775>>>    
75775>>>    Object oCutMenuItem is a cCJCutMenuItem
75777>>>        Set pbControlBeginGroup to True
75778>>>    End_Object
75779>>>    
75779>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75781>>>    End_Object
75782>>>
75782>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75784>>>    End_Object
75785>>>
75785>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75787>>>    End_Object
75788>>>
75788>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75790>>>        Set pbControlBeginGroup to True
75791>>>    End_Object
75792>>>
75792>>>    Object oPromptMenuItem is a cCJPromptMenuItem
75794>>>        Set pbControlBeginGroup to True
75795>>>    End_Object
75796>>>
75796>>>    Object oFindNextMenu is a cCJFindNextMenuItem
75798>>>        Set pbControlBeginGroup to True
75799>>>    End_Object
75800>>>
75800>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75802>>>    End_Object
75803>>>
75803>>>    Object oClearMenuItem is a cCJClearMenuItem
75805>>>        Set pbControlBeginGroup to True
75806>>>    End_Object
75807>>>
75807>>>    Object oClearAllMenu is a cCJClearAllMenuItem
75809>>>    End_Object
75810>>>
75810>>>    Object oSaveMenu is a cCJSaveMenuItem
75812>>>    End_Object
75813>>>    
75813>>>    Object oDeleteMenu is a cCJDeleteMenuItem
75815>>>    End_Object
75816>>>
75816>>>    Object oRememberitem is a cCJRememberFieldMenuItem
75818>>>        Set pbControlBeginGroup to True
75819>>>    End_Object
75820>>>
75820>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
75822>>>    End_Object
75823>>>
75823>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
75825>>>    End_Object
75826>>>
75826>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
75828>>>    End_Object
75829>>>
75829>>>End_Object
75830>
75830>Object oMain is a Panel
75832>    Set Label to "CUBE Systems"
75833>    Set Location to 4 3
75834>    Set Size to 300 450
75835>       
75835>//FUNCIONES GLOBALES
75835>Function fSQL_date Global Date d_Fecha Returns String
75837>    Local String  s_Fecha
75837>    Local Integer i_Formato
75837>
75837>    Get_date_format to i_formato
75838>
75838>    Move "'" to s_Fecha
75839>    //Move "" to s_Fecha
75839>
75839>    If i_Formato eq 0 Begin  // Fecha formato USA mes/dia/año
75841>        Append s_Fecha (Mid(d_Fecha,4,7))
75842>        Append s_Fecha (Mid(d_Fecha,2,1))
75843>        Append s_Fecha (Mid(d_Fecha,2,4))
75844>    End
75844>    If i_formato eq 1 Begin  // Fecha formato europeo dia/mes/año
75846>        Append s_Fecha (Mid(d_Fecha,4,7))
75847>        Append s_Fecha (Mid(d_Fecha,2,4))
75848>        Append s_Fecha (Mid(d_Fecha,2,1))
75849>    End
75849>    If i_formato eq 2 Begin  // Fecha formato militar año/mes/dia
75851>        Append s_Fecha (Mid(d_Fecha,4,1))
75852>        Append s_Fecha (Mid(d_Fecha,2,6))
75853>        Append s_Fecha (Mid(d_Fecha,2,9))
75854>    End
75854>
75854>    Append s_Fecha "'"
75855>    Function_Return s_Fecha
75856>End_Function
75857>
75857>
75857>
75857>    DFCreate_Menu Main_Menu
75860>    //        #INCLUDE File_PM_Espanol.inc
75860>    
75860>        DFCreate_Menu "&Opciones" ViewPopupMenu is a ViewPopupMenu
75864>            On_Item "Catalogo Egresos"                   Send Activate_TIPO_GASTO
75865>            On_Item "Catalogo Tarjetas de Cr‚dito"       Send Activate_TARJETA
75866>            On_Item "TARJETA" Send Activate_TARJETA
75867>        End_Pull_Down
75869>            
75869>        DFCreate_Menu "&Opciones" ViewPopupMenu1 is a ViewPopupMenu
75873>            On_Item "Control Ahorros"                    Send Activate_AHORRO
75874>            On_Item "Control Egresos"                    Send Activate_Egresos
75875>            On_Item "Control Deudas"                     Send Activate_Deudas
75876>        End_Pull_Down
75878>        
75878>        DFCreate_Menu "&Reportes" ViewPopupMenu2 is a ViewPopupMenu
75882>            On_Item "Grafica de Gastos"                  Send Activate_GASTOS_01
75883>            On_Item "Listado de Gastos"                  Send Activate_GASTOS_02
75884>        End_Pull_Down
75886>        
75886>        Set Status_Help to "Available Views"
75887>    End_Menu
75889>    
75889>    Use DltToolbar.pkg
Including file: DltToolbar.pkg    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\DltToolbar.pkg)
75889>>>Use cToolbar.pkg
75889>>>
75889>>>// A toolbar for the Contacts sample.
75889>>>// shows:
75889>>>//    Buttons with text underneath (toolbar's pbShowLabels property set to True, and each button's psLabel property to the text)
75889>>>//    Multiline tooltips (embed "\n" in the psTooltip property to force a newline)
75889>>>//    "Hot" images, using a second imagelist (set the phoImageListHot property)
75889>>>
75889>>>Object oToolBar is a cToolBar
75891>>>    Set pbShowLabels To True // display the psLabel property on th button
75892>>>    Object oImages is a cImageList
75894>>>        Set piMaxImages To 12
75895>>>        Procedure OnCreate
75898>>>            Integer iVoid
75898>>>            Get AddTransparentImage "bgn.bmp"      clLtGray  To iVoid // 0
75899>>>            Get AddTransparentImage "prev.bmp"     clLtGray  To iVoid // 1
75900>>>            Get AddTransparentImage "equal.bmp"    clLtGray  To iVoid // 2
75901>>>            Get AddTransparentImage "next.bmp"     clLtGray  To iVoid // 3
75902>>>            Get AddTransparentImage "end.bmp"      clLtGray  To iVoid // 4
75903>>>            Get AddTransparentImage "Prompt16.bmp" clFuchsia To iVoid // 5
75904>>>            Get AddTransparentImage "clr.bmp"      clLtGray  To iVoid // 6
75905>>>            Get AddTransparentImage "clra.bmp"     clLtGray  To iVoid // 7
75906>>>            Get AddTransparentImage "Save16.bmp"   clFuchsia To iVoid // 8
75907>>>            Get AddTransparentImage "Delete16.bmp" clFuchsia To iVoid // 9
75908>>>            Get AddTransparentImage "Cut16.bmp"    clFuchsia To iVoid // 10
75909>>>            Get AddTransparentImage "Copy16.bmp"   clFuchsia To iVoid // 11
75910>>>            Get AddTransparentImage "Paste16.bmp"  clFuchsia To iVoid // 12
75911>>>        End_Procedure
75912>>>    End_Object
75913>>>    
75913>>>    Object oImagesHot is a cImageList
75915>>>        // These images are shown when the mouse cursor hovers over the button
75915>>>        // There must be a matching number of images in all imagelists.
75915>>>        Set piMaxImages To 12
75916>>>        Procedure OnCreate
75919>>>            Integer iVoid
75919>>>            Get AddTransparentImage "BgnHot.bmp"   clLtGray  To iVoid // 0
75920>>>            Get AddTransparentImage "PrevHot.bmp"  clLtGray  To iVoid // 1
75921>>>            Get AddTransparentImage "EqualHot.bmp" clLtGray  To iVoid // 2
75922>>>            Get AddTransparentImage "NextHot.bmp"  clLtGray  To iVoid // 3
75923>>>            Get AddTransparentImage "EndHot.bmp"   clLtGray  To iVoid // 4
75924>>>            Get AddTransparentImage "Prompt16.bmp" clFuchsia To iVoid // 5
75925>>>            Get AddTransparentImage "clr.bmp"      clLtGray  To iVoid // 6
75926>>>            Get AddTransparentImage "clra.bmp"     clLtGray  To iVoid // 7
75927>>>            Get AddTransparentImage "Save16.bmp"   clFuchsia To iVoid // 8
75928>>>            Get AddTransparentImage "Delete16.bmp" clFuchsia To iVoid // 9
75929>>>            Get AddTransparentImage "Cut16.bmp"    clFuchsia To iVoid // 10
75930>>>            Get AddTransparentImage "Copy16.bmp"   clFuchsia To iVoid // 11
75931>>>            Get AddTransparentImage "Paste16.bmp"  clFuchsia To iVoid // 12
75932>>>        End_Procedure
75933>>>    End_Object
75934>>>
75934>>>    Set phoImageList    To (oImages(self))
75935>>>    Set phoImageListHot To (oImagesHot(self))
75936>>>    
75936>>>    Object oFirst is a cToolbarButton
75938>>>        Set psLabel to "Primero"
75939>>>        Set psTooltip to 'Encontrar Primero (Ctrl+Home)'
75940>>>        Set psStatusHelp To 'Find the First record (Ctrl+Home)'
75941>>>        Set piImage To 0
75942>>>        Procedure OnClick
75945>>>            Send DoSendToDeoFocus msg_Find_First
75946>>>        End_Procedure
75947>>>    End_Object
75948>>>
75948>>>    Object oPrevious is a cToolbarButton
75950>>>        Set psLabel to "Anterior"
75951>>>        Set psTooltip to 'Encontrar Anterior (F7)'
75952>>>        Set psStatusHelp To 'Find the Previous record (F7)'
75953>>>        Set piImage To 1
75954>>>        Procedure OnClick
75957>>>            Send DoSendToDeoFocus msg_find_previous
75958>>>        End_Procedure
75959>>>    End_Object
75960>>>
75960>>>    Object oGreaterEqual is a cToolbarButton
75962>>>        Set psLabel to "Igual"
75963>>>        Set psTooltip to 'Encontrar Mayor/Igual (F9)'
75964>>>        Set psStatusHelp To 'Find a record (F9)'
75965>>>        Set piImage To 2
75966>>>        Procedure OnClick
75969>>>            Send DoSendToDeoFocus msg_find_ge
75970>>>        End_Procedure
75971>>>    End_Object
75972>>>
75972>>>    Object oNext is a cToolbarButton
75974>>>        Set psLabel to "Siguiente"
75975>>>        Set psTooltip to 'Encontrar Siguiente (F8)'
75976>>>        Set psStatusHelp To 'Find the Next record (F8)'
75977>>>        Set piImage To 3
75978>>>        Procedure OnClick
75981>>>            Send DoSendToDeoFocus msg_find_next
75982>>>        End_Procedure
75983>>>    End_Object
75984>>>
75984>>>    Object oLast is a cToolbarButton
75986>>>        Set psLabel to "éltimo"
75987>>>        Set psTooltip to 'Encontrar éltimo (Ctrl+End)'
75988>>>        Set psStatusHelp To 'Find the Last record (Ctrl+End)'
75989>>>        Set piImage To 4
75990>>>        Procedure OnClick
75993>>>            Send DoSendToDeoFocus msg_end_of_data
75994>>>        End_Procedure
75995>>>    End_Object
75996>>>
75996>>>    Object oSeparator is a cToolbarButton
75998>>>        Set peStyle To bsSeparator
75999>>>    End_Object
76000>>>
76000>>>    Object oPrompt is a cToolbarButton
76002>>>        Set psLabel to "Buscar"
76003>>>        Set psTooltip to 'Buscar (F4)'
76004>>>        Set psStatusHelp To 'Show available selections (F4)'
76005>>>        Set piImage To 5
76006>>>        Procedure OnClick
76009>>>            Send DoSendToDeoFocus msg_prompt
76010>>>        End_Procedure
76011>>>    End_Object
76012>>>
76012>>>    Object oClear is a cToolbarButton
76014>>>        Set psLabel to "Limpiar"
76015>>>        Set psTooltip to 'Limpiar (F5)'
76016>>>        Set psStatusHelp To 'Clear current record / Add a new record (F5)'
76017>>>        Set piImage To 6
76018>>>        Procedure OnClick
76021>>>            Send DoSendToDeoFocus msg_request_clear
76022>>>        End_Procedure
76023>>>    End_Object
76024>>>
76024>>>    Object oClearAll is a cToolbarButton
76026>>>        Set psLabel to "Limpiar Todo"
76027>>>        Set psTooltip to 'Limpiar Todo (Ctrl+F5)'
76028>>>        Set psStatusHelp To 'Clear all data from view (Ctrl+F5)'
76029>>>        Set piImage To 7
76030>>>        Procedure OnClick
76033>>>            Send DoSendToDeoFocus msg_request_clear_all
76034>>>        End_Procedure
76035>>>    End_Object
76036>>>
76036>>>    Object oSeparator is a cToolbarButton
76038>>>        Set peStyle To bsSeparator
76039>>>    End_Object
76040>>>
76040>>>    Object oSave is a cToolbarButton
76042>>>        Set psLabel to "Grabar"
76043>>>        Set psTooltip to 'Grabar (F2)'
76044>>>        Set psStatusHelp To 'Save the current record (F2)'
76045>>>        Set piImage To 8
76046>>>        Procedure OnClick
76049>>>            Send DoSendToDeoFocus msg_request_save
76050>>>        End_Procedure
76051>>>    End_Object
76052>>>
76052>>>    Object oDelete is a cToolbarButton
76054>>>        Set psLabel to "Eliminar"
76055>>>        Set psTooltip to 'Eliminar (Shift+F2)'
76056>>>        Set psStatusHelp To 'Delete the current record (Shift+F2)'
76057>>>        Set piImage To 9
76058>>>        Procedure OnClick
76061>>>            Send DoSendToDeoFocus msg_request_delete
76062>>>        End_Procedure
76063>>>    End_Object
76064>>>
76064>>>    Object oSeparator is a cToolbarButton
76066>>>        Set peStyle To bsSeparator
76067>>>    End_Object
76068>>>
76068>>>    Object oCut is a cToolbarButton
76070>>>        Set psLabel to "Cortar"
76071>>>        Set psTooltip to 'Cortar (Ctrl+X)'
76072>>>        Set psStatusHelp To 'Cuts the selection and puts it on the Clipboard (Ctrl+X)'
76073>>>        Set piImage To 10
76074>>>        Procedure OnClick
76077>>>            Send DoSendToDeoFocus msg_cut
76078>>>        End_Procedure
76079>>>    End_Object
76080>>>
76080>>>    Object oCopy is a cToolbarButton
76082>>>        Set psLabel to "Copiar"
76083>>>        Set psTooltip to 'Copiar (Ctrl+C)'
76084>>>        Set psStatusHelp To 'Copies the selection and puts it on the Clipboard (Ctrl+C)'
76085>>>        Set piImage To 11
76086>>>        Procedure OnClick
76089>>>            Send DoSendToDeoFocus msg_copy
76090>>>        End_Procedure
76091>>>    End_Object
76092>>>
76092>>>    Object oPaste is a cToolbarButton
76094>>>        Set psLabel to "Pegar"
76095>>>        Set psTooltip to 'Pegar (Ctrl+V)'
76096>>>        Set psStatusHelp To 'Inserts Clipboard contents (Ctrl+V)'
76097>>>        Set piImage To 12
76098>>>        Procedure OnClick
76101>>>            Send DoSendToDeoFocus msg_paste
76102>>>        End_Procedure
76103>>>    End_Object
76104>>>
76104>>>End_Object // oMainToolbar
76105>>>
76105>
76105>    Object oClientArea is a AppClientArea
76107>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\StdAbout.pkg)
76107>>>//************************************************************************
76107>>>// Confidential Trade Secret.
76107>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76107>>>// as an unpublished work.  All rights reserved.
76107>>>// DataFlex is a registered trademark of Data Access Corporation.
76107>>>//
76107>>>//************************************************************************
76107>>>//************************************************************************
76107>>>//
76107>>>// $File name  : StdAbout.pkg
76107>>>// $File title : Standard about object package for VDF
76107>>>// Notice      :
76107>>>// $Author(s)  : John Tuohy
76107>>>//
76107>>>// $Rev History
76107>>>//
76107>>>// JT 06/27/97   File created
76107>>>//************************************************************************
76107>>>
76107>>>// This provides a quick and simple way to create an about package for a program.
76107>>>// You need to create a message inside you client area called Activate_About.
76107>>>// Within this message you should send the message DoAbout passing needed
76107>>>// string information.
76107>>>//
76107>>>//       Procedure Activate_About
76107>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
76107>>>//       End_Procedure
76107>>>//    where: sTitle =     Name of application. If none provided, uses caption
76107>>>//                        bar title
76107>>>//           sVersion   = Version Line. If none provided, will be blank
76107>>>//           sCopyRight = Copyright Line. If none provided, will be blank
76107>>>//           sAuthor    = Author name, blank if none provided
76107>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
76107>>>//                        is used.
76107>>>// It is expected that you will place this in your own object package. For
76107>>>// example an order about package may look like this:
76107>>>//
76107>>>//   // OrderAbout.pkg
76107>>>//   Use StdAbout.pkg
76107>>>//   Procedure Activate_About
76107>>>//      String sTitle sCopyright sVersion sAuthor
76107>>>//      Move "My Order Entry System" to sTitle
76107>>>//      Move "Version 2.1" to sVersion
76107>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
76107>>>//      Move "John Smith"  to sAuthor
76107>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
76107>>>//   end_procedure
76107>>>//   // end of file.
76107>>>
76107>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\Dfabout.pkg)
76107>>>>>//************************************************************************
76107>>>>>// Confidential Trade Secret.
76107>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76107>>>>>// as an unpublished work.  All rights reserved.
76107>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
76107>>>>>//
76107>>>>>//************************************************************************
76107>>>>>//************************************************************************
76107>>>>>//
76107>>>>>// $File name  : DfAbout.pkg
76107>>>>>// $File title : About class support
76107>>>>>// Notice      :
76107>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
76107>>>>>//
76107>>>>>// $Rev History
76107>>>>>//
76107>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
76107>>>>>//                Windows for the size first. 
76107>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
76107>>>>>//                with anchor technique. Removed unnessary property in the
76107>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
76107>>>>>//                object To better look in Windows XP. Repositioned the close
76107>>>>>//                button in the sysinfo dialog To line up with the display area
76107>>>>>//                Replaced obsolete code and techniques. Removed dead code.
76107>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
76107>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
76107>>>>>//                the global Workspace object, if it is present
76107>>>>>// JJT 11/05/98   Added version information
76107>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
76107>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
76107>>>>>//                workspace package.
76107>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
76107>>>>>//                class can create this object.
76107>>>>>//                Cleaned up the interface (used correct classes and messages)
76107>>>>>//                Added workspace reporting support To sys-info.
76107>>>>>//                Turned off wrapping in the sys-info editor.
76107>>>>>// KR  ??/??/96   File created
76107>>>>>//************************************************************************
76107>>>>>Use LanguageText.pkg
76107>>>>>Use Windows.pkg
76107>>>>>Use DFbitmap.pkg
76107>>>>>Use GlobalFunctionsProcedures.pkg
76107>>>>>Use cTextEdit.pkg
76107>>>>>
76107>>>>>Use cli.pkg
Including file: cli.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cli.pkg)
76107>>>>>>>//*****************************************************************************
76107>>>>>>>//*** CLI.PKG                                                               ***
76107>>>>>>>//***                                                                       ***
76107>>>>>>>//*** Author: Ben Weijers                                                   ***
76107>>>>>>>//***         Data Access Nederland                                         ***
76107>>>>>>>//***         10 September 1998                                             ***
76107>>>>>>>//***                                                                       ***
76107>>>>>>>//*** Purpose:                                                              ***
76107>>>>>>>//***   CLI specific functionality. There are several connectivity kits     ***
76107>>>>>>>//***   based on  SQL/92 CLI. Those are:                                    ***
76107>>>>>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
76107>>>>>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
76107>>>>>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
76107>>>>>>>//***                                                                       ***
76107>>>>>>>//***   This package defines the common functionality for all CLI based     ***
76107>>>>>>>//***   drivers.                                                            ***
76107>>>>>>>//***                                                                       ***
76107>>>>>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
76107>>>>>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
76107>>>>>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
76107>>>>>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
76107>>>>>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
76107>>>>>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
76107>>>>>>>//***             Added SQLSERVER2012CLIENT return value for                ***
76107>>>>>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
76107>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
76107>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
76107>>>>>>>//***             mssqldrv.pkg                                              ***
76107>>>>>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
76107>>>>>>>//***             Added type mappings attributes                            ***
76107>>>>>>>//***   Updated:  october 11, 2013 (Current CK build: 6.0.0.18)             ***
76107>>>>>>>//***             Added DF_FILE_SQL_FILTER_EQ attribute                     ***
76107>>>>>>>//*****************************************************************************
76107>>>>>>>
76107>>>>>>>//*** We are not using ifndef below because that is not supported in Character Mode
76107>>>>>>>//*** Driver attributes
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>//------------------------------------------------------------
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>//-------------------------------------
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>//*** Replacement for logical column number that indicates all columns
76107>>>>>>>
76107>>>>>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
76107>>>>>>>
76107>>>>>>>//*** Possible DF_FIELD_READ_ONLY values
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
76107>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
76107>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>// Moved to Mssqldrv.pkg
76107>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
76107>>>>>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
76107>>>>>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
76107>>>>>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
76107>>>>>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
76107>>>>>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
76107>>>>>>>
76107>>>>>>>//*** Possible SQL Column type values
76107>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
76107>>>>>>>Define SQL_CHAR           For    1
76107>>>>>>>Define SQL_NUMERIC        For    2
76107>>>>>>>Define SQL_DECIMAL        For    3
76107>>>>>>>Define SQL_INTEGER        For    4
76107>>>>>>>Define SQL_SMALLINT       For    5
76107>>>>>>>Define SQL_FLOAT          For    6
76107>>>>>>>Define SQL_REAL           For    7
76107>>>>>>>Define SQL_DOUBLE         For    8
76107>>>>>>>Define SQL_DATETIME       For    9
76107>>>>>>>Define SQL_VARCHAR        For   12
76107>>>>>>>Define SQL_TYPE_DATE      For   91
76107>>>>>>>Define SQL_TYPE_TIME      For   92
76107>>>>>>>Define SQL_TYPE_TIMESTAMP for   93
76107>>>>>>>// Moved to mssqldrv.pkg
76107>>>>>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>Define SQL_DATE           For    9
76107>>>>>>>Define SQL_INTERVAL       For   10
76107>>>>>>>Define SQL_TIME           For   10
76107>>>>>>>Define SQL_TIMESTAMP      For   11
76107>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
76107>>>>>>>Define SQL_BINARY         For  (-2)
76107>>>>>>>Define SQL_VARBINARY      For  (-3)
76107>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
76107>>>>>>>Define SQL_BIGINT         For  (-5)
76107>>>>>>>Define SQL_TINYINT        For  (-6)
76107>>>>>>>Define SQL_BIT            For  (-7)
76107>>>>>>>Define SQL_WCHAR          For  (-8)
76107>>>>>>>Define SQL_WVARCHAR       For  (-9)
76107>>>>>>>Define SQL_WLONGVARCHAR   For (-10)
76107>>>>>>>Define SQL_GUID           For (-11)
76107>>>>>>>
76107>>>>>>>//*** Driver level attributes
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>//*** Error number constants
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>//*** Call driver function identifiers
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>//*** Init data source types
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>//*** Dummy strings used in the commands
76107>>>>>>>    String  CLI$StrDummy 255
76107>>>>>>>    Integer CLI$IntDummy
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>//*****************************************************************************
76107>>>>>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
76107>>>>>>>//***                                                                       ***
76107>>>>>>>//***   Setup a constraint for a file.                                      ***
76107>>>>>>>//*****************************************************************************
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>//*****************************************************************************
76107>>>>>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
76107>>>>>>>//***                                                                       ***
76107>>>>>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
76107>>>>>>>//*** will be set for the remainder of the session or until set again. To   ***
76107>>>>>>>//*** permanently set driver level attributes change the driver             ***
76107>>>>>>>//*** configuration file.                                                   ***
76107>>>>>>>//*****************************************************************************
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>
76107>>>>>>>//*****************************************************************************
76107>>>>>>>//*** Class  : cCLIHandler                                                  ***
76107>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76107>>>>>>>//***          call several CLI releated methods.                           ***
76107>>>>>>>//*****************************************************************************
76107>>>>>>>
76107>>>>>>>Class cCLIHandler Is An Array
76108>>>>>>>
76108>>>>>>>    Procedure Construct_Object Integer iImage
76110>>>>>>>        Forward Send Construct_object iImage
76112>>>>>>>
76112>>>>>>>        Property String  psDriverID       Public ""
76113>>>>>>>    End_Procedure // Construct_Object
76114>>>>>>>
76114>>>>>>>
76114>>>>>>>
76114>>>>>>>    //***
76114>>>>>>>    //*** Fucntion: CKRevsion
76114>>>>>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
76114>>>>>>>    //***
76114>>>>>>>
76114>>>>>>>    Function CKRevision Returns String
76116>>>>>>>        Local String  sDriverID
76116>>>>>>>        Local String  sRevision
76116>>>>>>>        Local String  sVoid
76116>>>>>>>        Local Integer iRetval
76116>>>>>>>
76116>>>>>>>        Get psDriverID To sDriverID
76117>>>>>>>        If (sDRiverID <> "") Begin
76119>>>>>>>            Move (Repeat(" ", 255)) To sRevision
76120>>>>>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76125>>>>>>>        End
76125>>>>>>>>
76125>>>>>>>
76125>>>>>>>        Function_Return sRevision
76126>>>>>>>    End_Function // CKRevision
76127>>>>>>>
76127>>>>>>>
76127>>>>>>>
76127>>>>>>>    //***
76127>>>>>>>    //*** Function: ExtractPartFromRevision
76127>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76127>>>>>>>    //***
76127>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76127>>>>>>>    //***
76127>>>>>>>
76127>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76129>>>>>>>        Local Integer iPartRev
76129>>>>>>>        Local Integer iCurrentPart
76129>>>>>>>        Local Integer iSeparatorPos
76129>>>>>>>
76129>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76132>>>>>>>
76132>>>>>>>        Move 0 To iCurrentPart
76133>>>>>>>        Repeat
76133>>>>>>>>
76133>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76134>>>>>>>            If (iSeparatorPos > 0) Begin
76136>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76137>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76138>>>>>>>                Increment iCurrentPart
76139>>>>>>>            End
76139>>>>>>>>
76139>>>>>>>            Else If (sRevision <> "") Begin
76142>>>>>>>                Move sRevision To iPartRev
76143>>>>>>>                Move "" To sRevision
76144>>>>>>>                Increment iCurrentPart
76145>>>>>>>            End
76145>>>>>>>>
76145>>>>>>>            Else ;                Move -1 To iPartRev
76147>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76149>>>>>>>
76149>>>>>>>        Function_Return iPartRev
76150>>>>>>>    End_Function // EcxtractPartFromRevision
76151>>>>>>>
76151>>>>>>>
76151>>>>>>>
76151>>>>>>>    //***
76151>>>>>>>    //*** Function: CKMajorRevision
76151>>>>>>>    //*** Purpose : Returns the major revision of the CK
76151>>>>>>>    //***
76151>>>>>>>
76151>>>>>>>    Function CKMajorRevision Returns Integer
76153>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76154>>>>>>>    End_Function // CKMajorRevision
76155>>>>>>>
76155>>>>>>>
76155>>>>>>>
76155>>>>>>>    //***
76155>>>>>>>    //*** Function: CKMinorRevision
76155>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76155>>>>>>>    //***
76155>>>>>>>
76155>>>>>>>    Function CKMinorRevision Returns Integer
76157>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76158>>>>>>>    End_Function // CKMinorRevision
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>    //***
76159>>>>>>>    //*** Function: CKReleaseRevision
76159>>>>>>>    //*** Purpose : Returns the release revision of the CK
76159>>>>>>>    //***
76159>>>>>>>
76159>>>>>>>    Function CKReleaseRevision Returns Integer
76161>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76162>>>>>>>    End_Function // CKReleaseRevision
76163>>>>>>>
76163>>>>>>>
76163>>>>>>>
76163>>>>>>>    //***
76163>>>>>>>    //*** Function: CKBuildRevision
76163>>>>>>>    //*** Purpose : Returns the major revision of the CK
76163>>>>>>>    //***
76163>>>>>>>
76163>>>>>>>    Function CKBuildRevision Returns Integer
76165>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76166>>>>>>>    End_Function // CKBuildRevision
76167>>>>>>>
76167>>>>>>>
76167>>>>>>>
76167>>>>>>>    //***
76167>>>>>>>    //*** Function: IsMinimalRevision
76167>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76167>>>>>>>    //***
76167>>>>>>>
76167>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76169>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76172>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76175>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76178>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76181>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76184>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76188>>>>>>>            End
76188>>>>>>>>
76188>>>>>>>        End
76188>>>>>>>>
76188>>>>>>>
76188>>>>>>>        Function_Return (FALSE)
76189>>>>>>>    End_Function // IsMinimalRevision
76190>>>>>>>
76190>>>>>>>
76190>>>>>>>
76190>>>>>>>    //***
76190>>>>>>>    //*** Function: RegistrationName
76190>>>>>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
76190>>>>>>>    //***
76190>>>>>>>
76190>>>>>>>    Function RegistrationName Returns String
76192>>>>>>>        Local String  sRegistration
76192>>>>>>>        Local String  sDRiverId
76192>>>>>>>        Local String  sVoid
76192>>>>>>>        Local Integer iRetval
76192>>>>>>>
76192>>>>>>>        Get psDriverID To sDriverID
76193>>>>>>>        If (sDRiverID <> "") Begin
76195>>>>>>>            Move (Repeat(" ", 255)) To sRegistration
76196>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
76201>>>>>>>        End
76201>>>>>>>>
76201>>>>>>>
76201>>>>>>>        Function_Return sRegistration
76202>>>>>>>    End_Function // RegistrationName
76203>>>>>>>
76203>>>>>>>
76203>>>>>>>
76203>>>>>>>    //***
76203>>>>>>>    //*** Function: SerialNumber
76203>>>>>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
76203>>>>>>>    //***
76203>>>>>>>
76203>>>>>>>    Function SerialNumber Returns Integer
76205>>>>>>>        Local String  sDRiverId
76205>>>>>>>        Local String  sVoid
76205>>>>>>>        Local Integer iRetval
76205>>>>>>>
76205>>>>>>>        Get psDriverID To sDriverID
76206>>>>>>>        If (sDRiverID <> "") Begin
76208>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
76213>>>>>>>        End
76213>>>>>>>>
76213>>>>>>>
76213>>>>>>>        Function_Return iRetval
76214>>>>>>>    End_Function // SerialNumber
76215>>>>>>>
76215>>>>>>>
76215>>>>>>>
76215>>>>>>>    //***
76215>>>>>>>    //*** Function: MaxUsers
76215>>>>>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
76215>>>>>>>    //***
76215>>>>>>>
76215>>>>>>>    Function MaxUsers Returns Integer
76217>>>>>>>        Local String  sDRiverId
76217>>>>>>>        Local String  sVoid
76217>>>>>>>        Local Integer iRetval
76217>>>>>>>
76217>>>>>>>        Get psDriverID To sDriverID
76218>>>>>>>        If (sDRiverID <> "") Begin
76220>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
76225>>>>>>>        End
76225>>>>>>>>
76225>>>>>>>
76225>>>>>>>        Function_Return iRetval
76226>>>>>>>    End_Function // MaxUsers
76227>>>>>>>
76227>>>>>>>
76227>>>>>>>
76227>>>>>>>    //***
76227>>>>>>>    //*** Procedure: DumpStatus
76227>>>>>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
76227>>>>>>>    //***
76227>>>>>>>
76227>>>>>>>    Procedure DumpStatus String sFileName
76229>>>>>>>        Local String  sVoid
76229>>>>>>>        Local String  sDriverID
76229>>>>>>>        Local Integer iVoid
76229>>>>>>>
76229>>>>>>>        Get psDriverID To sDriverID
76230>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
76237>>>>>>>    End_Procedure // DumpStatus
76238>>>>>>>
76238>>>>>>>
76238>>>>>>>
76238>>>>>>>    //***
76238>>>>>>>    //*** Procedure: ReadConfiguration
76238>>>>>>>    //*** Purpose  : Reset all driver level configurable attributes to the
76238>>>>>>>    //***            default value and then reread the configuration.
76238>>>>>>>    //***
76238>>>>>>>
76238>>>>>>>    Procedure ReadConfiguration
76240>>>>>>>        Local String  sVoid
76240>>>>>>>        Local String  sDriverID
76240>>>>>>>        Local Integer iVoid
76240>>>>>>>
76240>>>>>>>        Get psDriverID To sDriverID
76241>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
76248>>>>>>>    End_Procedure // ReadConfiguration
76249>>>>>>>
76249>>>>>>>
76249>>>>>>>
76249>>>>>>>    //***
76249>>>>>>>    //*** Function: TextToRIMValue
76249>>>>>>>    //*** Purpose : Convert a text to the corresponding
76249>>>>>>>    //***           Generate_Record_ID_Method attribute value
76249>>>>>>>    //***
76249>>>>>>>
76249>>>>>>>    Function TextToRIMValue String sText Returns Integer
76251>>>>>>>        If (sText = "None") ;            Function_return RIM_NONE
76254>>>>>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
76258>>>>>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
76262>>>>>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
76266>>>>>>>    End_Function // TextToRIMValue
76267>>>>>>>
76267>>>>>>>
76267>>>>>>>
76267>>>>>>>    //***
76267>>>>>>>    //*** Function: RIMValueTotext
76267>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76267>>>>>>>    //***           corresponding text.
76267>>>>>>>    //***
76267>>>>>>>
76267>>>>>>>    Function RIMValueToText Integer iAttrValue Returns String
76269>>>>>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
76272>>>>>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
76276>>>>>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
76280>>>>>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
76284>>>>>>>    End_Function // RIMValueToText
76285>>>>>>>
76285>>>>>>>
76285>>>>>>>
76285>>>>>>>    //***
76285>>>>>>>    //*** Function: TextToROValue
76285>>>>>>>    //*** Purpose : Convert a text to the corresponding
76285>>>>>>>    //***           Generate_Record_ID_Method attribute value
76285>>>>>>>    //***
76285>>>>>>>
76285>>>>>>>    Function TextToROValue String sText Returns Integer
76287>>>>>>>        If (sText = "No") ;            Function_return RO_NO
76290>>>>>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
76294>>>>>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
76298>>>>>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
76302>>>>>>>    End_Function // TextToRIMValue
76303>>>>>>>
76303>>>>>>>
76303>>>>>>>
76303>>>>>>>    //***
76303>>>>>>>    //*** Function: ROValueTotext
76303>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76303>>>>>>>    //***           corresponding text.
76303>>>>>>>    //***
76303>>>>>>>
76303>>>>>>>    Function ROValueToText Integer iAttrValue Returns String
76305>>>>>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
76308>>>>>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
76312>>>>>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
76316>>>>>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
76320>>>>>>>    End_Function // RIMValueToText
76321>>>>>>>
76321>>>>>>>
76321>>>>>>>
76321>>>>>>>    //***
76321>>>>>>>    //*** Function: LastDriverError
76321>>>>>>>    //*** Purpose : Return the text f the last error geneated by the driver.
76321>>>>>>>    //***
76321>>>>>>>
76321>>>>>>>    Function LastDriverError Returns String
76323>>>>>>>        Local String  sDriverID
76323>>>>>>>        Local String  sLastError
76323>>>>>>>        Local String  sLastErrorLength
76323>>>>>>>        Local Integer iLastErrorLength
76323>>>>>>>        Local Integer iVoid
76323>>>>>>>
76323>>>>>>>        //*** Initialize
76323>>>>>>>        Move "" To sLastError
76324>>>>>>>
76324>>>>>>>        Get psDriverID To sDriverID
76325>>>>>>>        If (sDriverID <> "") Begin
76327>>>>>>>            //*** Get the text of the last error
76327>>>>>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
76328>>>>>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
76333>>>>>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
76334>>>>>>>
76334>>>>>>>            If (iLastErrorLength > 0) Begin
76336>>>>>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
76337>>>>>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
76342>>>>>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
76343>>>>>>>            End
76343>>>>>>>>
76343>>>>>>>        End
76343>>>>>>>>
76343>>>>>>>
76343>>>>>>>        Function_Return sLastError
76344>>>>>>>    End_Function // LastDriverError
76345>>>>>>>
76345>>>>>>>
76345>>>>>>>
76345>>>>>>>    //***
76345>>>>>>>    //*** Function: EnumerateTables
76345>>>>>>>    //*** Purpose : Enumerate the tables in a database
76345>>>>>>>    //***
76345>>>>>>>
76345>>>>>>>    Function EnumerateTables String sLogin Returns Integer
76347>>>>>>>        Local String  sDriver
76347>>>>>>>        Local String  sVoid
76347>>>>>>>        Local Integer iNumTables
76347>>>>>>>        Local Integer iVoid
76347>>>>>>>
76347>>>>>>>        Get psDriverID To sDriver
76348>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
76355>>>>>>>
76355>>>>>>>        Function_Return iNumTables
76356>>>>>>>    End_Function // EnumerateTables
76357>>>>>>>
76357>>>>>>>
76357>>>>>>>
76357>>>>>>>    //***
76357>>>>>>>    //*** Function: TableName
76357>>>>>>>    //*** Purpose : Returns the name of the table enumerated at the given position
76357>>>>>>>    //***
76357>>>>>>>
76357>>>>>>>    Function TableName Integer iIndex Returns String
76359>>>>>>>        Local String  sDriver
76359>>>>>>>        Local String  sTableName
76359>>>>>>>        Local String  sVoid
76359>>>>>>>        Local Integer iVoid
76359>>>>>>>
76359>>>>>>>        Get psDriverID To sDriver
76360>>>>>>>        If (sDriver <> "") Begin
76362>>>>>>>            Move (Repeat(" ", 255)) To sTableName
76363>>>>>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
76368>>>>>>>        End
76368>>>>>>>>
76368>>>>>>>
76368>>>>>>>        Function_Return sTableName
76369>>>>>>>    End_Function // TableName
76370>>>>>>>
76370>>>>>>>
76370>>>>>>>
76370>>>>>>>    //***
76370>>>>>>>    //*** Function: SchemaName
76370>>>>>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
76370>>>>>>>    //***
76370>>>>>>>
76370>>>>>>>    Function SchemaName Integer iIndex Returns String
76372>>>>>>>        Local String  sDriver
76372>>>>>>>        Local String  sSchemaName
76372>>>>>>>        Local String  sVoid
76372>>>>>>>        Local Integer iVoid
76372>>>>>>>
76372>>>>>>>        Get psDriverID To sDriver
76373>>>>>>>        If (sDriver <> "") Begin
76375>>>>>>>            Move (Repeat(" ", 255)) To sSchemaName
76376>>>>>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
76381>>>>>>>        End
76381>>>>>>>>
76381>>>>>>>
76381>>>>>>>        Function_Return sSchemaName
76382>>>>>>>    End_Function // SchemaName
76383>>>>>>>
76383>>>>>>>
76383>>>>>>>
76383>>>>>>>    //***
76383>>>>>>>    //*** Function: TableType
76383>>>>>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
76383>>>>>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
76383>>>>>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
76383>>>>>>>    //***
76383>>>>>>>
76383>>>>>>>    Function TableType Integer iIndex Returns String
76385>>>>>>>        Local String  sDriver
76385>>>>>>>        Local String  sTableType
76385>>>>>>>        Local String  sVoid
76385>>>>>>>        Local Integer iVoid
76385>>>>>>>
76385>>>>>>>        Get psDriverID To sDriver
76386>>>>>>>        If (sDriver <> "") Begin
76388>>>>>>>            Move (Repeat(" ", 25)) To sTableType
76389>>>>>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
76394>>>>>>>        End
76394>>>>>>>>
76394>>>>>>>
76394>>>>>>>        Function_Return sTableType
76395>>>>>>>    End_Function // TableType
76396>>>>>>>
76396>>>>>>>
76396>>>>>>>
76396>>>>>>>    //***
76396>>>>>>>    //*** Function: TableComment
76396>>>>>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
76396>>>>>>>    //***
76396>>>>>>>
76396>>>>>>>    Function TableComment Integer iIndex Returns String
76398>>>>>>>        Local String  sDriver
76398>>>>>>>        Local String  sTableComment
76398>>>>>>>        Local String  sVoid
76398>>>>>>>        Local Integer iVoid
76398>>>>>>>
76398>>>>>>>        Get psDriverID To sDriver
76399>>>>>>>        If (sDriver <> "") Begin
76401>>>>>>>            Move (Repeat(" ", 255)) To sTableComment
76402>>>>>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
76407>>>>>>>        End
76407>>>>>>>>
76407>>>>>>>
76407>>>>>>>        Function_Return sTableComment
76408>>>>>>>    End_Function // TableComment
76409>>>>>>>
76409>>>>>>>
76409>>>>>>>
76409>>>>>>>    //***
76409>>>>>>>    //*** Function: EnumerateColumns
76409>>>>>>>    //*** Purpose : Enumerate the columns in a table
76409>>>>>>>    //***
76409>>>>>>>
76409>>>>>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
76411>>>>>>>        Local String  sDriver
76411>>>>>>>        Local Integer iNumColumns
76411>>>>>>>        Local Integer iVoid
76411>>>>>>>
76411>>>>>>>        Get psDriverID To sDriver
76412>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
76419>>>>>>>
76419>>>>>>>        Function_Return iNumColumns
76420>>>>>>>    End_Function // EnumerateColumns
76421>>>>>>>
76421>>>>>>>
76421>>>>>>>
76421>>>>>>>    //***
76421>>>>>>>    //*** Function: ColumnName
76421>>>>>>>    //*** Purpose : Returns the name of the column enumerated at the given position
76421>>>>>>>    //***
76421>>>>>>>
76421>>>>>>>    Function ColumnName Integer iIndex Returns String
76423>>>>>>>        Local String  sDriver
76423>>>>>>>        Local String  sColumnName
76423>>>>>>>        Local String  sVoid
76423>>>>>>>        Local Integer iVoid
76423>>>>>>>
76423>>>>>>>        Get psDriverID To sDriver
76424>>>>>>>        If (sDriver <> "") Begin
76426>>>>>>>            Move (Repeat(" ", 255)) To sColumnName
76427>>>>>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
76432>>>>>>>        End
76432>>>>>>>>
76432>>>>>>>
76432>>>>>>>        Function_Return sColumnName
76433>>>>>>>    End_Function // ColumnName
76434>>>>>>>
76434>>>>>>>
76434>>>>>>>
76434>>>>>>>    //***
76434>>>>>>>    //*** Function: CLIDFDateToSQLDate
76434>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
76434>>>>>>>    //***
76434>>>>>>>
76434>>>>>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
76436>>>>>>>        Local String sSQLDate
76436>>>>>>>        Local Integer iOrgDateFmt
76436>>>>>>>        Local Integer iOrgDateSep
76436>>>>>>>
76436>>>>>>>        //*** Change date format to military, SQL dates are military dates
76436>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76439>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76442>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76445>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76448>>>>>>>
76448>>>>>>>        //*** We only need to convert if the date is 0
76448>>>>>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
76457>>>>>>>        Else ;            Move dDFDate To sSQLDate
76459>>>>>>>
76459>>>>>>>        //*** Change date format back to original
76459>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76462>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76465>>>>>>>
76465>>>>>>>        Function_Return sSQLDate
76466>>>>>>>    End_Function // CLIDFDateToSQLDate
76467>>>>>>>
76467>>>>>>>
76467>>>>>>>
76467>>>>>>>    //***
76467>>>>>>>    //*** Function: CLISQLDateToDFDate
76467>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
76467>>>>>>>    //***
76467>>>>>>>
76467>>>>>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
76469>>>>>>>        Local Date dDFDate
76469>>>>>>>        Local String sDummyDateValue
76469>>>>>>>        Local Integer iOrgDateFmt
76469>>>>>>>        Local Integer iOrgDateSep
76469>>>>>>>
76469>>>>>>>        //*** Change date format to military, SQL dates are military dates
76469>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76472>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76475>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76478>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76481>>>>>>>
76481>>>>>>>        //*** We only need to convert if the date is the dummy zero date value
76481>>>>>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
76488>>>>>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
76491>>>>>>>        Else ;            Move sSQLDate To dDFDate
76493>>>>>>>
76493>>>>>>>        //*** Change date format back to original
76493>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76496>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76499>>>>>>>
76499>>>>>>>        Function_Return dDFDate
76500>>>>>>>    End_Function // CLISQLDateToDFDate
76501>>>>>>>
76501>>>>>>>
76501>>>>>>>
76501>>>>>>>    //***
76501>>>>>>>    //*** Function: RedirectConnection
76501>>>>>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
76501>>>>>>>    //***           will point to another database but all tables will stay
76501>>>>>>>    //***           open!
76501>>>>>>>    //***
76501>>>>>>>
76501>>>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
76503>>>>>>>        Local String  sDriver
76503>>>>>>>        Local String  sVoid
76503>>>>>>>        Local Integer iResult
76503>>>>>>>        Local Integer iVoid
76503>>>>>>>
76503>>>>>>>        Get psDriverID To sDriver
76504>>>>>>>        If (sDriver <> "") Begin
76506>>>>>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
76511>>>>>>>        End
76511>>>>>>>>
76511>>>>>>>        Function_Return iResult
76512>>>>>>>    End_Function // RedirectConnect
76513>>>>>>>
76513>>>>>>>
76513>>>>>>>
76513>>>>>>>    //***
76513>>>>>>>    //*** Function: CreateConnectionID
76513>>>>>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
76513>>>>>>>    //***
76513>>>>>>>
76513>>>>>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
76515>>>>>>>        Local String  sDriver
76515>>>>>>>        Local Integer iResult
76515>>>>>>>        Local Integer iOptions
76515>>>>>>>
76515>>>>>>>        Get psDriverID to sDriver
76516>>>>>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
76519>>>>>>>        Else ;            Move iOpt to iOptions
76521>>>>>>>        If (sDriver <> "") Begin
76523>>>>>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
76528>>>>>>>        End
76528>>>>>>>>
76528>>>>>>>        Function_Return iResult
76529>>>>>>>    End_Function // CreateConnectionID
76530>>>>>>>
76530>>>>>>>
76530>>>>>>>
76530>>>>>>>    //***
76530>>>>>>>    //*** Function: DeleteConnectionID
76530>>>>>>>    //*** Purpose : Delete a DataFlex side connection id.
76530>>>>>>>    //***
76530>>>>>>>
76530>>>>>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
76532>>>>>>>        Local String  sDriver
76532>>>>>>>        Local Integer iResult
76532>>>>>>>        Local String sVoid
76532>>>>>>>
76532>>>>>>>        Get psDriverID To sDriver
76533>>>>>>>        If (sDriver <> "") Begin
76535>>>>>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
76540>>>>>>>        End
76540>>>>>>>>
76540>>>>>>>        Function_Return iResult
76541>>>>>>>    End_Function // DeleteConnectionID
76542>>>>>>>
76542>>>>>>>End_Class // cCLIHandler
76543>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 18.2\Pkg\DFBTRDRV.PKG)
76543>>>>>>>//****************************************************************************
76543>>>>>>>//
76543>>>>>>>// $File name  : DFBTRDRV.PKG
76543>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
76543>>>>>>>// Notice      : This package contains constants and commands, used to call
76543>>>>>>>//               specific functions in the DFBTRDRV.
76543>>>>>>>// $Author(s)  : Eddy Kleinjan
76543>>>>>>>//
76543>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
76543>>>>>>>// Created     : 01-07-97 @ 12:00:00
76543>>>>>>>//
76543>>>>>>>// Changed     : 04-04-2001.
76543>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
76543>>>>>>>//
76543>>>>>>>// Changed     : June 6, 2001
76543>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
76543>>>>>>>//
76543>>>>>>>//               Added DFBTR_DDF_OWNER command.
76543>>>>>>>//
76543>>>>>>>// Changed     : June 12, 2001
76543>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
76543>>>>>>>//
76543>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
76543>>>>>>>//
76543>>>>>>>// Changed     : August 4, 2004
76543>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
76543>>>>>>>//
76543>>>>>>>//               Added cDfbtrdrvHandler class.
76543>>>>>>>//               New functions in this class:
76543>>>>>>>//                  Function CKRevision Returns String
76543>>>>>>>//                  Function CkUsesUri Returns Integer
76543>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76543>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76543>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76543>>>>>>>//
76543>>>>>>>// Changed     : September 30, 2005
76543>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
76543>>>>>>>//
76543>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
76543>>>>>>>//****************************************************************************
76543>>>>>>>Use Ui
76543>>>>>>>//
76543>>>>>>>// Driver Indentification
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>//*** Driver attributes
76543>>>>>>>//
76543>>>>>>>// Call_Driver functions ID's
76543>>>>>>>//
76543>>>>>>>//
76543>>>>>>>// DFBTRFN_CONVERT_FILE options
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// DFBTRFN_SET_OWNER options
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to create all vars which may be needed
76543>>>>>>>// in other commands.
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to set the owner of a Btrieve file.
76543>>>>>>>// File must have been opened.
76543>>>>>>>// Filenumber needs to be passed.
76543>>>>>>>// To clear set the owner to "".
76543>>>>>>>// Examples:
76543>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
76543>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
76543>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
76543>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
76543>>>>>>>// To clear:
76543>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to parse DFBTR_SET_OWNVER
76543>>>>>>>// options.
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to parse for Callback
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to clear the owner of a Btrieve file.
76543>>>>>>>// File must have been opened.
76543>>>>>>>// Filenumber needs to be passed.
76543>>>>>>>// Examples:
76543>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to add a owner name to the internal list of ownernames
76543>>>>>>>// which will be tries when opening files.
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to remove all owners from the internal list of ownernames
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to set the owner name to be used when opening the DDF files.
76543>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
76543>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
76543>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to change the transaction type.
76543>>>>>>>// Valid types are:
76543>>>>>>>//     DFBTRTT_NONE
76543>>>>>>>//     DFBTRTT_EXCLUSIVE
76543>>>>>>>//     DFBTRTT_CONCURRENT
76543>>>>>>>//
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to get the current transaction type.
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to set explicit_locking
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to get explicit locking
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>//
76543>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
76543>>>>>>>//
76543>>>>>>>
76543>>>>>>>//*****************************************************************************
76543>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
76543>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76543>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
76543>>>>>>>//*****************************************************************************
76543>>>>>>>
76543>>>>>>>Class cDFBtrDrvHandler Is An Array
76544>>>>>>>
76544>>>>>>>    Procedure Construct_Object Integer iImage
76546>>>>>>>        Forward Send Construct_object iImage
76548>>>>>>>
76548>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
76549>>>>>>>    End_Procedure // Construct_Object
76550>>>>>>>
76550>>>>>>>
76550>>>>>>>
76550>>>>>>>    //***
76550>>>>>>>    //*** Function: CKRevsion
76550>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
76550>>>>>>>    //***
76550>>>>>>>
76550>>>>>>>    Function CKRevision Returns String
76552>>>>>>>        Local String  sDriverID
76552>>>>>>>        Local String  sRevision
76552>>>>>>>        Local String  sVoid
76552>>>>>>>        Local Integer iRetval
76552>>>>>>>
76552>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76552>>>>>>>        // This error would otherwise be raised when we have an older
76552>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76552>>>>>>>        Send Ignore_error To Error_object_Id 20491
76553>>>>>>>        Get psDriverID To sDriverID
76554>>>>>>>        Move (Repeat(" ", 255)) To sRevision
76555>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76560>>>>>>>        Send Trap_Error To Error_object_Id 20491
76561>>>>>>>        If (Trim(sRevision) = "") Begin
76563>>>>>>>            // Unable to get the revision. return all zeroes.
76563>>>>>>>            Move "0.0.0.0" To sRevision
76564>>>>>>>        End
76564>>>>>>>>
76564>>>>>>>        Function_Return sRevision
76565>>>>>>>    End_Function // CKRevision
76566>>>>>>>
76566>>>>>>>    Function CkUsesUri Returns Integer
76568>>>>>>>        Local String  sDriverID
76568>>>>>>>        Local String  sVoid1
76568>>>>>>>        Local String  sVoid2
76568>>>>>>>        Local Integer iRetval
76568>>>>>>>
76568>>>>>>>        Get psDriverID To sDriverID
76569>>>>>>>
76569>>>>>>>        Move 0 To iRetval
76570>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76570>>>>>>>        // This error would otherwise be raised when we have an older
76570>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
76570>>>>>>>        Send Ignore_error To Error_object_Id 20491
76571>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
76576>>>>>>>        Send Trap_Error To Error_object_Id 20491
76577>>>>>>>
76577>>>>>>>        Function_Return iRetval
76578>>>>>>>    End_Function // CKUsesUri
76579>>>>>>>
76579>>>>>>>
76579>>>>>>>
76579>>>>>>>    //***
76579>>>>>>>    //*** Function: ExtractPartFromRevsion
76579>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76579>>>>>>>    //***
76579>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76579>>>>>>>    //***
76579>>>>>>>
76579>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76581>>>>>>>        Local Integer iPartRev
76581>>>>>>>        Local Integer iCurrentPart
76581>>>>>>>        Local Integer iSeparatorPos
76581>>>>>>>
76581>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76584>>>>>>>
76584>>>>>>>        Move 0 To iCurrentPart
76585>>>>>>>        Repeat
76585>>>>>>>>
76585>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76586>>>>>>>            If (iSeparatorPos > 0) Begin
76588>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76589>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76590>>>>>>>                Increment iCurrentPart
76591>>>>>>>            End
76591>>>>>>>>
76591>>>>>>>            Else If (sRevision <> "") Begin
76594>>>>>>>                Move sRevision To iPartRev
76595>>>>>>>                Move "" To sRevision
76596>>>>>>>                Increment iCurrentPart
76597>>>>>>>            End
76597>>>>>>>>
76597>>>>>>>            Else ;                Move -1 To iPartRev
76599>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76601>>>>>>>
76601>>>>>>>        Function_Return iPartRev
76602>>>>>>>    End_Function // EcxtractPartFromRevision
76603>>>>>>>
76603>>>>>>>
76603>>>>>>>
76603>>>>>>>    //***
76603>>>>>>>    //*** Function: CKMajorRevision
76603>>>>>>>    //*** Purpose : Returns the major revision of the CK
76603>>>>>>>    //***
76603>>>>>>>
76603>>>>>>>    Function CKMajorRevision Returns Integer
76605>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76606>>>>>>>    End_Function // CKMajorRevision
76607>>>>>>>
76607>>>>>>>
76607>>>>>>>
76607>>>>>>>    //***
76607>>>>>>>    //*** Function: CKMinorRevision
76607>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76607>>>>>>>    //***
76607>>>>>>>
76607>>>>>>>    Function CKMinorRevision Returns Integer
76609>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76610>>>>>>>    End_Function // CKMinorRevision
76611>>>>>>>
76611>>>>>>>
76611>>>>>>>
76611>>>>>>>    //***
76611>>>>>>>    //*** Function: CKReleaseRevision
76611>>>>>>>    //*** Purpose : Returns the release revision of the CK
76611>>>>>>>    //***
76611>>>>>>>
76611>>>>>>>    Function CKReleaseRevision Returns Integer
76613>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76614>>>>>>>    End_Function // CKReleaseRevision
76615>>>>>>>
76615>>>>>>>
76615>>>>>>>
76615>>>>>>>    //***
76615>>>>>>>    //*** Function: CKBuildRevision
76615>>>>>>>    //*** Purpose : Returns the major revision of the CK
76615>>>>>>>    //***
76615>>>>>>>
76615>>>>>>>    Function CKBuildRevision Returns Integer
76617>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76618>>>>>>>    End_Function // CKBuildRevision
76619>>>>>>>
76619>>>>>>>
76619>>>>>>>
76619>>>>>>>    //***
76619>>>>>>>    //*** Function: IsMinimalRevision
76619>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76619>>>>>>>    //***
76619>>>>>>>
76619>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76621>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76624>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76627>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76630>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76633>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76636>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76640>>>>>>>            End
76640>>>>>>>>
76640>>>>>>>        End
76640>>>>>>>>
76640>>>>>>>
76640>>>>>>>        Function_Return (FALSE)
76641>>>>>>>    End_Function // IsMinimalRevision
76642>>>>>>>
76642>>>>>>>    //   Functions to query the Pervasive.SQL version:
76642>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
76642>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
76642>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
76642>>>>>>>    //
76642>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
76642>>>>>>>    //   in the following format:
76642>>>>>>>    //       <version>.<revision>.<type>
76642>>>>>>>    //   possible values for <type>:
76642>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
76642>>>>>>>    //         server using Workgroup authentication mode
76642>>>>>>>    //       C for client cache engine
76642>>>>>>>    //       D for DOS workstation
76642>>>>>>>    //       N for client Requester
76642>>>>>>>    //       S for NetWare server
76642>>>>>>>    //       T for 32-bit Windows server engine
76642>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
76642>>>>>>>    //
76642>>>>>>>    //   example:
76642>>>>>>>    //       8.50.T
76642>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
76642>>>>>>>    //   32-bits Windows server.
76642>>>>>>>    //
76642>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
76642>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
76642>>>>>>>    //
76642>>>>>>>    //   If the version information is not available or can not be obtained
76642>>>>>>>    //   the functions will return "0.0.0"
76642>>>>>>>
76642>>>>>>>
76642>>>>>>>    //***
76642>>>>>>>    //*** Function: PSQLRequesterVersionInfo
76642>>>>>>>    //*** Purpose : Returns the version information of the
76642>>>>>>>    //***           Pervasive.SQL Client requester.
76642>>>>>>>
76642>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76644>>>>>>>
76644>>>>>>>        Local String  sDriverID
76644>>>>>>>        Local String  sVersion
76644>>>>>>>        Local String  sVoid
76644>>>>>>>        Local Integer iRetval
76644>>>>>>>
76644>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76644>>>>>>>        // This error would otherwise be raised when we have an older
76644>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76644>>>>>>>        Send Ignore_error To Error_object_Id 20491
76645>>>>>>>        Get psDriverID To sDriverID
76646>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76647>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76652>>>>>>>        Send Trap_Error To Error_object_Id 20491
76653>>>>>>>        If (Trim(sVersion) = "") Begin
76655>>>>>>>            // Unable to get the revision. return all zeroes.
76655>>>>>>>            Move "0.0.0" To sVersion
76656>>>>>>>        End
76656>>>>>>>>
76656>>>>>>>        Function_Return sVersion
76657>>>>>>>    End_Function //  PSQLRequesterVersion
76658>>>>>>>
76658>>>>>>>    //***
76658>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
76658>>>>>>>    //*** Purpose : Returns the version information of the
76658>>>>>>>    //***           Pervasive.SQL Local Engine
76658>>>>>>>
76658>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76660>>>>>>>
76660>>>>>>>        Local String  sDriverID
76660>>>>>>>        Local String  sVersion
76660>>>>>>>        Local String  sVoid
76660>>>>>>>        Local Integer iRetval
76660>>>>>>>
76660>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76660>>>>>>>        // This error would otherwise be raised when we have an older
76660>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76660>>>>>>>        Send Ignore_error To Error_object_Id 20491
76661>>>>>>>        Get psDriverID To sDriverID
76662>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76663>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76668>>>>>>>        Send Trap_Error To Error_object_Id 20491
76669>>>>>>>        If (Trim(sVersion) = "") Begin
76671>>>>>>>            // Unable to get the revision. return all zeroes.
76671>>>>>>>            Move "0.0.0" To sVersion
76672>>>>>>>        End
76672>>>>>>>>
76672>>>>>>>        Function_Return sVersion
76673>>>>>>>    End_Function //  PSQLLocalEngineVersion
76674>>>>>>>
76674>>>>>>>    //***
76674>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
76674>>>>>>>    //*** Purpose : Returns the version information of the
76674>>>>>>>    //***           Pervasive.SQL Server Engine
76674>>>>>>>
76674>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76676>>>>>>>
76676>>>>>>>        Local String  sDriverID
76676>>>>>>>        Local String  sVersion
76676>>>>>>>        Local String  sVoid
76676>>>>>>>        Local Integer iRetval
76676>>>>>>>
76676>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76676>>>>>>>        // This error would otherwise be raised when we have an older
76676>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76676>>>>>>>        Send Ignore_error To Error_object_Id 20491
76677>>>>>>>        Get psDriverID To sDriverID
76678>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76679>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76684>>>>>>>        Send Trap_Error To Error_object_Id 20491
76685>>>>>>>        If (Trim(sVersion) = "") Begin
76687>>>>>>>            // Unable to get the revision. return all zeroes.
76687>>>>>>>            Move "0.0.0" To sVersion
76688>>>>>>>        End
76688>>>>>>>>
76688>>>>>>>        Function_Return sVersion
76689>>>>>>>    End_Function //  PSQLServerEngineVersion
76690>>>>>>>
76690>>>>>>>End_Class // cDfbtrdrvHandler
76691>>>>>>>
76691>>>>>
76691>>>>>
76691>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
76692>>>>>
76692>>>>>Register_Function phoWorkspace Returns Handle
76692>>>>>Register_Function Help_filename Returns String
76692>>>>>Register_Function GetHelpFile Returns String
76692>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
76692>>>>>
76692>>>>>//****************************************************************************
76692>>>>>// $Module type: FUNCTION
76692>>>>>// $Module name: Network_User_Name
76692>>>>>// $Author     : AK/VOO/KCR
76692>>>>>// Created     : 09-24-96 @ 19:17
76692>>>>>//
76692>>>>>// Description
76692>>>>>//    This function reads the current username Of windows and returns that
76692>>>>>//    name or an text unknown user
76692>>>>>//
76692>>>>>// $Rev History
76692>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
76692>>>>>//  07/25/2003  Replaced obsolete code
76692>>>>>//  09/24/1996  Module header created
76692>>>>>//****************************************************************************
76692>>>>>Function Network_User_Name for cDesktop Returns String
76694>>>>>    String sName
76694>>>>>    Integer iRetval iLength
76694>>>>>
76694>>>>>    Move 0 to iLength
76695>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
76696>>>>>    ZeroString iLength to sName
76697>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
76698>>>>>
76698>>>>>    If (iRetval = NO_ERROR) Begin
76700>>>>>        Function_Return (CString (sName))
76701>>>>>    End
76701>>>>>>
76701>>>>>    
76701>>>>>    Function_Return "User Unknown"
76702>>>>>End_Function
76703>>>>>
76703>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
76703>>>>>Type MEMORYSTATUS
76703>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
76703>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
76703>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
76703>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
76703>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
76703>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
76703>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
76703>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
76703>>>>>End_Type // MEMORYSTATUS
76703>>>>>
76703>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
76704>>>>>
76704>>>>>Struct tWinMemoryStatusEx
76704>>>>>    UInteger dwLength                
76704>>>>>    UInteger dwMemoryLoad          
76704>>>>>    UBigInt ullTotalPhys           
76704>>>>>    UBigInt ullAvailPhys           
76704>>>>>    UBigInt ullTotalPageFile       
76704>>>>>    UBigInt ullAvailPageFile       
76704>>>>>    UBigInt ullTotalVirtual        
76704>>>>>    UBigInt ullAvailVirtual        
76704>>>>>    UBigInt ullAvailExtendedVirtual
76704>>>>>End_Struct
76704>>>>>
76704>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
76705>>>>>
76705>>>>>Class SysinfoDisplay is a cTextEdit
76706>>>>>    Procedure Construct_Object
76708>>>>>        Forward Send Construct_Object
76710>>>>>
76710>>>>>        Set Location To 6 6
76711>>>>>        Set Size To 110 255
76712>>>>>        Set Read_Only_State To True
76713>>>>>        Set pbWrap to False
76714>>>>>    End_Procedure
76715>>>>>
76715>>>>>    //****************************************************************************
76715>>>>>    // $Module type: PROCEDURE
76715>>>>>    // $Module name: Show_Current_Directory
76715>>>>>    // $Author     : VOO
76715>>>>>    // Created     : 06-10-96 @ 15:24
76715>>>>>    //
76715>>>>>    // Description
76715>>>>>    //    This method will show the name Of the current directory in the system
76715>>>>>    //    information box
76715>>>>>    //
76715>>>>>    // $Rev History
76715>>>>>    //    06-10-96  Module header created
76715>>>>>    //****************************************************************************
76715>>>>>    Procedure Show_Current_Directory
76717>>>>>        String sDir
76717>>>>>
76717>>>>>        Get_Current_Directory To sDir
76718>>>>>
76718>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
76719>>>>>    End_Procedure
76720>>>>>
76720>>>>>    Procedure Show_Windows_Directory
76722>>>>>        String sWindir
76722>>>>>
76722>>>>>        Get_Windows_Directory To sWindir
76723>>>>>
76723>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
76724>>>>>    End_Procedure
76725>>>>>
76725>>>>>    Procedure Show_Current_User
76727>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
76728>>>>>    End_Procedure
76729>>>>>
76729>>>>>    Procedure Show_Number_Format
76731>>>>>        Integer iFormat
76731>>>>>        String sFormatText
76731>>>>>
76731>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
76734>>>>>        Move (Character (iFormat)) To sFormatText
76735>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
76736>>>>>
76736>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
76739>>>>>        Move (Character (iFormat)) to sFormatText
76740>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
76741>>>>>    End_Procedure
76742>>>>>
76742>>>>>    Procedure Show_Filelist_Name
76744>>>>>        String sFilename
76744>>>>>
76744>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
76747>>>>>
76747>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
76748>>>>>        Send AppendTextLn ""
76749>>>>>    End_Procedure
76750>>>>>
76750>>>>>    Procedure Show_Lock_Delay
76752>>>>>        Integer iLockdelay
76752>>>>>
76752>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
76755>>>>>
76755>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
76756>>>>>    End_Procedure
76757>>>>>
76757>>>>>    Procedure Show_Lock_Timeout
76759>>>>>        Integer iLockTimeout
76759>>>>>
76759>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
76762>>>>>
76762>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
76763>>>>>    End_Procedure
76764>>>>>
76764>>>>>    Procedure Show_Screen_Size
76766>>>>>        Integer iYscreensize iXscreensize
76766>>>>>
76766>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
76767>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
76768>>>>>
76768>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
76769>>>>>    End_Procedure
76770>>>>>
76770>>>>>    Procedure Show_Page_Size
76772>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
76773>>>>>    End_procedure
76774>>>>>
76774>>>>>    Procedure Show_Date
76776>>>>>        Date dToday
76776>>>>>
76776>>>>>        Sysdate dToday
76777>>>>>
76777>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
76778>>>>>    End_procedure
76779>>>>>
76779>>>>>    Procedure Show_Date_Format
76781>>>>>        Integer iDateFormat
76781>>>>>        String sDateFormat
76781>>>>>
76781>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
76784>>>>>        Case Begin
76784>>>>>            Case (iDateFormat = DF_DATE_USA)
76786>>>>>                Move C_$USA To sDateFormat
76787>>>>>                Case Break
76788>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
76791>>>>>                Move C_$European To sDateFormat
76792>>>>>                Case Break
76793>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
76796>>>>>                Move C_$Military To sDateFormat
76797>>>>>                Case Break
76798>>>>>            Case Else
76798>>>>>                Move C_$UnknownDateType To sDateFormat
76799>>>>>                Case Break
76800>>>>>        Case End
76800>>>>>
76800>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
76801>>>>>    End_Procedure
76802>>>>>
76802>>>>>    Procedure Show_Systemresources
76804>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76804>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76804>>>>>        Integer iRetval
76804>>>>>
76804>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
76805>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
76806>>>>>        If (iRetval = 0) Begin
76808>>>>>            Move (ShowLastError ()) to iRetval
76809>>>>>        End
76809>>>>>>
76809>>>>>
76809>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
76810>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
76811>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
76812>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
76813>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
76814>>>>>    End_Procedure
76815>>>>>
76815>>>>>    Procedure Show_Registration
76817>>>>>        String sRegName
76817>>>>>        Integer iSN iMaxUsers
76817>>>>>
76817>>>>>        Registration sRegName iSN
76818>>>>>>
76818>>>>>        
76818>>>>>        Get_Licensed_Max_Users to iMaxUsers
76819>>>>>
76819>>>>>        Send AppendTextLn ""
76820>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
76821>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
76822>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
76823>>>>>    End_Procedure
76824>>>>>
76824>>>>>    //****************************************************************************
76824>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
76824>>>>>    // To the workspace object passing the an object and message To send back
76824>>>>>    // To this object. It is expected that the workspace object will send this
76824>>>>>    // message for every line Of information it wants displayed (passing the
76824>>>>>    // information To be displayed
76824>>>>>    //****************************************************************************
76824>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
76824>>>>>
76824>>>>>    Procedure Show_ServicePack
76826>>>>>        String sKey sVersionDescription sVersion 
76826>>>>>        Handle hoRegistry
76826>>>>>        Boolean bExists bOpened
76826>>>>>        
76826>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
76827>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
76828>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
76829>>>>>
76829>>>>>        Move C_DFVersionRegistryRoot to sKey
76830>>>>>        Get KeyExists of hoRegistry sKey to bExists
76831>>>>>        If (bExists) Begin
76833>>>>>            Get OpenKey of hoRegistry sKey to bOpened
76834>>>>>            If (bOpened) Begin
76836>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
76837>>>>>                If (bExists) Begin
76839>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
76840>>>>>                End
76840>>>>>>
76840>>>>>                
76840>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
76841>>>>>                If (bExists) Begin
76843>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
76844>>>>>                End                
76844>>>>>>
76844>>>>>                Send CloseKey of hoRegistry
76845>>>>>            End
76845>>>>>>
76845>>>>>        End
76845>>>>>>
76845>>>>>        Send Destroy of hoRegistry
76846>>>>>
76846>>>>>        If (sVersionDescription <> "") Begin
76848>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
76849>>>>>           Send AppendTextLn ""
76850>>>>>        End
76850>>>>>>
76850>>>>>    End_Procedure
76851>>>>>    
76851>>>>>
76851>>>>>    Procedure Show_WorkspaceInformation
76853>>>>>        Integer hoWorkspace
76853>>>>>
76853>>>>>        If (ghoApplication <> 0) Begin
76855>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
76856>>>>>            If (hoWorkspace <> 0) Begin
76858>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
76859>>>>>                Send AppendTextLn ""
76860>>>>>            End
76860>>>>>>
76860>>>>>        End
76860>>>>>>
76860>>>>>    End_Procedure
76861>>>>>
76861>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
76863>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
76864>>>>>    End_Function
76865>>>>>
76865>>>>>    Procedure Show_Versions
76867>>>>>        Integer iVersion iRevision iBuild
76867>>>>>
76867>>>>>        Version_Information iVersion iRevision iBuild
76869>>>>>
76869>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
76870>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
76871>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
76872>>>>>    End_Procedure
76873>>>>>    
76873>>>>>    Function CKRevisionNumber String sDriverID Returns String
76875>>>>>        Handle hoCLIHandler
76875>>>>>        Handle hoDFBtrDrvHandler
76875>>>>>        String sCKRevision
76875>>>>>
76875>>>>>
76875>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
76877>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
76878>>>>>            Set psDriverID of hoCLIHandler to sDriverID
76879>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
76880>>>>>            Send Destroy of hoCLIHandler
76881>>>>>        End
76881>>>>>>
76881>>>>>        Else Begin
76882>>>>>            If (sDriverID = "DFBTRDRV") Begin
76884>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
76885>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
76886>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
76887>>>>>                Send Destroy of hoDFBtrDrvHandler
76888>>>>>            End
76888>>>>>>
76888>>>>>        End
76888>>>>>>
76888>>>>>        
76888>>>>>        Function_Return sCKRevision
76889>>>>>    End_Function
76890>>>>>    
76890>>>>>    
76890>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
76892>>>>>        
76892>>>>>        If (sDriverID = "DATAFLEX") Begin
76894>>>>>            Function_Return False
76895>>>>>        End
76895>>>>>>
76895>>>>>    
76895>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
76896>>>>>    End_Function    
76897>>>>>
76897>>>>>
76897>>>>>    //***
76897>>>>>    //*** BW
76897>>>>>    //*** Procedure: Show_Drivers
76897>>>>>    //*** Purpose  : Show loaded database drivers
76897>>>>>    //***
76897>>>>>
76897>>>>>    Procedure Show_Drivers
76899>>>>>        String sCurrentDriver sRevNumber
76899>>>>>        String sLoadedDrivers
76899>>>>>        Integer iNumberOfDrivers iCount
76899>>>>>        Boolean bOK
76899>>>>>
76899>>>>>        Move "" To sLoadedDrivers
76900>>>>>        Get_Attribute DF_NUMBER_DRIVERS To iNumberOfDrivers
76903>>>>>        For iCount From 1 To iNumberOfDrivers
76909>>>>>>
76909>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
76912>>>>>            If (sLoadedDrivers <> "") Begin
76914>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
76915>>>>>            End
76915>>>>>>
76915>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
76916>>>>>            If (bOK) Begin
76918>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
76919>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
76920>>>>>            End
76920>>>>>>
76920>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) To sLoadedDrivers
76921>>>>>        Loop
76922>>>>>>
76922>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
76923>>>>>    End_Procedure
76924>>>>>
76924>>>>>    Procedure Show_HelpFile
76926>>>>>        String sHelpFile
76926>>>>>        Integer eHelpType
76926>>>>>
76926>>>>>        If (ghoApplication <> 0) Begin
76928>>>>>            Get peHelpType Of ghoApplication To eHelpType
76929>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
76931>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
76932>>>>>            End
76932>>>>>>
76932>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
76935>>>>>                Get Help_filename Of Help_object_id To sHelpFile
76936>>>>>            End
76936>>>>>>
76936>>>>>            Else Begin
76937>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
76938>>>>>            End
76938>>>>>>
76938>>>>>
76938>>>>>            Send AppendTextLn ""
76939>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
76940>>>>>        End
76940>>>>>>
76940>>>>>    End_Procedure
76941>>>>>
76941>>>>>    Procedure Show_EnterAsTab
76943>>>>>        Boolean bEnterKeyAsTabKey
76943>>>>>        String sText
76943>>>>>
76943>>>>>        If (ghoApplication <> 0) Begin
76945>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
76946>>>>>            If (bEnterKeyAsTabKey) Begin
76948>>>>>                Move "True" To sText
76949>>>>>            End
76949>>>>>>
76949>>>>>            Else Begin
76950>>>>>                Move "False" To sText
76951>>>>>            End
76951>>>>>>
76951>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
76952>>>>>        End
76952>>>>>>
76952>>>>>    End_Procedure
76953>>>>>
76953>>>>>    //****************************************************************************
76953>>>>>    // $Module type: PROCEDURE
76953>>>>>    // $Module name: Add_Focus
76953>>>>>    // $Author     : VOO
76953>>>>>    // Created     : 24-09-96 @ 19:43
76953>>>>>    //
76953>>>>>    // Description
76953>>>>>    //    During activation we will remove the old information and add the newly
76953>>>>>    //    found systeminformation
76953>>>>>    //
76953>>>>>    // $Rev History
76953>>>>>    //    24-09-96  Module header created
76953>>>>>    //****************************************************************************
76953>>>>>    Procedure Add_Focus Integer hoRoot
76955>>>>>        Forward Send Add_Focus hoRoot
76957>>>>>
76957>>>>>        Send Delete_Data
76958>>>>>
76958>>>>>        Set Changed_State To False
76959>>>>>        Set Read_Only_State To True
76960>>>>>
76960>>>>>        Send Show_ServicePack
76961>>>>>        Send Show_Versions   
76962>>>>>        Send Show_Drivers         
76963>>>>>        Send Show_HelpFile
76964>>>>>        Send Show_Current_Directory
76965>>>>>        Send Show_Filelist_Name          
76966>>>>>        If (ghoApplication <> 0) Begin
76968>>>>>            Send Show_WorkSpaceInformation // added To show WS info
76969>>>>>        End
76969>>>>>>
76969>>>>>        Send Show_Current_User 
76970>>>>>        Send Show_Windows_Directory 
76971>>>>>        Send Show_Screen_Size
76972>>>>>        Send Show_Page_Size
76973>>>>>        Send Show_EnterAsTab        
76974>>>>>        Send Show_Number_Format
76975>>>>>        Send Show_Date_Format
76976>>>>>        Send Show_Lock_Delay
76977>>>>>        Send Show_Lock_Timeout
76978>>>>>        Send Show_Date
76979>>>>>        Send Show_Systemresources
76980>>>>>        Send Show_Registration
76981>>>>>        Send Beginning_of_Data
76982>>>>>
76982>>>>>        Set Icon to 'default.ico'
76983>>>>>    End_Procedure
76984>>>>>End_Class
76985>>>>>
76985>>>>>//****************************************************************************
76985>>>>>// $Module type: OBJECT
76985>>>>>// $Module name: Sysinfo_Dialog
76985>>>>>// $Author     : VOO
76985>>>>>// Created     : 24-09-96 @ 18:47
76985>>>>>//
76985>>>>>// Description
76985>>>>>//    This object shows the systeminformation on the screen
76985>>>>>//
76985>>>>>// $Rev History
76985>>>>>//    24-09-96  Module header created
76985>>>>>//****************************************************************************
76985>>>>>Class SysInfoDialog Is A ModalPanel
76986>>>>>    Procedure Construct_Object
76988>>>>>        Forward Send Construct_Object
76990>>>>>
76990>>>>>        Set Label to C_$SystemInformation
76991>>>>>        Set Size to 140 267
76992>>>>>        Set piMinSize to 140 267
76993>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
76994>>>>>        Set Border_Style to Border_Thick
76995>>>>>
76995>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
76997>>>>>            Set peAnchors to anAll
76998>>>>>        End_Object
76999>>>>>
76999>>>>>        Object oCloseButton Is A Button
77001>>>>>            Set Label To C_$Close
77002>>>>>            Set Location To 120 210
77003>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
77004>>>>>            Set Default_State To True
77005>>>>>            Set peAnchors to anBottomRight
77006>>>>>        End_Object
77007>>>>>
77007>>>>>        On_Key kCancel Send Close_Panel
77008>>>>>    End_Procedure
77009>>>>>End_Class
77010>>>>>
77010>>>>>// Purpose:
77010>>>>>//
77010>>>>>// Ken Ross 12/17/96 5:16PM
77010>>>>>//
77010>>>>>Class AboutDialog Is A ModalPanel
77011>>>>>    Procedure Construct_Object
77013>>>>>        String sVdfRootDir
77013>>>>>
77013>>>>>        Forward Send Construct_Object
77015>>>>>
77015>>>>>        Set Label To C_$About
77016>>>>>        Set Size to 89 212
77017>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77018>>>>>
77018>>>>>        Object oSysInfoDialog Is A SysInfoDialog
77020>>>>>        End_Object
77021>>>>>
77021>>>>>        Object oBox Is A Container3d
77023>>>>>            Set Border_Style To Border_StaticEdge
77024>>>>>            Set Size to 63 202
77025>>>>>            Set Location To 4 5
77026>>>>>
77026>>>>>            Object oAboutGraphic Is A BitmapContainer
77028>>>>>                Set Border_Style To Border_None
77029>>>>>                Set Bitmap_Style To Bitmap_Center
77030>>>>>                Set Size To 48 48
77031>>>>>                Set Location To 7 2
77032>>>>>            End_Object
77033>>>>>
77033>>>>>            Object oProductName Is A TextBox
77035>>>>>                Set Label To C_$ProductName
77036>>>>>                Set Size To 10 45
77037>>>>>                Set Location To 8 53
77038>>>>>            End_Object
77039>>>>>
77039>>>>>            Object oVersion Is A TextBox
77041>>>>>                Set Label To C_$Version
77042>>>>>                Set Size To 10 25
77043>>>>>                Set Location To 21 53
77044>>>>>            End_Object
77045>>>>>
77045>>>>>            Object oCopyright Is A TextBox
77047>>>>>                Set Label To C_$Copyright
77048>>>>>                Set Size To 10 31
77049>>>>>                Set Location To 34 53
77050>>>>>            End_Object
77051>>>>>
77051>>>>>            Object oAuthor Is A TextBox
77053>>>>>                Set Label To C_$Author
77054>>>>>                Set Size To 10 22
77055>>>>>                Set Location To 46 53
77056>>>>>            End_Object
77057>>>>>        End_Object
77058>>>>>
77058>>>>>        Object oOKButton Is A Button
77060>>>>>            On_Item C_$OK Send Close_Panel
77061>>>>>            Set Size To 14 50
77062>>>>>            Set Location To 71 157
77063>>>>>        End_Object
77064>>>>>
77064>>>>>        Object oSysInfoButton Is A Button
77066>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
77067>>>>>            Set Size To 14 50
77068>>>>>            Set Location To 71 101
77069>>>>>        End_Object
77070>>>>>
77070>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
77071>>>>>
77071>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
77072>>>>>    End_Procedure
77073>>>>>
77073>>>>>    Procedure Set ProductName String sProductName
77075>>>>>        Set Label Of oProductName To sProductName
77076>>>>>    End_Procedure
77077>>>>>
77077>>>>>    Procedure Set Version String sVersion
77079>>>>>        Set Label Of oVersion To sVersion
77080>>>>>    End_Procedure
77081>>>>>
77081>>>>>    Procedure Set Copyright string sCopyright
77083>>>>>        Set Label Of oCopyright To sCopyright
77084>>>>>    End_Procedure
77085>>>>>
77085>>>>>    Procedure Set Author String sAuthor
77087>>>>>        Set Label Of oAuthor To sAuthor
77088>>>>>    End_Procedure
77089>>>>>
77089>>>>>    Procedure Set Logo string sLogo
77091>>>>>        // square bitmaps Of 42x42 work best
77091>>>>>        Set Bitmap Of oAboutGraphic To sLogo
77092>>>>>    End_Procedure
77093>>>>>
77093>>>>>    Procedure Show_Sysinfo
77095>>>>>        Send Popup_Modal Of oSysinfoDialog
77096>>>>>    End_Procedure
77097>>>>>
77097>>>>>    Procedure End_Construct_Object
77099>>>>>        Handle hoVersionInfo
77099>>>>>        Boolean bIncluded
77099>>>>>        Integer iMajor iMinor iRelease iBuild
77099>>>>>        String sLabel
77099>>>>>
77099>>>>>        Get Label Of oVersion To sLabel
77100>>>>>        If (sLabel = C_$VERSION) Begin
77102>>>>>            // set it To the version info Of the program, if available
77102>>>>>            If (ghoApplication <> 0) Begin
77104>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
77105>>>>>                If (hoVersionInfo <> 0) Begin
77107>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
77108>>>>>                    If (bIncluded) Begin
77110>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
77111>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
77112>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
77113>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
77114>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
77115>>>>>                        Set Version to sLabel
77116>>>>>                    End
77116>>>>>>
77116>>>>>                End
77116>>>>>>
77116>>>>>            End
77116>>>>>>
77116>>>>>        End
77116>>>>>>
77116>>>>>
77116>>>>>        Forward Send End_Construct_Object
77118>>>>>    End_Procedure
77119>>>>>End_Class
77120>>>
77120>>>// *************************************************************************
77120>>>//  Public message. This is the default message. It is expected that you will
77120>>>//   create your own message to override this
77120>>>// *************************************************************************
77120>>>
77120>>>Procedure Activate_About
77123>>>   Send DoAbout "" "" "" "" ""
77124>>>End_Procedure
77125>>>
77125>>>// *************************************************************************
77125>>>//  Public message. It is expected that you will send this message (most
77125>>>//  likely from Activate_About. This creates an about object, activates it
77125>>>//  and destroys it when done. It is not exepected that you will augment this.
77125>>>// *************************************************************************
77125>>>
77125>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
77128>>>        integer hoObj hoMain
77128>>>
77128>>>        // create object
77128>>>        Object About is an AboutDialog
77130>>>            // if no title passed use the label of the main panel
77130>>>            // (if a main panel exists).
77130>>>            if sTitle     eq '' Begin
77132>>>                Get Main_Window of desktop to hoMain
77133>>>                if hoMain Get Label of hoMain to sTitle
77136>>>            end
77136>>>>
77136>>>            set productname to sTitle
77137>>>            set version     to sVersion
77138>>>            set copyright   to sCopyRight
77139>>>            set author      to sAuthor
77140>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
77143>>>            Move self to hoObj // object Id
77144>>>        End_Object
77145>>>        Send Popup   of hoObj    // popup the about object
77146>>>        Send Destroy of hoObj // when done, it will be destroyed
77147>>>End_procedure
77148>        Use Egresos.vw
Including file: Egresos.vw    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\Egresos.vw)
77148>>>Use Windows.pkg
77148>>>Use DFClient.pkg
77148>>>Use DFEntry.pkg
77148>>>Use cDbCJGrid.pkg
77148>>>Use cdbCJGridColumn.pkg
77148>>>Use sql.pkg
Including file: sql.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\sql.pkg)
77148>>>>>//*****************************************************************************
77148>>>>>//*** SQL.pkg                                                               ***
77148>>>>>//***                                                                       ***
77148>>>>>//*** Author: Ben Weijers                                                   ***
77148>>>>>//***         Data Access Wordwide                                          ***
77148>>>>>//***         14 February 2000                                              ***
77148>>>>>//***                                                                       ***
77148>>>>>//*** Purpose:                                                              ***
77148>>>>>//***   Embedded SQL manager.                                               ***
77148>>>>>//***                                                                       ***
77148>>>>>//*** Changes:                                                              ***
77148>>>>>//***                                                                       ***
77148>>>>>//***   March 14, 2001. CLI Connectivity Kits 2.0.0.13                      ***
77148>>>>>//***       Allocate memory before call_driver command with spaces instead  ***
77148>>>>>//***       of binary zeroes.                                               ***
77148>>>>>//***                                                                       ***
77148>>>>>//*****************************************************************************
77148>>>>>
77148>>>>>Use UI
77148>>>>>Use CLI
77148>>>>>Use Case.mac
77148>>>>>
77148>>>>>//Doc/ Ignore=True
77148>>>>>//*** Global object handle for the manager
77148>>>>>Integer _embsqlghoSQLHandleMngr
77148>>>>>
77148>>>>>//*** Global stroage for results
77148>>>>>Integer SQLResult
77148>>>>>
77148>>>>>//*** Embedded SQL function constants
77148>>>>>Define FUNC_SQLCONNECT             For 1000000
77148>>>>>Define FUNC_SQLFILECONNECT         For 1000001
77148>>>>>Define FUNC_SQLDISCONNECT          For 1000002
77148>>>>>Define FUNC_SQLOPEN                For 1000003
77148>>>>>Define FUNC_SQLCLOSE               For 1000004
77148>>>>>Define FUNC_SQLPREPARE             For 1000005
77148>>>>>Define FUNC_SQLEXECUTE             For 1000006
77148>>>>>Define FUNC_SQLEXECDIRECT          For 1000007
77148>>>>>Define FUNC_SQLFETCH               For 1000008
77148>>>>>Define FUNC_SQLCOLUMNINFO          For 1000009
77148>>>>>Define FUNC_SQLCOLUMNVALUE         For 1000010
77148>>>>>Define FUNC_SQLBINDFILE            For 1000011
77148>>>>>Define FUNC_SQLGETDATA             For 1000012
77148>>>>>Define FUNC_SQLCOLSTRINGATTRIBLEN  For 1000013
77148>>>>>Define FUNC_SQLCOLSTRINGATTRIB     For 1000014
77148>>>>>Define FUNC_SQLCOLINTATTRIB        For 1000015
77148>>>>>Define FUNC_SQLSTMTINTATTRIB       For 1000016
77148>>>>>Define FUNC_SQLSETPROCNAME         For 1000017
77148>>>>>DEfine FUNC_SQLSETPROCARG          For 1000018
77148>>>>>Define FUNC_SQLCALL                For 1000019
77148>>>>>Define FUNC_SQLGETPROCARGLEN       For 1000020
77148>>>>>Define FUNC_SQLGETPROCARG          For 1000021
77148>>>>>Define FUNC_SQLGETPROCRETVALLEN    For 1000022
77148>>>>>Define FUNC_SQLGETPROCRETVAL       For 1000023
77148>>>>>Define FUNC_SQLNEXTRESULTSET       For 1000024
77148>>>>>Define FUNC_SQLBUFFERSTATUS        For 1000025
77148>>>>>
77148>>>>>//*** Embedded SQL statement attribute constants
77148>>>>>Define SQLSTMTATTRIB_COLUMNCOUNT    For 1
77148>>>>>Define SQLSTMTATTRIB_ROWCOUNT       For 2
77148>>>>>Define SQLSTMTATTRIB_ROWCOUNT_TYPE  For 3
77148>>>>>
77148>>>>>//*** Embedded SQL column attribute constants
77148>>>>>Define SQLCOLATTRIB_SIZE           For 1
77148>>>>>Define SQLCOLATTRIB_LENGTH         For 1
77148>>>>>Define SQLCOLATTRIB_PRECISION      For 2
77148>>>>>Define SQLCOLATTRIB_LABEL          For 3
77148>>>>>Define SQLCOLATTRIB_BASECOLUMNNAME For 4
77148>>>>>Define SQLCOLATTRIB_BASETABLENAME  For 5
77148>>>>>Define SQLCOLATTRIB_SQLTYPE        For 6
77148>>>>>Define SQLCOLATTRIB_NULLABLE       For 7
77148>>>>>Define SQLCOLATTRIB_DFTYPE         For 8
77148>>>>>
77148>>>>>//*** Possible SQL Column type values
77148>>>>>Define SQL_UNKNOWN_TYPE   For    0
77148>>>>>Define SQL_CHAR           For    1
77148>>>>>Define SQL_NUMERIC        For    2
77148>>>>>Define SQL_DECIMAL        For    3
77148>>>>>Define SQL_INTEGER        For    4
77148>>>>>Define SQL_SMALLINT       For    5
77148>>>>>Define SQL_FLOAT          For    6
77148>>>>>Define SQL_REAL           For    7
77148>>>>>Define SQL_DOUBLE         For    8
77148>>>>>Define SQL_DATETIME       For    9
77148>>>>>Define SQL_VARCHAR        For   12
77148>>>>>Define SQL_TYPE_DATE      For   91
77148>>>>>Define SQL_TYPE_TIME      For   92
77148>>>>>Define SQL_TYPE_TIMESTAMP For   93
77148>>>>>
77148>>>>>Define SQL_DATE           For    9
77148>>>>>Define SQL_INTERVAL       For   10
77148>>>>>Define SQL_TIME           For   10
77148>>>>>Define SQL_TIMESTAMP      For   11
77148>>>>>Define SQL_LONGVARCHAR    For  (-1)
77148>>>>>Define SQL_BINARY         For  (-2)
77148>>>>>Define SQL_VARBINARY      For  (-3)
77148>>>>>Define SQL_LONGVARBINARY  For  (-4)
77148>>>>>Define SQL_BIGINT         For  (-5)
77148>>>>>Define SQL_TINYINT        For  (-6)
77148>>>>>Define SQL_BIT            For  (-7)
77148>>>>>Define SQL_GUID           For (-11)
77148>>>>>
77148>>>>>
77148>>>>>
77148>>>>>//*****************************************************************************
77148>>>>>//*** Class  : cSQLStatement                                                ***
77148>>>>>//*** Purpose: Statement object for embedded sql                            ***
77148>>>>>//***                                                                       ***
77148>>>>>//*** Description:                                                          ***
77148>>>>>//***   An object is created for each statement. These will be children     ***
77148>>>>>//***   of cSQLConnection objects which manage the create and destruction   ***
77148>>>>>//***   of these.                                                           ***
77148>>>>>//*****************************************************************************
77148>>>>>
77148>>>>>Class cSQLStatement is an Array
77149>>>>>
77149>>>>>    Procedure Construct_object Integer Image
77151>>>>>        Forward Send Construct_object Image
77153>>>>>
77153>>>>>        Property Integer phCLIHandle      public 0
77154>>>>>        Property String  psDriverID       Public ""
77155>>>>>        Property Integer phStmtConnection Public 0
77156>>>>>        Property Integer piLastColumn     Public 0
77157>>>>>        Property Integer piLastArgument   Public 0
77158>>>>>        Property Integer piBindFile       Public 0
77159>>>>>
77159>>>>>        Set Delegation_mode To NO_Delegation
77160>>>>>    End_procedure // Construct_object
77161>>>>>
77161>>>>>
77161>>>>>
77161>>>>>    //***
77161>>>>>    //*** Procedure: StoreHandleInfo
77161>>>>>    //*** Purpose  : Store basic information about the statement handle.
77161>>>>>    //***
77161>>>>>
77161>>>>>    Procedure StoreHandleInfo Integer iCLIHandle String sDrvrId Integer iParentHandle
77163>>>>>        Set phCLIHandle      To iCLIHandle
77164>>>>>        Set psDriverID       To sDrvrId
77165>>>>>        Set phStmtConnection To iParentHandle
77166>>>>>    End_Procedure // StoreHandleInfo
77167>>>>>
77167>>>>>
77167>>>>>
77167>>>>>    //***
77167>>>>>    //*** Procedure: FreeHandle
77167>>>>>    //*** Purpose  : Free a handle. Since a handle is stored in an
77167>>>>>    //***            cSQLStatement object, we destroy the object.
77167>>>>>    //***
77167>>>>>
77167>>>>>    Procedure FreeHandle
77169>>>>>        Send Destroy_Object
77170>>>>>    End_Procedure // FreeHandle
77171>>>>>
77171>>>>>
77171>>>>>
77171>>>>>    //***
77171>>>>>    //*** Procedure: HandleError
77171>>>>>    //*** Puprose  : Handle an error that has occured while checking properties.
77171>>>>>    //***
77171>>>>>
77171>>>>>    Procedure HandleError Integer ihstmt Integer ihdbc String sDrvrId String sOriginMsg
77173>>>>>        Local Integer iErrHandle
77173>>>>>        Local Integer iErrNum
77173>>>>>        Local String  sLocationInfo
77173>>>>>
77173>>>>>        //*** Get the DataFlex statement identifier
77173>>>>>        Move Current_object To iErrHandle
77174>>>>>
77174>>>>>        //*** Determine error number
77174>>>>>        If (ihstmt = 0) ;            Move CLIERR_SQLINVALID_CLI_STMT_HANDLE To iErrNum
77177>>>>>        Else If (ihdbc = 0) ;            Move CLIERR_SQLINVALID_CLI_CONN_HANDLE To iErrNum
77181>>>>>        Else If (sDrvrId = "") ;            Move CLIERR_SQLINVALID_DRIVER_ID To iErrNum
77185>>>>>        Else ;            Move CLIERR_SQL_ERROR To iErrNum
77187>>>>>
77187>>>>>        //*** Create location ifnormation
77187>>>>>        Move "[" To sLocationInfo
77188>>>>>        If (sOriginMsg <> "") Begin
77190>>>>>            Move (Append(sLocationInfo, sOriginMsg)) To sLocationInfo
77191>>>>>            Move (Append(sLocationInfo, ", "))       To sLocationInfo
77192>>>>>        End
77192>>>>>>
77192>>>>>        Move (Append(sLocationInfo, "DataFlex hstmt = ")) To sLocationInfo
77193>>>>>        Move (Append(sLocationInfo, iErrHandle))          To sLocationInfo
77194>>>>>        Move (Append(sLocationInfo, "]"))                 To sLocationInfo
77195>>>>>
77195>>>>>        //*** Generate the error
77195>>>>>        Error iErrNum sLocationInfo
77196>>>>>>
77196>>>>>    End_Procedure // HandleError
77197>>>>>
77197>>>>>
77197>>>>>
77197>>>>>    //***
77197>>>>>    //*** Procedure: StmtError
77197>>>>>    //*** Purpose  : Handle general error not related to the properties
77197>>>>>    //***
77197>>>>>
77197>>>>>    Procedure StmtError Integer iErrNum String sErrText String sOriginMsg
77199>>>>>        Local Integer iErrHandle
77199>>>>>        Local String  sLocationInfo
77199>>>>>
77199>>>>>        //*** Get the DataFlex statement identifier
77199>>>>>        Move Current_object To iErrHandle
77200>>>>>
77200>>>>>
77200>>>>>        //*** Create location information
77200>>>>>        Move "[" To sLocationInfo
77201>>>>>        If (sOriginMsg <> "") Begin
77203>>>>>            Move (Append(sLocationInfo, sOriginMsg)) To sLocationInfo
77204>>>>>            Move (Append(sLocationInfo, ", "))       To sLocationInfo
77205>>>>>        End
77205>>>>>>
77205>>>>>        If (sErrtext <> "") Begin
77207>>>>>            Move (Append(sLocationInfo, sErrtext)) To sLocationInfo
77208>>>>>            Move (Append(sLocationInfo, ", "))     To sLocationInfo
77209>>>>>        End
77209>>>>>>
77209>>>>>        Move (Append(sLocationInfo, "DataFlex hstmt = ")) To sLocationInfo
77210>>>>>        Move (Append(sLocationInfo, iErrHandle))          To sLocationInfo
77211>>>>>        Move (Append(sLocationInfo, "]"))                 To sLocationInfo
77212>>>>>
77212>>>>>        //*** Generate the error
77212>>>>>        Error iErrNum sLocationInfo
77213>>>>>>
77213>>>>>    End_Procedure // StmtError
77214>>>>>
77214>>>>>
77214>>>>>
77214>>>>>    //***
77214>>>>>    //*** Procedure: SQLIllegalAttribute
77214>>>>>    //*** Purpose  : Handle an illegal attribute error
77214>>>>>    //***
77214>>>>>
77214>>>>>    Procedure SQLIllegalAttribute String sErrText String sOriginMsg
77216>>>>>        Local Integer bReport
77216>>>>>
77216>>>>>        Get_attribute DF_REPORT_UNSUPPORTED_ATTRIBUTES To bReport
77219>>>>>        If (bReport) ;            Send StmtError CLIERR_SQLINVALID_ATTRIBUTE sErrtext sOriginMsg
77222>>>>>    End_Procedure // SQLIllegalAttribute
77223>>>>>
77223>>>>>
77223>>>>>
77223>>>>>    //***
77223>>>>>    //*** Function: SQLPrivateColumnIsLegal
77223>>>>>    //*** Purpose : Check if a column number is legal
77223>>>>>    //***
77223>>>>>
77223>>>>>    Function SQLPrivateColumnIsLegal Integer ihdbc String sDrvrId Integer ihstmt Integer iCol Returns Integer
77225>>>>>        Local Integer bLegal
77225>>>>>        Local Integer iNumColumns
77225>>>>>
77225>>>>>        Get SQLPrivateStmtAttribute SQLSTMTATTRIB_COLUMNCOUNT ihdbc sDrvrId ihstmt To iNumColumns
77226>>>>>        If (iCol > 0 And iCol <= iNumColumns) ;            Move DFTRUE To bLegal
77229>>>>>        Else ;            Move DFFALSE To bLegal
77231>>>>>
77231>>>>>        Function_Return bLegal
77232>>>>>    End_Function // SQLPrivateColumnIsLegal
77233>>>>>
77233>>>>>
77233>>>>>
77233>>>>>    //***
77233>>>>>    //*** Procedure: SQLClose
77233>>>>>    //*** Purpose  : Close a statement and free all alllocated resources
77233>>>>>    //***
77233>>>>>
77233>>>>>    Procedure SQLClose
77235>>>>>        Local Integer ihdbc
77235>>>>>        Local Integer ihstmt
77235>>>>>        Local Integer iVoid
77235>>>>>        Local String  sDrvrId
77235>>>>>        Local String  sEmpty
77235>>>>>
77235>>>>>        //*** Initialize
77235>>>>>        Move "" To sEmpty
77236>>>>>
77236>>>>>        //*** Get the cli handle to the connection
77236>>>>>        Get phCLIHandle        To ihstmt
77237>>>>>        Get psDriverId         To sDrvrId
77238>>>>>        Get phStmtConnection   To ihdbc
77239>>>>>
77239>>>>>        //*** Free the CLI handle
77239>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77241>>>>>            //*** Call the driver function to close
77241>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCLOSE ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
77246>>>>>
77246>>>>>            //*** Free the DataFlex handle
77246>>>>>            Send FreeHandle
77247>>>>>        End
77247>>>>>>
77247>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLClose"
77249>>>>>    End_procedure // SQLClose
77250>>>>>
77250>>>>>
77250>>>>>
77250>>>>>    //***
77250>>>>>    //*** Procedure: SQLPrepare
77250>>>>>    //*** Purpose  : Prepare a statement for execution
77250>>>>>    //***
77250>>>>>
77250>>>>>    Procedure SQLPrepare String sStatement
77252>>>>>        Local Integer ihdbc
77252>>>>>        Local Integer ihstmt
77252>>>>>        Local Integer iVoid
77252>>>>>        Local String  sDrvrId
77252>>>>>
77252>>>>>        //*** Get the cli handle to the connection
77252>>>>>        Get phCLIHandle       To ihstmt
77253>>>>>        Get psDriverId        To sDrvrId
77254>>>>>        Get phStmtConnection  To ihdbc
77255>>>>>
77255>>>>>        //*** Prepare
77255>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77257>>>>>            //*** Call the driver function to prepare
77257>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLPREPARE ;                        Callback Current_Object ;                        Passing ihdbc sStatement ihstmt ;                        Result iVoid
77262>>>>>        End
77262>>>>>>
77262>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrepare"
77264>>>>>    End_procedure // SQLPrepare
77265>>>>>
77265>>>>>
77265>>>>>
77265>>>>>    //***
77265>>>>>    //*** Procedure: SQLExecute
77265>>>>>    //*** Purpose  : Execute a prepared statement
77265>>>>>    //***
77265>>>>>
77265>>>>>    Procedure SQLExecute
77267>>>>>        Local Integer ihdbc
77267>>>>>        Local Integer ihstmt
77267>>>>>        Local Integer iVoid
77267>>>>>        Local String  sDrvrId
77267>>>>>        Local String  sEmpty
77267>>>>>
77267>>>>>        //*** Initialize
77267>>>>>        Move "" To sEmpty
77268>>>>>
77268>>>>>        //*** Get the cli handle to the connection
77268>>>>>        Get phCLIHandle       To ihstmt
77269>>>>>        Get psDriverId        To sDrvrId
77270>>>>>        Get phStmtConnection  To ihdbc
77271>>>>>
77271>>>>>        //*** Execute
77271>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77273>>>>>            //*** Call the driver function to execute
77273>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLEXECUTE ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
77278>>>>>        End
77278>>>>>>
77278>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLExecute"
77280>>>>>    End_Procedure // SQLExecute
77281>>>>>
77281>>>>>
77281>>>>>
77281>>>>>    //***
77281>>>>>    //*** Procedure: SQLExecDirect
77281>>>>>    //*** Purpose  : Prepare and execute a statement
77281>>>>>    //***
77281>>>>>
77281>>>>>    Procedure SQLExecDirect String sStatement
77283>>>>>        Local Integer ihdbc
77283>>>>>        Local Integer ihstmt
77283>>>>>        Local Integer iVoid
77283>>>>>        Local String  sDrvrId
77283>>>>>
77283>>>>>        //*** Get the cli handle to the connection
77283>>>>>        Get phCLIHandle        To ihstmt
77284>>>>>        Get psDriverId         To sDrvrId
77285>>>>>        Get phStmtConnection   To ihdbc
77286>>>>>
77286>>>>>        //*** ExecDirect
77286>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77288>>>>>            //*** Call the driver function to execdirect
77288>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLEXECDIRECT ;                        Callback Current_Object ;                        Passing ihdbc sStatement ihstmt ;                        Result iVoid
77293>>>>>        End
77293>>>>>>
77293>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLExecDirect"
77295>>>>>    End_procedure // SQLExecDirect
77296>>>>>
77296>>>>>
77296>>>>>
77296>>>>>    //***
77296>>>>>    //*** Procedure: SQLFetch
77296>>>>>    //*** Purpose  : Fetch the next row
77296>>>>>    //*** Returns  : 0   = No more data
77296>>>>>    //***            <>0 = Success
77296>>>>>    //***
77296>>>>>
77296>>>>>    Function SQLFetch Returns Integer
77298>>>>>        Local Integer ihdbc
77298>>>>>        Local Integer ihstmt
77298>>>>>        Local Integer iResult
77298>>>>>        Local String  sDrvrId
77298>>>>>        Local String  sEmpty
77298>>>>>
77298>>>>>        //*** Initialize
77298>>>>>        Move "" To sEmpty
77299>>>>>        Move 0  To iResult
77300>>>>>
77300>>>>>        //*** Get the cli handle to the connection
77300>>>>>        Get phCLIHandle        To ihstmt
77301>>>>>        Get psDriverId         To sDrvrId
77302>>>>>        Get phStmtConnection   To ihdbc
77303>>>>>
77303>>>>>        //*** Fetch
77303>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77305>>>>>            Indicate Err False
77306>>>>>
77306>>>>>            //*** Call the driver function to fetch
77306>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLFETCH ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt ;                        Result iResult
77311>>>>>
77311>>>>>            //*** If something went wrong, adjust the result
77311>>>>>            If (Err) ;                Move 0 To iResult
77314>>>>>
77314>>>>>            Set piLastcolumn To 0
77315>>>>>        End
77315>>>>>>
77315>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLFetch"
77317>>>>>
77317>>>>>        Function_return iResult
77318>>>>>    End_Function // SQLFetch
77319>>>>>
77319>>>>>
77319>>>>>
77319>>>>>    //***
77319>>>>>    //*** Function: SQLNextColumn
77319>>>>>    //*** Purpose : Get the next column
77319>>>>>    //***
77319>>>>>
77319>>>>>    Function SQLNextColumn Returns String
77321>>>>>        Local Integer iCol
77321>>>>>        Local String  sResult
77321>>>>>
77321>>>>>        Get piLastColumn To iCol
77322>>>>>        Increment iCol
77323>>>>>        Get SQLColumnValue iCol To sResult
77324>>>>>        Set piLastColumn To iCol
77325>>>>>
77325>>>>>        Function_return sResult
77326>>>>>    End_Function // SQLNextColumn
77327>>>>>
77327>>>>>
77327>>>>>
77327>>>>>    //***
77327>>>>>    //*** Function: SQLColumnValue
77327>>>>>    //*** Purpose : Return the value of a column in a fetched row of a given
77327>>>>>    //***           statement.
77327>>>>>    //***
77327>>>>>
77327>>>>>    Function SQLColumnValue Integer iCol Returns String
77329>>>>>        Local Integer ihdbc
77329>>>>>        Local Integer ihstmt
77329>>>>>        Local String  sDrvrId
77329>>>>>        Local String  sResult
77329>>>>>
77329>>>>>        //*** Initialize
77329>>>>>        Move "" To sResult
77330>>>>>
77330>>>>>        //*** Get the cli handle to the connection
77330>>>>>        Get phCLIHandle       To ihstmt
77331>>>>>        Get psDriverId        To sDrvrId
77332>>>>>        Get phStmtConnection  To ihdbc
77333>>>>>
77333>>>>>        //*** Get the value
77333>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateColumnValue iCol ihdbc sDRvrId ihstmt To sResult
77336>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLColumnValue"
77338>>>>>
77338>>>>>        Function_return sResult
77339>>>>>    End_Function // SQLColumnValue
77340>>>>>
77340>>>>>    Function SQLPrivateColumnValue Integer iCol Integer ihdbc String sDrvrId Integer ihstmt Returns String
77342>>>>>        Local Integer iVoid
77342>>>>>        Local Integer iColSize
77342>>>>>        Local String  sResult
77342>>>>>        Local String  sEmpty
77342>>>>>        Local Integer bLegalColumn
77342>>>>>
77342>>>>>        //*** Initialize
77342>>>>>        Move "" To sEmpty
77343>>>>>
77343>>>>>        //*** Get the value
77343>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77345>>>>>            //*** Check if the column exists
77345>>>>>            Get SQLPrivateColumnIsLegal ihdbc sDrvrId ihstmt iCol To bLegalColumn
77346>>>>>            If (bLegalColumn) Begin
77348>>>>>                //*** Determine the column size
77348>>>>>                Get SQLPrivateColAttribute iCol SQLCOLATTRIB_SIZE ihdbc sDrvrId ihstmt To iColSize
77349>>>>>                If (iColSize > 0) Begin
77351>>>>>                    //*** Setup function arguments
77351>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                Callback Current_Object ;                                Passing ihdbc iCol ihstmt ;                                Result iVoid
77356>>>>>
77356>>>>>                    //*** Allocate
77356>>>>>                    Move (Repeat(' ', iColSize)) To sResult
77357>>>>>
77357>>>>>                    //*** Call the driver function to get the value
77357>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNVALUE ;                                Callback Current_Object ;                                Passing sResult sEmpty 0 ;                                Result iVoid
77362>>>>>                End
77362>>>>>>
77362>>>>>            End
77362>>>>>>
77362>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLPrivateColumnValue"
77364>>>>>        End
77364>>>>>>
77364>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateColumnValue"
77366>>>>>
77366>>>>>        Function_return sResult
77367>>>>>    End_Function // SQLColumnValue
77368>>>>>
77368>>>>>
77368>>>>>
77368>>>>>    //***
77368>>>>>    //*** Procedure: SQLBindFile
77368>>>>>    //*** Purpose  : Add a file to the files used to place the statement result in.
77368>>>>>    //***
77368>>>>>
77368>>>>>    Procedure SQLBindFile Integer iFileNum
77370>>>>>        Local Integer ihdbc
77370>>>>>        Local Integer ihstmt
77370>>>>>        Local Integer iVoid
77370>>>>>        Local String  sDrvrId
77370>>>>>        Local String  sFileType
77370>>>>>        Local Integer bIsOpen
77370>>>>>
77370>>>>>        //*** Get the cli handle to the connection
77370>>>>>        Get phCLIHandle       To ihstmt
77371>>>>>        Get psDriverId        To sDrvrId
77372>>>>>        Get phStmtConnection  To ihdbc
77373>>>>>
77373>>>>>        //*** If a file number is not passed see if we can use the statement's
77373>>>>>        //*** default file number which is usually set with SetFileConnection
77373>>>>>        If (iFileNum = 0) Begin
77375>>>>>            Get piBindFile To iFileNum
77376>>>>>            If (iFileNum = 0) Begin
77378>>>>>                //*** Logic error, if 0 is passed as filenumber, piBindFile should be set.
77378>>>>>                Send StmtError CLIERR_SQLINVALID_BIND_FILE "piBindFile should be set" "SQLBindFile"
77379>>>>>
77379>>>>>                Move 0 to SQLResult
77380>>>>>                Procedure_Return
77381>>>>>            End
77381>>>>>>
77381>>>>>        End
77381>>>>>>
77381>>>>>
77381>>>>>        //*** Bind the file
77381>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77383>>>>>            //*** Chek if the file is open
77383>>>>>            Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
77386>>>>>            If (bIsOpen) Begin
77388>>>>>                //*** Check if the file has the correct type
77388>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sFileType
77391>>>>>                If (sFileType = sDrvrId) Begin
77393>>>>>                    //*** Call the driver function to add a file to a statement
77393>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLBINDFILE ;                                Callback Current_Object ;                                Passing ihdbc iFileNum ihstmt ;                                Result iVoid
77398>>>>>                End
77398>>>>>>
77398>>>>>                Else ;                    Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File" * String(iFileNum) * "type incompatible with statement ("  + sFileType + ")") "SQLBindFile"
77400>>>>>            End
77400>>>>>>
77400>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File not open (number =" * String(iFileNum) + ")") "SQLBindFile"
77402>>>>>        End
77402>>>>>>
77402>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLBindFile"
77404>>>>>    End_Procedure // SQLBindFile
77405>>>>>
77405>>>>>
77405>>>>>
77405>>>>>    //*************************************************************************
77405>>>>>    //*** Function: SQLGetData                                              ***
77405>>>>>    //*** Purpose : Get data of a column.                                   ***
77405>>>>>    //*************************************************************************
77405>>>>>
77405>>>>>    Function SQLGetData Integer iCol Integer iLen Returns String
77407>>>>>        Local Integer ihdbc
77407>>>>>        Local Integer ihstmt
77407>>>>>        Local Integer iVoid
77407>>>>>        Local Integer iColSize
77407>>>>>        Local Integer iResult
77407>>>>>        Local String  sDrvrId
77407>>>>>        Local String  sResult
77407>>>>>        Local String  sEmpty
77407>>>>>        Local Integer bLegalColumn
77407>>>>>
77407>>>>>        //*** Initialize
77407>>>>>        Move "" To sEmpty
77408>>>>>        Move 0 To iResult
77409>>>>>
77409>>>>>        //*** Get the cli handle to the connection
77409>>>>>        Get phCLIHandle       To ihstmt
77410>>>>>        Get psDriverId        To sDrvrId
77411>>>>>        Get phStmtConnection  To ihdbc
77412>>>>>
77412>>>>>        //*** Get the data
77412>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77414>>>>>            //*** Check if the column exists
77414>>>>>            Get SQLPrivateColumnIsLegal ihdbc sDrvrId ihstmt iCol To bLegalColumn
77415>>>>>            If (bLegalColumn) Begin
77417>>>>>                If (iLen = 0) ;                    Get SQLPrivateColumnValue iCol ihdbc sDrvrId ihstmt To sResult
77420>>>>>                Else Begin
77421>>>>>                    //*** Setup function arguments
77421>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                Callback Current_Object ;                                Passing ihdbc iCol ihstmt ;                                Result iVoid
77426>>>>>
77426>>>>>                    //*** Allocate
77426>>>>>                    Move (Repeat(' ', iLen)) To sResult
77427>>>>>
77427>>>>>                    Indicate Err False
77428>>>>>
77428>>>>>                    //*** Call the driver function to get the data
77428>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLGETDATA ;                                Callback Current_Object ;                                Passing sResult sEmpty iLen ;                                Result iResult
77433>>>>>
77433>>>>>                    //*** If something went wrong, adjust the result
77433>>>>>                    If (Err) ;                        Move 0 To iResult
77436>>>>>                End
77436>>>>>>
77436>>>>>            End
77436>>>>>>
77436>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLGetData"
77438>>>>>        End
77438>>>>>>
77438>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLGetData"
77440>>>>>
77440>>>>>        //*** Fill global result
77440>>>>>        Move iResult To SQLResult
77441>>>>>
77441>>>>>        Function_Return sResult
77442>>>>>    End_Function // SQLGetData
77443>>>>>
77443>>>>>
77443>>>>>
77443>>>>>    //***
77443>>>>>    //*** Function: SQLColumnMap
77443>>>>>    //*** Purpose : Map a column name to a number, if the name id not found no
77443>>>>>    //***           error is generated the returned number will be 0 (zero) in
77443>>>>>    //***           that case
77443>>>>>    //***
77443>>>>>
77443>>>>>    Function SQLColumnMap String sColname Returns Integer
77445>>>>>        Local Integer ihdbc
77445>>>>>        Local Integer ihstmt
77445>>>>>        Local Integer iNumColumns
77445>>>>>        Local Integer iColCount
77445>>>>>        Local Integer iColNum
77445>>>>>        Local String  sDrvrId
77445>>>>>        Local String  sCurColName
77445>>>>>
77445>>>>>        //*** Get the cli handle to the connection
77445>>>>>        Get phCLIHandle       To ihstmt
77446>>>>>        Get psDriverId        To sDrvrId
77447>>>>>        Get phStmtConnection  To ihdbc
77448>>>>>
77448>>>>>        //*** Get the number by looping through the column names
77448>>>>>        Move 0 To iColNum
77449>>>>>        Get SQLPrivateStmtAttribute SQLSTMTATTRIB_COLUMNCOUNT ihdbc sDrvrId ihstmt To iNumColumns
77450>>>>>        For iColCount From 1 To iNumColumns
77456>>>>>>
77456>>>>>            Get SQLPrivateColAttribute iColCount SQLCOLATTRIB_LABEL ihdbc sDrvrId ihstmt To sCurColName
77457>>>>>            If (Uppercase(Trim(sColName)) = Uppercase(Trim(sCurColName))) ;                Move iColCount To iColNum
77460>>>>>
77460>>>>>            If (iColNum) ;                Break
77463>>>>>        Loop
77464>>>>>>
77464>>>>>
77464>>>>>        Function_return iColNum
77465>>>>>    End_Function // SQLColumnMap
77466>>>>>
77466>>>>>
77466>>>>>
77466>>>>>    //***
77466>>>>>    //*** Function: SQLStmtAttribute
77466>>>>>    //*** Purpose : Get a statement attribute
77466>>>>>    //***
77466>>>>>
77466>>>>>    Function SQLStmtAttribute Integer iAttribId Returns String
77468>>>>>        Local Integer ihdbc
77468>>>>>        Local Integer ihstmt
77468>>>>>        Local String  sResult
77468>>>>>        Local String  sDrvrId
77468>>>>>
77468>>>>>        //*** Initialize
77468>>>>>        Move "" To sResult
77469>>>>>
77469>>>>>        //*** Get the cli handle to the connection
77469>>>>>        Get phCLIHandle       To ihstmt
77470>>>>>        Get psDriverId        To sDrvrId
77471>>>>>        Get phStmtConnection  To ihdbc
77472>>>>>
77472>>>>>        //*** Get the attribute
77472>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateStmtAttribute iAttribId ihdbc sDrvrId ihstmt To sResult
77475>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLStmtAttribute"
77477>>>>>
77477>>>>>        Function_Return sResult
77478>>>>>    End_Function // SQLStmtAttibute
77479>>>>>
77479>>>>>    Function SQLPrivateStmtAttribute Integer iAttribId Integer ihdbc String sDrvrId Integer ihstmt Returns String
77481>>>>>        Local String  sResult
77481>>>>>        Local Integer iLen
77481>>>>>        Local Integer bLegalAttrib
77481>>>>>
77481>>>>>        //*** Initialize
77481>>>>>        Move ""     To sResult
77482>>>>>
77482>>>>>        //*** Get the attribute
77482>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77484>>>>>            Case Begin
77484>>>>>                Case (iAttribId = SQLSTMTATTRIB_COLUMNCOUNT)
77486>>>>>                Case (iAttribId = SQLSTMTATTRIB_ROWCOUNT)
77489>>>>>                Case (iAttribId = SQLSTMTATTRIB_ROWCOUNT_TYPE)
77492>>>>>                    Move DFTRUE To bLegalAttrib
77493>>>>>                    Break
77494>>>>>
77494>>>>>                Case Else
77494>>>>>                    Move DFFALSE To bLegalAttrib
77495>>>>>                    Send SQLIllegalAttribute ("Attribute is = " + String(iAttribId) + ")") "SQLPrivateStmtAttribute"
77496>>>>>            Case End
77496>>>>>
77496>>>>>            If (bLegalAttrib) Begin
77498>>>>>                //*** Setup function arguments
77498>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLSTMTINTATTRIB ;                            Callback Current_Object ;                            Passing ihdbc iAttribId ihstmt ;                            Result sResult
77503>>>>>            End
77503>>>>>>
77503>>>>>        End
77503>>>>>>
77503>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateStmtAttribute"
77505>>>>>
77505>>>>>        Function_Return sResult
77506>>>>>    End_Function // SQLPrivateStmtAttribute
77507>>>>>
77507>>>>>
77507>>>>>
77507>>>>>    //***
77507>>>>>    //*** Function: SQLColAttribute
77507>>>>>    //*** Purpose : Get a column's attribute
77507>>>>>    //***
77507>>>>>
77507>>>>>    Function SQLColAttribute Integer iCol Integer iAttribId Returns String
77509>>>>>        Local Integer ihdbc
77509>>>>>        Local Integer ihstmt
77509>>>>>        Local String  sResult
77509>>>>>        Local String  sDrvrId
77509>>>>>
77509>>>>>        //*** Initialize
77509>>>>>        Move "" To sResult
77510>>>>>
77510>>>>>        //*** Get the cli handle to the connection
77510>>>>>        Get phCLIHandle       To ihstmt
77511>>>>>        Get psDriverId        To sDrvrId
77512>>>>>        Get phStmtConnection  To ihdbc
77513>>>>>
77513>>>>>        //*** Get the attribute
77513>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateColAttribute iCol iAttribId ihdbc sDrvrId ihstmt To sResult
77516>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLColAttribute"
77518>>>>>
77518>>>>>        Function_Return sResult
77519>>>>>    End_Function // SQLColAttribute
77520>>>>>
77520>>>>>    Function SQLPrivateColAttribute Integer iCol Integer iAttribId Integer ihdbc String sDrvrId Integer ihstmt Returns String
77522>>>>>        Local String  sResult
77522>>>>>        Local String  sEmpty
77522>>>>>        Local Integer bIsStringAttribute
77522>>>>>        Local Integer iLen
77522>>>>>        Local Integer iVoid
77522>>>>>        Local Integer bLegalAttrib
77522>>>>>        Local Integer bLegalColumn
77522>>>>>
77522>>>>>        //*** Initialize
77522>>>>>        Move "" To sResult
77523>>>>>        Move "" To sEmpty
77524>>>>>        MOve 0  To iLen
77525>>>>>
77525>>>>>        //*** Get the attribute
77525>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77527>>>>>            Get SQLPrivateColumnIsLegal ihdbc sDrvrId ihstmt iCol To bLegalColumn
77528>>>>>            If (bLegalColumn) Begin
77530>>>>>                //*** Determine the atributes type
77530>>>>>                Case Begin
77530>>>>>                    Case (iAttribId = SQLCOLATTRIB_SIZE)
77532>>>>>                    Case (iAttribId = SQLCOLATTRIB_LENGTH)
77535>>>>>                    Case (iAttribId = SQLCOLATTRIB_PRECISION)
77538>>>>>                    Case (iAttribId = SQLCOLATTRIB_SQLTYPE)
77541>>>>>                    Case (iAttribId = SQLCOLATTRIB_NULLABLE)
77544>>>>>                    Case (iAttribId = SQLCOLATTRIB_DFTYPE)
77547>>>>>                        Move DFFALSE To bIsStringAttribute
77548>>>>>                        Move DFTRUE To bLegalAttrib
77549>>>>>                        Break
77550>>>>>
77550>>>>>                    Case (iAttribId = SQLCOLATTRIB_LABEL)
77553>>>>>                    Case (iAttribId = SQLCOLATTRIB_BASECOLUMNNAME)
77556>>>>>                    Case (iAttribId = SQLCOLATTRIB_BASETABLENAME)
77559>>>>>                        Move DFTRUE To bIsStringAttribute
77560>>>>>                        Move DFTRUE To bLegalAttrib
77561>>>>>                        Break
77562>>>>>
77562>>>>>                    Case Else
77562>>>>>                        Move DFFALSE To bLegalAttrib
77563>>>>>                        Send SQLIllegalAttribute ("Attribute is = " + String(iAttribId) + ")") "SQLPrivateColAttribute"
77564>>>>>                Case End
77564>>>>>
77564>>>>>                If (bLegalAttrib) Begin
77566>>>>>                    //*** Setup function arguments
77566>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                Callback Current_Object ;                                Passing ihdbc iCol ihstmt ;                                Result iVoid
77571>>>>>
77571>>>>>                    If (bIsStringAttribute) Begin
77573>>>>>                        //*** Call the driver function to get the data length
77573>>>>>                        Call_driver 0 sDrvrId Function FUNC_SQLCOLSTRINGATTRIBLEN ;                                    Callback Current_Object ;                                    Passing sEmpty sEmpty iAttribId ;                                    Result iLen
77578>>>>>
77578>>>>>                        If (iLen) Begin
77580>>>>>                            //*** Allocate
77580>>>>>                            Move (Repeat(' ', iLen)) To sResult
77581>>>>>
77581>>>>>                            //*** Call the driver function to get the name
77581>>>>>                            Call_driver 0 sDrvrId Function FUNC_SQLCOLSTRINGATTRIB ;                                        Callback Current_Object ;                                        Passing sResult sEmpty iAttribId ;                                        Result iVoid
77586>>>>>                        End
77586>>>>>>
77586>>>>>                    End
77586>>>>>>
77586>>>>>                    Else Begin
77587>>>>>                        //*** get the attribute
77587>>>>>                        Call_driver 0 sDrvrId Function FUNC_SQLCOLINTATTRIB ;                                    Callback Current_Object ;                                    Passing sEmpty sEmpty iAttribId ;                                    Result sResult
77592>>>>>                    End
77592>>>>>>
77592>>>>>                End
77592>>>>>>
77592>>>>>            End
77592>>>>>>
77592>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLPrivateColAttribute"
77594>>>>>        End
77594>>>>>>
77594>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateColAttribute"
77596>>>>>
77596>>>>>        Function_Return sResult
77597>>>>>    End_Function // SQLPrivateColAttribute
77598>>>>>
77598>>>>>
77598>>>>>
77598>>>>>    //***
77598>>>>>    //*** Procedure: SQLSetProcedureName
77598>>>>>    //*** Purpsoe  : Preapre for calling a stored procedure, pass the procedure name.
77598>>>>>    //***
77598>>>>>
77598>>>>>    Procedure SQLSetProcedureName String sProcName
77600>>>>>        Local Integer ihdbc
77600>>>>>        Local Integer ihstmt
77600>>>>>        Local String  sDrvrId
77600>>>>>        Local Integer iVoid
77600>>>>>        Local String  sEmpty
77600>>>>>
77600>>>>>        //*** Initialize
77600>>>>>        Move "" To sEmpty
77601>>>>>
77601>>>>>        //*** Get the cli handle to the connection
77601>>>>>        Get phCLIHandle       To ihstmt
77602>>>>>        Get psDriverId        To sDrvrId
77603>>>>>        Get phStmtConnection  To ihdbc
77604>>>>>
77604>>>>>        //*** Call the procedure
77604>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77606>>>>>            //*** Call the procedure
77606>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLSETPROCNAME ;                        Callback Current_Object ;                        Passing ihdbc sProcName ihstmt ;                        Result iVoid
77611>>>>>
77611>>>>>            Set piLastArgument To 0
77612>>>>>        End
77612>>>>>>
77612>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLSetProcedurename"
77614>>>>>    End_Procedure // SQLSetProcedureName
77615>>>>>
77615>>>>>
77615>>>>>
77615>>>>>    //***
77615>>>>>    //*** Function: SQLSetNextArgument
77615>>>>>    //*** Purpose : Pass the next argument
77615>>>>>    //***
77615>>>>>
77615>>>>>    Procedure SQLSetNextArgument String sArgument
77617>>>>>        Local Integer iArgnum
77617>>>>>
77617>>>>>        Get piLastArgument To iArgnum
77618>>>>>        Increment iArgnum
77619>>>>>        Send SQLSetArgument iArgnum sArgument
77620>>>>>        Set piLastArgument To iArgnum
77621>>>>>    End_Procedure // SQLSetNextArgument
77622>>>>>
77622>>>>>
77622>>>>>
77622>>>>>    //***
77622>>>>>    //*** Procedure: SQLSetArgument
77622>>>>>    //*** Purpose  : Set the next argument
77622>>>>>    //***
77622>>>>>
77622>>>>>    Procedure SQLSetArgument Integer iArgnum String sArgument
77624>>>>>        Local Integer ihdbc
77624>>>>>        Local Integer ihstmt
77624>>>>>        Local String  sDrvrId
77624>>>>>        Local Integer iVoid
77624>>>>>        Local String  sEmpty
77624>>>>>
77624>>>>>        //*** Initialize
77624>>>>>        Move "" To sEmpty
77625>>>>>
77625>>>>>        //*** Get the cli handle to the connection
77625>>>>>        Get phCLIHandle       To ihstmt
77626>>>>>        Get psDriverId        To sDrvrId
77627>>>>>        Get phStmtConnection  To ihdbc
77628>>>>>
77628>>>>>        //*** Call the procedure
77628>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77630>>>>>            //*** Pass the information
77630>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback Current_Object ;                        Passing ihdbc iArgnum ihstmt ;                        Result iVoid
77635>>>>>
77635>>>>>            //*** Pass the argument
77635>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLSETPROCARG ;                        Callback Current_Object ;                        Passing sArgument sEmpty 0 ;                        Result iVoid
77640>>>>>        End
77640>>>>>>
77640>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLSetArgument"
77642>>>>>    End_Procedure // SQLSetArgument
77643>>>>>
77643>>>>>
77643>>>>>
77643>>>>>    //***
77643>>>>>    //*** Procedure: SQLCall
77643>>>>>    //*** Purpose  : Call a stored procedure
77643>>>>>    //***
77643>>>>>
77643>>>>>    Procedure SQLCall
77645>>>>>        Local Integer ihdbc
77645>>>>>        Local Integer ihstmt
77645>>>>>        Local String  sDrvrId
77645>>>>>        Local Integer iVoid
77645>>>>>        Local String  sEmpty
77645>>>>>
77645>>>>>        //*** Initialize
77645>>>>>        Move "" To sEmpty
77646>>>>>
77646>>>>>        //*** Get the cli handle to the connection
77646>>>>>        Get phCLIHandle       To ihstmt
77647>>>>>        Get psDriverId        To sDrvrId
77648>>>>>        Get phStmtConnection  To ihdbc
77649>>>>>
77649>>>>>        //*** Call the procedure
77649>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77651>>>>>            //*** Call the procedure
77651>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCALL ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
77656>>>>>
77656>>>>>            Set piLastArgument To 0
77657>>>>>        End
77657>>>>>>
77657>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLCall"
77659>>>>>    End_Procedure // SQLCall
77660>>>>>
77660>>>>>
77660>>>>>
77660>>>>>    //***
77660>>>>>    //*** Function: SQLGetNextArgument
77660>>>>>    //*** Purpose : Get the next argument
77660>>>>>    //***
77660>>>>>
77660>>>>>    Function SQLGetNextArgument Returns String
77662>>>>>        Local Integer iArgnum
77662>>>>>        Local String  sResult
77662>>>>>
77662>>>>>        Get piLastArgument To iArgnum
77663>>>>>        Increment iArgnum
77664>>>>>        Get SQLGetArgument iArgnum To sResult
77665>>>>>        Set piLastArgument To iArgnum
77666>>>>>
77666>>>>>        Function_return sResult
77667>>>>>    End_Function // SQLGetNextArgument
77668>>>>>
77668>>>>>
77668>>>>>
77668>>>>>    //***
77668>>>>>    //*** Function: SQLGetArgument
77668>>>>>    //*** Purpose : Get the specified argument from a procedure
77668>>>>>    //***
77668>>>>>
77668>>>>>    Function SQLGetArgument Integer iArgnum Returns String
77670>>>>>        Local Integer ihdbc
77670>>>>>        Local Integer ihstmt
77670>>>>>        Local String  sDrvrId
77670>>>>>        Local Integer iVoid
77670>>>>>        Local String  sEmpty
77670>>>>>        Local String  sArgument
77670>>>>>        Local Integer iLen
77670>>>>>
77670>>>>>        //*** Initialize
77670>>>>>        Move "" To sEmpty
77671>>>>>        Move "" To sArgument
77672>>>>>
77672>>>>>        //*** Get the cli handle to the connection
77672>>>>>        Get phCLIHandle       To ihstmt
77673>>>>>        Get psDriverId        To sDrvrId
77674>>>>>        Get phStmtConnection  To ihdbc
77675>>>>>
77675>>>>>        //*** Call the procedure
77675>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77677>>>>>            //*** Pass the information
77677>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback Current_Object ;                        Passing ihdbc iArgnum ihstmt ;                        Result iVoid
77682>>>>>
77682>>>>>            //*** Get the length
77682>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLGETPROCARGLEN ;                        Callback Current_Object ;                        Passing sEmpty sEmpty 0 ;                        Result iLen
77687>>>>>
77687>>>>>            If (iLen) Begin
77689>>>>>                //*** Allocate
77689>>>>>                Move (Repeat(' ', iLen)) To sArgument
77690>>>>>
77690>>>>>                //*** Pass the argument
77690>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLGETPROCARG ;                            Callback Current_Object ;                            Passing sArgument sEmpty 0 ;                            Result iVoid
77695>>>>>            End
77695>>>>>>
77695>>>>>        End
77695>>>>>>
77695>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLGetArgument"
77697>>>>>
77697>>>>>        Function_Return sArgument
77698>>>>>    End_Function // SQLGetArgument
77699>>>>>
77699>>>>>
77699>>>>>
77699>>>>>    //***
77699>>>>>    //*** Function: SQLReturnValue
77699>>>>>    //*** Purpose : Get the reutn value of a stored function
77699>>>>>    //***
77699>>>>>
77699>>>>>    Function SQLReturnValue Returns String
77701>>>>>        Local Integer ihdbc
77701>>>>>        Local Integer ihstmt
77701>>>>>        Local String  sDrvrId
77701>>>>>        Local Integer iVoid
77701>>>>>        Local String  sEmpty
77701>>>>>        Local String  sRetval
77701>>>>>        Local Integer iLen
77701>>>>>
77701>>>>>        //*** Initialize
77701>>>>>        Move "" To sEmpty
77702>>>>>        Move "" To sRetval
77703>>>>>
77703>>>>>        //*** Get the cli handle to the connection
77703>>>>>        Get phCLIHandle       To ihstmt
77704>>>>>        Get psDriverId        To sDrvrId
77705>>>>>        Get phStmtConnection  To ihdbc
77706>>>>>
77706>>>>>        //*** Call the procedure
77706>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77708>>>>>            //*** Get the length
77708>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLGETPROCRETVALLEN ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt  ;                        Result iLen
77713>>>>>
77713>>>>>            If (iLen) Begin
77715>>>>>                //*** Allocate
77715>>>>>                Move (Repeat(' ', iLen)) To sRetval
77716>>>>>
77716>>>>>                //*** Pass the argument
77716>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLGETPROCRETVAL ;                            Callback Current_Object ;                            Passing ihdbc sRetval ihstmt ;                            Result iVoid
77721>>>>>            End
77721>>>>>>
77721>>>>>        End
77721>>>>>>
77721>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLReturnValue"
77723>>>>>
77723>>>>>        Function_Return sRetval
77724>>>>>    End_Function // SQLReturnValue
77725>>>>>
77725>>>>>
77725>>>>>
77725>>>>>    //***
77725>>>>>    //*** Function: SQLNextResultSet
77725>>>>>    //*** Purpose : Switch to the next set
77725>>>>>    //*** Returns : 0   = No more result sets
77725>>>>>    //***           <>0 = Switched to next set
77725>>>>>    //***
77725>>>>>
77725>>>>>    Function SQLNextResultSet Returns Integer
77727>>>>>        Local Integer ihdbc
77727>>>>>        Local Integer ihstmt
77727>>>>>        Local String  sDrvrId
77727>>>>>        Local String  sEmpty
77727>>>>>        Local Integer iResult
77727>>>>>
77727>>>>>        //*** Initialize
77727>>>>>        Move "" To sEmpty
77728>>>>>        Move 0  To iResult
77729>>>>>
77729>>>>>        //*** Get the cli handle to the connection
77729>>>>>        Get phCLIHandle       To ihstmt
77730>>>>>        Get psDriverId        To sDrvrId
77731>>>>>        Get phStmtConnection  To ihdbc
77732>>>>>
77732>>>>>        //*** Call the procedure
77732>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77734>>>>>            //*** Get the length
77734>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLNEXTRESULTSET ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt  ;                        Result iResult
77739>>>>>
77739>>>>>            Set piLastArgument To 0
77740>>>>>        End
77740>>>>>>
77740>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLNextResultSet"
77742>>>>>
77742>>>>>        Function_Return iResult
77743>>>>>    End_Function // SQLNextResultSet
77744>>>>>
77744>>>>>
77744>>>>>
77744>>>>>    //***
77744>>>>>    //*** Procedure: SQLFetchActivatesBuffer
77744>>>>>    //*** Purpose  : Setup a file that will be acivated after a succesfull
77744>>>>>    //***            fetch on the statement
77744>>>>>    //***
77744>>>>>
77744>>>>>    Procedure SQLFetchActivatesBuffer Integer iFileNum Integer bState
77746>>>>>        Local Integer ihdbc
77746>>>>>        Local Integer ihstmt
77746>>>>>        Local String  sDrvrId
77746>>>>>        Local Integer iResult
77746>>>>>        Local Integer bIsOpen
77746>>>>>        Local Integer iVoid
77746>>>>>        Local String  sFileType
77746>>>>>
77746>>>>>        //*** Check if file is open
77746>>>>>        Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
77749>>>>>        If (bIsOpen) Begin
77751>>>>>            //*** Get the cli handle to the connection
77751>>>>>            Get phCLIHandle       To ihstmt
77752>>>>>            Get psDriverId        To sDrvrId
77753>>>>>            Get phStmtConnection  To ihdbc
77754>>>>>
77754>>>>>            //*** Call the procedure
77754>>>>>            If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77756>>>>>                //*** Check if the file has the correct type
77756>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sFileType
77759>>>>>                If (sFileType = sDrvrId) Begin
77761>>>>>                    //*** Setup the buffer
77761>>>>>                    Call_driver iFileNum sDrvrId Function FUNC_SQLBUFFERSTATUS ;                                Callback Current_Object ;                                Passing ihdbc bState ihstmt  ;                                Result iVoid
77766>>>>>                End
77766>>>>>>
77766>>>>>                Else ;                    Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File" * String(iFileNum) * "type incompatible with statement ("  + sFileType + ")") "SQLBindFile"
77768>>>>>            End
77768>>>>>>
77768>>>>>            Else ;                Send HandleError ihstmt ihdbc sDrvrId "SQLFetchActivatesBuffer"
77770>>>>>        End
77770>>>>>>
77770>>>>>        Else ;            Send StmtError CLIERR_SQLINVALID_BUFFER ("File not open (number =" * String(iFileNum) + ")") "SQLFetchActivatesBuffer"
77772>>>>>    End_Procedure // SQLFetchActivatesBuffer
77773>>>>>
77773>>>>>End_Class // cSQLStatement
77774>>>>>
77774>>>>>
77774>>>>>//*****************************************************************************
77774>>>>>//*** Class  : cSQLConnection                                               ***
77774>>>>>//*** Purpose: Connection object for embedded SQL                           ***
77774>>>>>//***                                                                       ***
77774>>>>>//*** Description:                                                          ***
77774>>>>>//***   This provides the ability to create a connection for a driver.      ***
77774>>>>>//***   It will contain child statement objects                             ***
77774>>>>>//*****************************************************************************
77774>>>>>
77774>>>>>Class cSQLConnection is an Array
77775>>>>>
77775>>>>>    Procedure Construct_object Integer Image
77777>>>>>        Forward Send Construct_object Image
77779>>>>>
77779>>>>>        Property Integer phCLIHandle      Public 0
77780>>>>>        Property String  psDriverID       Public ""
77781>>>>>        Property Integer piBindFile       Public 0
77782>>>>>
77782>>>>>        Set Delegation_mode to NO_Delegation
77783>>>>>    End_procedure // COnstruct_object
77784>>>>>
77784>>>>>
77784>>>>>
77784>>>>>    //***
77784>>>>>    //*** Procedure: StoreHandleInfo
77784>>>>>    //*** Purpose  : Store basic information about the statement handle.
77784>>>>>    //***
77784>>>>>
77784>>>>>    Procedure StoreHandleInfo Integer iCLIHandle String sDrvrId Integer iParentHandle
77786>>>>>        Set phCLIHandle      To iCLIHandle
77787>>>>>        Set psDriverID       To sDrvrId
77788>>>>>    End_Procedure // StoreHandleInfo
77789>>>>>
77789>>>>>
77789>>>>>
77789>>>>>    //***
77789>>>>>    //*** Procedure: FreeHandle
77789>>>>>    //*** Purpose : Destroys handle object and all child statement objects
77789>>>>>    //***
77789>>>>>    Procedure FreeHandle
77791>>>>>        Send Destroy_Object
77792>>>>>    End_Procedure // FreeHandle
77793>>>>>
77793>>>>>
77793>>>>>
77793>>>>>    //***
77793>>>>>    //*** Function: SQLConnect
77793>>>>>    //*** Purpose : Make a connectin to an embedded SQL server
77793>>>>>    //*** Returns : The DataFlex handle to the connection
77793>>>>>    //***
77793>>>>>
77793>>>>>    Function SQLConnect string sDrvrID String sConnect Returns Integer
77795>>>>>        Local Integer ihdbc
77795>>>>>        Local String  sEmpty
77795>>>>>
77795>>>>>        //*** Initialize
77795>>>>>        Move "" To sEmpty
77796>>>>>        Move 0  To ihdbc
77797>>>>>
77797>>>>>        Indicate Err False
77798>>>>>
77798>>>>>        //*** Call the driver function to connect
77798>>>>>        Call_driver 0 sDrvrId Function FUNC_SQLCONNECT ;                    Callback current_object ;                    Passing sConnect sEmpty 0 ;                    Result ihdbc
77803>>>>>
77803>>>>>        //*** If there was an error, make result invalid
77803>>>>>        If (Err) ;            Move 0 To ihdbc
77806>>>>>
77806>>>>>        //*** Check result and store it
77806>>>>>        If (ihdbc <> 0) ;            Send StoreHandleInfo ihdbc sDrvrId 0
77809>>>>>
77809>>>>>        //*** Return success status
77809>>>>>        Function_Return (ihdbc <> 0)
77810>>>>>    End_function // SQLConnect
77811>>>>>
77811>>>>>
77811>>>>>
77811>>>>>    //***
77811>>>>>    //*** Function: SQLFileConnect
77811>>>>>    //*** Purpose : Use a connection of an already open file
77811>>>>>    //***
77811>>>>>
77811>>>>>    Function SQLFileConnect Integer iFileNum Returns Integer
77813>>>>>        Local Integer ihdbc
77813>>>>>        Local Integer bIsOpen
77813>>>>>        Local String  sDrvrId
77813>>>>>        Local String  sEmpty
77813>>>>>
77813>>>>>        //*** Initialize
77813>>>>>        Move "" To sEmpty
77814>>>>>        Move 0  To ihdbc
77815>>>>>
77815>>>>>        //*** Check if file is open
77815>>>>>        Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
77818>>>>>        If (bIsOpen) Begin
77820>>>>>            //*** Fill the driver id, assume longest is 255 characters
77820>>>>>            Move (Repeat(' ', 255)) To sDrvrId
77821>>>>>            Get_attribute DF_FILE_DRIVER Of iFileNum To sDrvrId
77824>>>>>
77824>>>>>            Indicate Err False
77825>>>>>
77825>>>>>            //*** Call the driver function to connect
77825>>>>>            Call_driver iFileNum sDrvrId Function FUNC_SQLFILECONNECT ;                        Callback current_object ;                        Passing sEmpty sEmpty 0 ;                        Result ihdbc
77830>>>>>
77830>>>>>            //*** If there was an error, make result invalid
77830>>>>>            If (Err) ;                Move 0 To ihdbc
77833>>>>>
77833>>>>>            //*** Check result and store it
77833>>>>>            If (ihdbc <> 0) Begin
77835>>>>>                //*** Somehow Call_driver overwrites the sDrvrId variable, restore it here
77835>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sDrvrId
77838>>>>>                Send StoreHandleInfo ihdbc sDrvrId 0
77839>>>>>
77839>>>>>                //*** Set filenum so it can be used for fetching
77839>>>>>                Set piBindFile To iFileNum
77840>>>>>            End
77840>>>>>>
77840>>>>>        End
77840>>>>>>
77840>>>>>
77840>>>>>        //*** Return success status
77840>>>>>        Function_Return (ihdbc <> 0)
77841>>>>>    End_Function // SQLFileConnect
77842>>>>>
77842>>>>>
77842>>>>>
77842>>>>>    //***
77842>>>>>    //*** Procedure: SQLDisconnect
77842>>>>>    //*** Purpose  : Disconnect from an embedded SQL server and free allocated
77842>>>>>    //***            resources
77842>>>>>    //***
77842>>>>>
77842>>>>>    Procedure SQLDisconnect
77844>>>>>        Local Integer ihdbc
77844>>>>>        Local Integer iVoid
77844>>>>>        Local String  sDrvrId
77844>>>>>        Local String  sEmpty
77844>>>>>
77844>>>>>        //*** Initialize
77844>>>>>        Move "" To sEmpty
77845>>>>>
77845>>>>>        //*** Get the cli handle
77845>>>>>        Get phCLIHandle To ihdbc
77846>>>>>        Get psDriverId To sDrvrId
77847>>>>>
77847>>>>>        //*** Free the CLI handle
77847>>>>>        If (ihdbc <> 0) Begin
77849>>>>>            //*** Call the driver function to disconnect
77849>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLDISCONNECT ;                        Callback Current_object ;                        Passing sEmpty sEmpty ihdbc ;                        Result iVoid
77854>>>>>
77854>>>>>            //*** Free the DataFlex handle
77854>>>>>            Send FreeHandle
77855>>>>>        End
77855>>>>>>
77855>>>>>    End_Procedure // SQLDisconnect
77856>>>>>
77856>>>>>
77856>>>>>
77856>>>>>    //***
77856>>>>>    //*** Function: CreateHandle
77856>>>>>    //*** Purpose : Creates a child statement handle
77856>>>>>    //***
77856>>>>>
77856>>>>>    Function CreateHandle Returns Integer
77858>>>>>        Local Integer hSQL
77858>>>>>
77858>>>>>        Object oSQLStatement Is A cSQLStatement
77860>>>>>            Move current_object To hSQL
77861>>>>>        End_Object // oSQLStatement
77862>>>>>
77862>>>>>        //*** If the connection has a default Bind File, assign it to the
77862>>>>>        //*** statement object. The default is set when you open a file with a
77862>>>>>        //*** SetFileConnection command.
77862>>>>>        Set piBindFile Of hSQL To (piBindFile(Current_object))
77863>>>>>
77863>>>>>        Function_Return hSQL
77864>>>>>    End_Function // CreateHandle
77865>>>>>
77865>>>>>
77865>>>>>
77865>>>>>    //***
77865>>>>>    //*** Function: SQLOpen
77865>>>>>    //*** Prupose : Open a statement for use
77865>>>>>    //***
77865>>>>>
77865>>>>>    Function SQLOpen Returns Integer
77867>>>>>        Local Integer hDFHandle
77867>>>>>        Local Integer ihdbc
77867>>>>>        Local Integer ihstmt
77867>>>>>        Local Integer iVoid
77867>>>>>        Local String  sDrvrId
77867>>>>>        Local String  sEmpty
77867>>>>>
77867>>>>>        //*** Initialize
77867>>>>>        Move "" To sEmpty
77868>>>>>
77868>>>>>        //*** Get the cli handle to the connection
77868>>>>>        Get phCLIHandle To ihdbc
77869>>>>>        Get psDriverId  To sDrvrId
77870>>>>>
77870>>>>>        //*** Allocate a new handle and populate it
77870>>>>>        If (ihdbc <> 0) Begin
77872>>>>>            //**** Create a new DataFlex handle
77872>>>>>            Get CreateHandle To hDFHandle
77873>>>>>
77873>>>>>            //*** Call the driver function to allocate a statement handle
77873>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLOPEN ;                        Callback Current_object ;                        Passing hDFHandle sEmpty ihdbc ;                        Result ihstmt
77878>>>>>
77878>>>>>            //*** If unsuccessful destroy DF side info
77878>>>>>            If (ihstmt = 0) Begin
77880>>>>>                Send FreeHandle to hDFHandle
77881>>>>>                Move 0 to hDFHandle
77882>>>>>            End
77882>>>>>>
77882>>>>>            Else ;                Send StoreHandleInfo to hDFHandle ihstmt sDrvrId ihdbc
77884>>>>>        End
77884>>>>>>
77884>>>>>
77884>>>>>        Function_return hDFHandle
77885>>>>>    End_function // SQLOpen
77886>>>>>
77886>>>>>End_Class // cSQLConnection
77887>>>>>
77887>>>>>
77887>>>>>
77887>>>>>//*****************************************************************************
77887>>>>>//*** Class  : cSQLHandlemanager                                            ***
77887>>>>>//*** Purpose: Manager for embedded SQL handles.                            ***
77887>>>>>//***                                                                       ***
77887>>>>>//*** Description:                                                          ***
77887>>>>>//***   We want to be able to use multiple drivers and multiple             ***
77887>>>>>//***   connections within a driver and multiple statements within a        ***
77887>>>>>//***   connection. To allow this we have palced our own handle logic on    ***
77887>>>>>//***   top of the driver handle logic. This way we can handle the          ***
77887>>>>>//***   situation where two driver handles may be equal.                    ***
77887>>>>>//*****************************************************************************
77887>>>>>
77887>>>>>Class cSQLHandleManager Is A Array
77888>>>>>
77888>>>>>    Procedure Construct_object Integer Image
77890>>>>>        Forward Send Construct_object Image
77892>>>>>
77892>>>>>        Property String  psDefaultDriver     Public ""
77893>>>>>        Property String  psDefaultConnection Public ""
77894>>>>>
77894>>>>>        Set Delegation_mode to NO_Delegation
77895>>>>>    End_procedure // COnstruct_object
77896>>>>>
77896>>>>>
77896>>>>>
77896>>>>>    //***
77896>>>>>    //*** Function: CreateHandle
77896>>>>>    //*** Purpose : Allocate memory for the desired type of handle
77896>>>>>    //***
77896>>>>>
77896>>>>>    Function CreateHandle Returns Integer
77898>>>>>        Local Integer hSQL
77898>>>>>
77898>>>>>        //*** Create a connection object
77898>>>>>        Object oSQLConnection Is A cSQLConnection
77900>>>>>            Move current_object To hSQL
77901>>>>>        End_Object // oSQLConnection
77902>>>>>
77902>>>>>        Function_Return hSQL
77903>>>>>    End_Function // CreateHandle
77904>>>>>
77904>>>>>
77904>>>>>
77904>>>>>    //***
77904>>>>>    //*** Procedure: SQLSetConnect
77904>>>>>    //*** Purpose  : Store default connection information
77904>>>>>    //***
77904>>>>>
77904>>>>>    Procedure SQLSetConnect String sDriver String sConnect
77906>>>>>        Set psDefaultDriver      To sDriver
77907>>>>>        Set psDefaultConnection  To sConnect
77908>>>>>    End_Procedure // SQLSetConnect
77909>>>>>
77909>>>>>
77909>>>>>
77909>>>>>    //***
77909>>>>>    //*** Function: SQLConnect
77909>>>>>    //*** Purpose : Make a connectin to an embedded SQL server
77909>>>>>    //*** Returns : The DataFlex handle to the connection
77909>>>>>    //***
77909>>>>>
77909>>>>>    Function SQLConnect String sDrvrID String sConnect Returns integer
77911>>>>>        Local Integer hDFHandle
77911>>>>>        Local Integer bOK
77911>>>>>
77911>>>>>        //*** Check arguments
77911>>>>>        If (sDrvrID = "" And sConnect = "") Begin
77913>>>>>            Get psDefaultDriver      To sDrvrId
77914>>>>>            Get psDefaultConnection  To sConnect
77915>>>>>        End
77915>>>>>>
77915>>>>>
77915>>>>>        //*** Allocate a new handle
77915>>>>>        Get CreateHandle To hDFHandle
77916>>>>>        Get SQLConnect of hDFHandle sDrvrID sConnect To bOK
77917>>>>>
77917>>>>>        //*** If failure, kill the handle and return a 0 handle
77917>>>>>        If (Not(bOK)) Begin
77919>>>>>            Send FreeHandle to hDFHandle
77920>>>>>            Move 0 to hDFHandle
77921>>>>>        End
77921>>>>>>
77921>>>>>
77921>>>>>        Function_return hDFHandle
77922>>>>>    End_function // SQLConnect
77923>>>>>
77923>>>>>
77923>>>>>
77923>>>>>    //***
77923>>>>>    //*** Function: SQLFileConnect
77923>>>>>    //*** Purpose : Make an existing connection available for use with Embedded
77923>>>>>    //***           SQL. The connection is identified by the number opf a file
77923>>>>>    //***           that is open for that connection.
77923>>>>>    //***
77923>>>>>
77923>>>>>    Function SQLFileConnect Integer iFileNum Returns Integer
77925>>>>>        Local Integer hDFHandle
77925>>>>>        Local Integer bOK
77925>>>>>
77925>>>>>        //*** Allocate a new handle
77925>>>>>        Get CreateHandle To hDFHandle
77926>>>>>        Get SQLFileConnect of hDFHandle iFileNum To bOK
77927>>>>>
77927>>>>>        //*** If failure, kill the handle and return a 0 handle
77927>>>>>        If (Not(bOK)) Begin
77929>>>>>            Send FreeHandle to hDFHandle
77930>>>>>            Move 0 to hDFHandle
77931>>>>>        End
77931>>>>>>
77931>>>>>
77931>>>>>        Function_return hDFHandle
77932>>>>>    End_Function // SQLFileConnect
77933>>>>>
77933>>>>>End_Class // cSQLHandleManager
77934>>>>>
77934>>>>>
77934>>>>>
77934>>>>>//***
77934>>>>>//*** Function: CreateSQLManager
77934>>>>>//*** Purpose : Create the embedded SQL manager, this is an internal function!
77934>>>>>//***
77934>>>>>
77934>>>>>Function CreateSQLmanager For Desktop Returns Integer
77936>>>>>    Local Integer hoSQlMngr
77936>>>>>
77936>>>>>    Object oSQLHandleManager Is A cSQLHandleManager
77938>>>>>        MOve Current_object To hoSQLMngr
77939>>>>>    End_Object // oSQLHandleManager
77940>>>>>
77940>>>>>    Function_Return hoSQLMngr
77941>>>>>End_Function // CreateSQLMngr
77942>>>>>
77942>>>>>//*** Make sure the object is global by creating it under DESKTOP
77942>>>>>Get CreateSQLManager Of Desktop To _embsqlghoSQLHandleMngr
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLSetConnect                                                ***
77943>>>>>//*** Purpose: Setup default connection information for embedded SQL.       ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLSetConnect sSDriverId sConnectString                      ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLConnect                                                   ***
77943>>>>>//*** Purpose: Connect to a server for embedded SQL usage.                  ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLConnect To hdbc                                           ***
77943>>>>>//***          SQLConnect [sDriverId sConnectString] To hdbc                ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLFileConnect                                               ***
77943>>>>>//*** Purpsoe: Return the handle to a connection of an open file. This      ***
77943>>>>>//***          connection is (obviously) already opened. We are just using  ***
77943>>>>>//***          the same connection for Embedded SQL. This allows the        ***
77943>>>>>//***          programmer not to know connection details.                   ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLFileConnect Filex To hdbc                                 ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLDisconnect                                                ***
77943>>>>>//*** Purpose: Connect to a server for embedded SQL usage.                  ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLDisConnect hdbc                                           ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLOpen                                                      ***
77943>>>>>//*** Purpose: Allocate the memory to stroe statement information.          ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLOpen hdbc To hstmt                                        ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLClose                                                     ***
77943>>>>>//*** Purpose: Close a statement and free all associated memory.            ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLClose hstmt                                               ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLPrepare                                                   ***
77943>>>>>//*** Purpose: Prepare a statement for execution.                           ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLPrepare hstmt sStatement                                  ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLExecute                                                   ***
77943>>>>>//*** Purpose: Execute a prepared statement                                 ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLExecute hstmt                                             ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLExecDirect                                                ***
77943>>>>>//*** Purpose: Prepare and execute a statement.                             ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLExecDirect hstmt sStatement                               ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLFileFetch                                                 ***
77943>>>>>//*** Purpose: Get a row from a statement result set.                       ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLFileFetch hstmt [To File1 [File2 ...]]                    ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLBindFetchFile                                             ***
77943>>>>>//*** Purpose: Binds a file number to a statement so it can be used for     ***
77943>>>>>//***          fetching data. Only needed in non fileconnect. Note that     ***
77943>>>>>//***          can be assigned to the connection or the statement handle    ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLBindFileForFetch hstmt|hdbc FileName|FileNumber           ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLFetch                                                     ***
77943>>>>>//*** Purpose: Get a row from a statement result set.                       ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLFetch hstmt [To Var1 [Var2 ...]]                          ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLGetData                                                   ***
77943>>>>>//*** Purpose: Get a column's data.                                         ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLGetData hstmt iColumnNUmber [Length iLen] To Var          ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLColumnMap                                                 ***
77943>>>>>//*** Purpose: Determine the column number based on the column name.        ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLColumnMap hstmt sColName To iColNumber                    ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLColAttribute                                              ***
77943>>>>>//*** Purpose: Get an attribute of a column in a statements result set.     ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLColAttribute hstmt iCol iAttrId To sAttrib                ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLStmtAttribute                                             ***
77943>>>>>//*** Purpose: Get an atribute of a statement.                              ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLStmtAttribute hstmt iAttribId To sAttrib                  ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLCall                                                      ***
77943>>>>>//*** Purpose: Call a stored procedure.                                     ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLCall hstmt ProcedureName [Arg1 ...] [To Var]              ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLGetArguments                                              ***
77943>>>>>//*** Purpsoe: Get the arguments of a stored procedure. This command should ***
77943>>>>>//***          be used when a procedure has multiple result sets. Some      ***
77943>>>>>//***          backends (SQL SErver for example) will return these as the   ***
77943>>>>>//***          last result set. This emans you first process all other      ***
77943>>>>>//***          result sets and then get the arguments and return value.     ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLGetArguments hstmt [Arg1...] [To Var]                     ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLNextResultSet                                             ***
77943>>>>>//*** Purpose: Go the the next result set. This command should be used when ***
77943>>>>>//***          a procedure call results in multiple result sets. Processing ***
77943>>>>>//***          such procedures can be done by loping through the result     ***
77943>>>>>//***          sets.                                                        ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLNextResultSet hstmt                                       ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>
77943>>>>>//*****************************************************************************
77943>>>>>//*** Command: SQLFetchActivatesBuffer                                      ***
77943>>>>>//*** Purpose: Setup fetch behavior for a file. When set to true a          ***
77943>>>>>//***          succesfull fetch of the statement resutl set will            ***
77943>>>>>//***          automatically set the status of the file's bufer to          ***
77943>>>>>//***          DF_FILE_ACTIVE.                                              ***
77943>>>>>//***                                                                       ***
77943>>>>>//*** Syntax : SQLFetchActivatesBuffer hstmt FileNUmber|FileName sState     ***
77943>>>>>//*****************************************************************************
77943>>>>>
77943>>>>>//Doc/ Ignore=False
77943>>>Use dfLine.pkg
77943>>>Use dfTabDlg.pkg
77943>>>Use TARJETAS.sl
Including file: TARJETAS.sl    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\TARJETAS.sl)
77943>>>>>Use Windows.pkg
77943>>>>>Use DFClient.pkg
77943>>>>>Use cDbCJGridPromptList.pkg
77943>>>>>Use cTIPO_GASTO_DataDictionary.dd
Including file: cTIPO_GASTO_DataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cTIPO_GASTO_DataDictionary.dd)
77943>>>>>>>Use DataDict.pkg
77943>>>>>>>
77943>>>>>>>Open TIPO_GASTO
Including file: TIPO_GASTO.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\TIPO_GASTO.fd)
77945>>>>>>>
77945>>>>>>>Class cTIPO_GASTO_DataDictionary is a DataDictionary
77946>>>>>>>    
77946>>>>>>>    Procedure Construct_Object
77948>>>>>>>        Forward Send Construct_Object
77950>>>>>>>        Set Main_File to TIPO_GASTO.File_Number
77951>>>>>>>
77951>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77952>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77953>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77954>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77955>>>>>>>
77955>>>>>>>    End_Procedure
77956>>>>>>>
77956>>>>>>>End_Class
77957>>>>>Use TARJETA.dd
Including file: TARJETA.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\TARJETA.dd)
77957>>>>>>>Use DataDict.pkg
77957>>>>>>>
77957>>>>>>>Open TARJETA
Including file: TARJETA.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\TARJETA.fd)
77959>>>>>>>Open NPROX
Including file: NPROX.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\NPROX.fd)
77961>>>>>>>Open EGRESOS
Including file: EGRESOS.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\EGRESOS.fd)
77963>>>>>>>
77963>>>>>>>Class TARJETA_DataDictionary is a DataDictionary
77964>>>>>>>    
77964>>>>>>>    Procedure Construct_Object
77966>>>>>>>        Forward Send Construct_Object
77968>>>>>>>        Set Main_File to TARJETA.File_Number
77969>>>>>>>
77969>>>>>>>        Set Add_System_File to NPROX.File_Number DD_Lock_On_All
77970>>>>>>>
77970>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
77971>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
77972>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
77973>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
77974>>>>>>>
77974>>>>>>>        Set Field_Auto_Increment Field TARJETA.NUMERO to File_Field NPROX.TARJETA
77975>>>>>>>
77975>>>>>>>        Set Field_Option Field TARJETA.CLAVE DD_CAPSLOCK to True
77976>>>>>>>
77976>>>>>>>    End_Procedure
77977>>>>>>>
77977>>>>>>>End_Class
77978>>>>>Use cdbCJGridColumn.pkg
77978>>>>>
77978>>>>>Object TARJETAS_SL is a dbModalPanel
77980>>>>>    Object oTARJETA_DD is a TARJETA_DataDictionary
77982>>>>>    End_Object
77983>>>>>
77983>>>>>    Set Main_DD to oTARJETA_DD
77984>>>>>    Set Server to oTARJETA_DD
77985>>>>>
77985>>>>>
77985>>>>>    Set Size to 88 171
77986>>>>>    Set Location     to 4 5
77987>>>>>    Set Border_Style to Border_Thick
77988>>>>>    Set Label to "TIPO_GASTO"
77989>>>>>    Set Column_Offset to 1
77990>>>>>    
77990>>>>>     Object oSelList is a dbList
77992>>>>>        Set Main_File to TARJETA.File_Number
77993>>>>>        Set Size to 62 159
77994>>>>>        Set Location to 6 6
77995>>>>>    
77995>>>>>        Begin_Row
77998>>>>>            Entry_Item TARJETA.Numero
77999>>>>>            Entry_Item TARJETA.CLAVE
78000>>>>>            Entry_Item TARJETA.DIA_CORTE
78001>>>>>            Entry_Item TARJETA.DIA_PAGO
78002>>>>>        End_Row
78007>>>>>    
78007>>>>>        Set Form_Width 0 to 19
78008>>>>>        Set Header_Label  item 0 to "#"
78009>>>>>        
78009>>>>>        Set Form_Width 1 to 42
78010>>>>>        Set Header_Label  item 1 to "Clave"
78011>>>>>        
78011>>>>>        Set Form_Width 2 to 49
78012>>>>>        Set Header_Label  item 2 to "Dia Corte"
78013>>>>>        
78013>>>>>        Set Form_Width 3 to 43
78014>>>>>        Set Header_Label  item 3 to "Dia Pago"
78015>>>>>        
78015>>>>>        Set Export_Column to 0
78016>>>>>        Set Initial_Column to 0
78017>>>>>        
78017>>>>>    End_Object    // oSelList
78018>>>>>
78018>>>>>    Object oOK_bn is a Button
78020>>>>>        Set Label     to "&OK"
78021>>>>>        Set Location to 71 7
78022>>>>>        Set peAnchors to anBottomRight
78023>>>>>
78023>>>>>        Procedure OnClick
78026>>>>>            Send Ok of oSelList
78027>>>>>        End_Procedure
78028>>>>>
78028>>>>>    End_Object
78029>>>>>
78029>>>>>    Object oCancel_bn is a Button
78031>>>>>        Set Label     to "&Cancel"
78032>>>>>        Set Location to 71 61
78033>>>>>        Set peAnchors to anBottomRight
78034>>>>>
78034>>>>>        Procedure OnClick
78037>>>>>            Send Cancel of oSelList
78038>>>>>        End_Procedure
78039>>>>>
78039>>>>>    End_Object
78040>>>>>
78040>>>>>    Object oSearch_bn is a Button
78042>>>>>        Set Label     to "&Search..."
78043>>>>>        Set Location to 71 115
78044>>>>>        Set peAnchors to anBottomRight
78045>>>>>
78045>>>>>        Procedure OnClick
78048>>>>>            Send Search of oSelList
78049>>>>>        End_Procedure
78050>>>>>
78050>>>>>    End_Object
78051>>>>>
78051>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
78052>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
78053>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
78054>>>>>
78054>>>>>End_Object
78055>>>>>
78055>>>Use cPRESUPUESTO_DataDictionary.dd
Including file: cPRESUPUESTO_DataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cPRESUPUESTO_DataDictionary.dd)
78055>>>>>Use DataDict.pkg
78055>>>>>
78055>>>>>Open PRESUPUESTO
Including file: PRESUPUESTO.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\PRESUPUESTO.fd)
78057>>>>>Open EGRESOS
78059>>>>>Open NPROX
78061>>>>>
78061>>>>>Class cPRESUPUESTODataDictionary is a DataDictionary
78062>>>>>    
78062>>>>>    Procedure Construct_Object
78064>>>>>        Forward Send Construct_Object
78066>>>>>        Set Main_File to PRESUPUESTO.File_Number
78067>>>>>
78067>>>>>        Set Add_System_File to NPROX.File_Number DD_Lock_On_All
78068>>>>>
78068>>>>>        Set Add_Client_File to EGRESOS.File_Number
78069>>>>>
78069>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
78070>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
78071>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
78072>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
78073>>>>>
78073>>>>>        Set Field_Auto_Increment Field PRESUPUESTO.NUMERO to File_Field NPROX.PRESUPUESTO
78074>>>>>
78074>>>>>    End_Procedure
78075>>>>>
78075>>>>>End_Class
78076>>>Use cTIPO_GASTO_DataDictionary.dd
78076>>>Use cEGRESOSDataDictionary.dd
Including file: cEGRESOSDataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cEGRESOSDataDictionary.dd)
78076>>>>>Use DataDict.pkg
78076>>>>>
78076>>>>>Open EGRESOS
78078>>>>>Open PRESUPUESTO
78080>>>>>Open SUB_EGRESOS
Including file: SUB_EGRESOS.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\SUB_EGRESOS.fd)
78082>>>>>Open TIPO_GASTO
78084>>>>>Open TARJETA
78086>>>>>
78086>>>>>Register_Object TIPO_GASTO_SL
78086>>>>>Register_Object TARJETAS_SL
78086>>>>>
78086>>>>>Class cEGRESOSDataDictionary is a DataDictionary
78087>>>>>    
78087>>>>>        Procedure OnConstrain
78089>>>>>            Forward Send OnConstrain
78091>>>>>            Set pbUseDDSQLFilters to True
78092>>>>>            Local String @Filtro @Filtro2 @Tipo_Gasto
78092>>>>>            Local Integer @Vista 
78092>>>>>            
78092>>>>>            Move '' to @Filtro2
78093>>>>>            
78093>>>>>            Get psFiltro of (oClientArea(oMain(Current_object))) to @Filtro
78094>>>>>            Get piOpcionVista of (oClientArea(oMain(Current_object))) to @Vista
78095>>>>>            Get psOpcionPago of (oClientArea(oMain(Current_object))) to @Tipo_Gasto
78096>>>>>            
78096>>>>>            If (@Filtro ne '') Begin
78098>>>>>                Append @Filtro2 @Filtro 
78099>>>>>            End
78099>>>>>>
78099>>>>>            
78099>>>>>            If (@Tipo_Gasto ne 'TODOS') Begin
78101>>>>>                If (@Filtro ne '') Append @Filtro2 ' AND FORMA_PAGO = ' ("'"+@Tipo_Gasto+"'")
78105>>>>>                Else               Append @Filtro2 ' FORMA_PAGO = ' ("'"+@Tipo_Gasto+"'")
78108>>>>>            End
78108>>>>>>
78108>>>>>            
78108>>>>>            Set psSQLFilter to @Filtro2
78109>>>>>        End_Procedure
78110>>>>>    
78110>>>>>    Procedure Construct_Object
78112>>>>>        Forward Send Construct_Object
78114>>>>>        Set Main_File to EGRESOS.File_Number
78115>>>>>
78115>>>>>        Set Add_Server_File to TIPO_GASTO.File_Number
78116>>>>>        Set Add_Server_File to PRESUPUESTO.File_Number
78117>>>>>
78117>>>>>        Set Add_Client_File to SUB_EGRESOS.File_Number
78118>>>>>
78118>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
78119>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
78120>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
78121>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
78122>>>>>
78122>>>>>        Set Field_Prompt_Object Field EGRESOS.TIPO to TIPO_GASTO_SL
78123>>>>>
78123>>>>>        Set Field_Class_Name Field EGRESOS.ES_FIJO_SN to "Checkbox"
78124>>>>>        Set Field_Checkbox_Values Field EGRESOS.ES_FIJO_SN to "S" "N"
78125>>>>>
78125>>>>>        Set Field_Class_Name Field EGRESOS.PAGADO_SN to "Checkbox"
78126>>>>>        Set Field_Checkbox_Values Field EGRESOS.PAGADO_SN to "S" "N"
78127>>>>>
78127>>>>>        Set Field_Value_Check Field EGRESOS.FORMA_PAGO to "EF|TC|TD"
78128>>>>>
78128>>>>>        Set Field_Checkbox_Values Field EGRESOS.MARCAR to "S" "N"
78129>>>>>
78129>>>>>        Set Field_Class_Name Field EGRESOS.LIQUIDAR to "Checkbox"
78130>>>>>        Set Field_Checkbox_Values Field EGRESOS.LIQUIDAR to "S" "N"
78131>>>>>
78131>>>>>        Set Field_Checkbox_Values Field EGRESOS.LIQUIDADO to "S" "N"
78132>>>>>        Set Field_Class_Name Field EGRESOS.LIQUIDADO to "Checkbox"
78133>>>>>
78133>>>>>        Set Field_Prompt_Object Field EGRESOS.TC to TARJETAS_SL
78134>>>>>
78134>>>>>    End_Procedure
78135>>>>>
78135>>>>>    Procedure Field_Defaults
78137>>>>>        Forward Send Field_Defaults
78139>>>>>        Set Field_Changed_Value Field EGRESOS.ES_FIJO_SN to "N"
78140>>>>>        Set Field_Changed_Value Field EGRESOS.PAGADO_SN to "N"
78141>>>>>        Set Field_Changed_Value Field EGRESOS.MARCAR to "N"
78142>>>>>        Set Field_Changed_Value Field EGRESOS.LIQUIDAR to "N"
78143>>>>>        Set Field_Changed_Value Field EGRESOS.LIQUIDADO to "N"
78144>>>>>    End_Procedure
78145>>>>>
78145>>>>>End_Class
78146>>>>>
78146>>>>>Use TARJETAS.sl
78146>>>>>Use TIPO_GASTO.sl
Including file: TIPO_GASTO.sl    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\TIPO_GASTO.sl)
78146>>>>>>>Use Windows.pkg
78146>>>>>>>Use DFClient.pkg
78146>>>>>>>Use cDbCJGridPromptList.pkg
78146>>>>>>>Use cTIPO_GASTO_DataDictionary.dd
78146>>>>>>>Use cdbCJGridColumn.pkg
78146>>>>>>>
78146>>>>>>>Object TIPO_GASTO_SL is a dbModalPanel
78148>>>>>>>    Object oTIPO_GASTO_DD is a cTIPO_GASTO_DataDictionary
78150>>>>>>>    End_Object
78151>>>>>>>
78151>>>>>>>    Set Main_DD to oTIPO_GASTO_DD
78152>>>>>>>    Set Server to oTIPO_GASTO_DD
78153>>>>>>>
78153>>>>>>>    Set Size to 133 171
78154>>>>>>>    Set Location     to 4 5
78155>>>>>>>    Set Border_Style to Border_Thick
78156>>>>>>>    Set Label to "TIPO_GASTO"
78157>>>>>>>    Set Column_Offset to 1
78158>>>>>>>    
78158>>>>>>>     Object oSelList is a dbList
78160>>>>>>>        Set Main_File to TIPO_GASTO.File_Number
78161>>>>>>>        Set Size to 105 168
78162>>>>>>>        Set Location to 6 2
78163>>>>>>>    
78163>>>>>>>        Begin_Row
78166>>>>>>>            Entry_Item TIPO_GASTO.Numero
78167>>>>>>>            Entry_Item TIPO_GASTO.CLAVE
78168>>>>>>>            Entry_Item TIPO_GASTO.DESCRIPCION
78169>>>>>>>        End_Row
78174>>>>>>>    
78174>>>>>>>        Set Form_Width 0 to 19
78175>>>>>>>        Set Header_Label  item 0 to "#"
78176>>>>>>>        
78176>>>>>>>        Set Form_Width 1 to 34
78177>>>>>>>        Set Header_Label  item 1 to "Clave"
78178>>>>>>>        
78178>>>>>>>        Set Form_Width 2 to 111
78179>>>>>>>        Set Header_Label  item 2 to "Descripcion"
78180>>>>>>>         Set Export_Column to 1
78181>>>>>>>         Set Initial_Column to 1
78182>>>>>>>        
78182>>>>>>>    End_Object    // oSelList
78183>>>>>>>
78183>>>>>>>    Object oOK_bn is a Button
78185>>>>>>>        Set Label     to "&OK"
78186>>>>>>>        Set Location to 115 7
78187>>>>>>>        Set peAnchors to anBottomRight
78188>>>>>>>
78188>>>>>>>        Procedure OnClick
78191>>>>>>>            Send Ok of oSelList
78192>>>>>>>        End_Procedure
78193>>>>>>>
78193>>>>>>>    End_Object
78194>>>>>>>
78194>>>>>>>    Object oCancel_bn is a Button
78196>>>>>>>        Set Label     to "&Cancel"
78197>>>>>>>        Set Location to 115 61
78198>>>>>>>        Set peAnchors to anBottomRight
78199>>>>>>>
78199>>>>>>>        Procedure OnClick
78202>>>>>>>            Send Cancel of oSelList
78203>>>>>>>        End_Procedure
78204>>>>>>>
78204>>>>>>>    End_Object
78205>>>>>>>
78205>>>>>>>    Object oSearch_bn is a Button
78207>>>>>>>        Set Label     to "&Search..."
78208>>>>>>>        Set Location to 115 115
78209>>>>>>>        Set peAnchors to anBottomRight
78210>>>>>>>
78210>>>>>>>        Procedure OnClick
78213>>>>>>>            Send Search of oSelList
78214>>>>>>>        End_Procedure
78215>>>>>>>
78215>>>>>>>    End_Object
78216>>>>>>>
78216>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
78217>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
78218>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
78219>>>>>>>
78219>>>>>>>End_Object
78220>>>>>>>
78220>>>Use SUB_EGRESOS.dd
Including file: SUB_EGRESOS.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\SUB_EGRESOS.dd)
78220>>>>>Use DataDict.pkg
78220>>>>>
78220>>>>>Open SUB_EGRESOS
78222>>>>>Open EGRESOS
78224>>>>>
78224>>>>>Class SUB_EGRESOS_DataDictionary is a DataDictionary
78225>>>>>    
78225>>>>>    Procedure Construct_Object
78227>>>>>        Forward Send Construct_Object
78229>>>>>        Set Main_File to SUB_EGRESOS.File_Number
78230>>>>>
78230>>>>>        Set Add_Server_File to EGRESOS.File_Number
78231>>>>>
78231>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
78232>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
78233>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
78234>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
78235>>>>>
78235>>>>>    End_Procedure
78236>>>>>    
78236>>>>>    Procedure Update 
78238>>>>>        Forward Send Update
78240>>>>>        Add SUB_EGRESOS.MONTO to EGRESOS.MONTO
78241>>>>>    End_Procedure
78242>>>>>    
78242>>>>>    Procedure Backout
78244>>>>>        Forward Send Backout
78246>>>>>        Subtract SUB_EGRESOS.MONTO from EGRESOS.MONTO
78247>>>>>    End_Procedure
78248>>>>>
78248>>>>>End_Class
78249>>>
78249>>>Deferred_View Activate_Egresos for ;Object Egresos is a dbView
78274>>>
78274>>>    Object oTIPO_GASTO_DD is a cTIPO_GASTO_DataDictionary
78276>>>    End_Object
78277>>>
78277>>>    Object oPRESUPUESTO_DD is a cPRESUPUESTODataDictionary
78279>>>        Procedure Relate_Main_File
78282>>>            Forward Send Relate_Main_File 
78284>>>            Send Totales
78285>>>        End_Procedure
78286>>>    End_Object
78287>>>
78287>>>    Object oEGRESOS_DD is a cEGRESOSDataDictionary
78289>>>        Set Constrain_file to PRESUPUESTO.File_number
78290>>>        Set DDO_Server to oPRESUPUESTO_DD
78291>>>        Set DDO_Server to oTIPO_GASTO_DD
78292>>>    End_Object
78293>>>
78293>>>    Object oSUB_EGRESOS_DD is a SUB_EGRESOS_DataDictionary
78295>>>        Set Constrain_file to EGRESOS.File_number
78296>>>        Set DDO_Server to oEGRESOS_DD
78297>>>    End_Object
78298>>>
78298>>>    Set Main_DD to oPRESUPUESTO_DD
78299>>>    Set Server to oPRESUPUESTO_DD
78300>>>    
78300>>>    Procedure Request_Delete
78303>>>        Send Totales
78304>>>    End_Procedure
78305>>>    
78305>>>    
78305>>>    Procedure Request_Clear
78308>>>        Forward Send Request_Clear
78310>>>        Set Shadow_State of oPRESUPUESTO_CLAVE          to False
78311>>>        Set Shadow_State of oPRESUPUESTO_FECHA_INICIO   to False
78312>>>        Set Shadow_State of oPRESUPUESTO_FECHA_FIN      to False
78313>>>        Set Shadow_State of oPRESUPUESTO_VLR_QUINCENA   to False 
78314>>>        Set Value of oTOTAL_E    to ''
78315>>>        Set Value of oTOTAL_PGDO to ''
78316>>>        Set Value of oDISPONIBLE to ''
78317>>>        Set Color of Egresos  to 16641499
78318>>>        Set Color of oTOTAL_E to 16777088 
78319>>>    End_Procedure
78320>>>    Procedure Request_Clear_All
78323>>>        Forward Send Request_Clear_All
78325>>>        Set Shadow_State of oPRESUPUESTO_CLAVE          to False
78326>>>        Set Shadow_State of oPRESUPUESTO_FECHA_INICIO   to False
78327>>>        Set Shadow_State of oPRESUPUESTO_FECHA_FIN      to False
78328>>>        Set Shadow_State of oPRESUPUESTO_VLR_QUINCENA   to False 
78329>>>        Set Value of oTOTAL_E    to ''
78330>>>        Set Value of oTOTAL_PGDO to ''
78331>>>        Set Value of oDISPONIBLE to ''
78332>>>        Set Color of Egresos  to 16641499
78333>>>        Set Color of oTOTAL_E to 16777088 
78334>>>    End_Procedure
78335>>>    Set Color to 16641499
78336>>>    Set Auto_Top_View_State to True
78337>>>
78337>>>    //FUNCIONES Y PROCEDIMIENTOS
78337>>>    
78337>>>    Procedure Liquidar 
78340>>>        Local String sQ 
78340>>>        Local Handle hdbc69 hstmt69
78340>>>        Local Number nValor_Disponible nValor_Liquidar
78340>>>        
78340>>>        Move '' to sQ
78341>>>        Move 0  to nValor_Disponible
78342>>>        Append sQ " SELECT DISPONIBLE FROM dbo.fn_ObtenerTotalesPresupuesto(" PRESUPUESTO.NUMERO ",3, 'todos'); " 
78345>>>        SQLFileConnect EGRESOS to hdbc69
78346>>>        SQLOpen hdbc69 to hstmt69
78349>>>        SQLExecDirect hstmt69 sQ
78352>>>        Repeat
78352>>>>
78352>>>           SQLFileFetch hstmt69
78358>>>           If (SQLResult) Begin
78360>>>              Get SQLColumnValue of hstmt69   1 to nValor_Disponible
78361>>>           End
78361>>>>
78361>>>        Until (not(SQLResult))
78363>>>        SQLClose hstmt69
78366>>>        SQLDisconnect hdbc69
78369>>>        
78369>>>        Move '' to sQ
78370>>>        Move 0  to nValor_Liquidar
78371>>>        Append sQ " SELECT SUM(MONTO) FROM EGRESOS WHERE LIQUIDAR = 'S' AND PRESUPUESTO = " PRESUPUESTO.NUMERO 
78373>>>        SQLFileConnect EGRESOS to hdbc69
78374>>>        SQLOpen hdbc69 to hstmt69
78377>>>        SQLExecDirect hstmt69 sQ
78380>>>        Repeat
78380>>>>
78380>>>           SQLFileFetch hstmt69
78386>>>           If (SQLResult) Begin
78388>>>              Get SQLColumnValue of hstmt69   1 to nValor_Liquidar
78389>>>           End
78389>>>>
78389>>>        Until (not(SQLResult))
78391>>>        SQLClose hstmt69
78394>>>        SQLDisconnect hdbc69
78397>>>        
78397>>>        If (nValor_Disponible < nValor_Liquidar) Begin
78399>>>            Local Integer iRespuesta
78399>>>            Get Confirm 'Monto a liquidar es mayor al disponible. Desea usar todo el disponible?' to iRespuesta
78400>>>            
78400>>>            If (iRespuesta eq 1) Begin
78402>>>                Send Stop_Box 'Liquidacion detenida...' '!'
78403>>>                Procedure_Return
78404>>>            End
78404>>>>
78404>>>        End
78404>>>>
78404>>>    
78404>>>        Move '' to sQ
78405>>>        Append sQ " UPDATE EGRESOS SET LIQUIDAR = 'N', LIQUIDADO = 'S', PAGADO_SN = 'S' where LIQUIDAR = 'S' AND PRESUPUESTO = " PRESUPUESTO.NUMERO 
78407>>>        SQLFileConnect EGRESOS to hdbc69
78408>>>        SQLOpen hdbc69 to hstmt69
78411>>>        SQLExecDirect hstmt69 sQ
78414>>>        SQLClose hstmt69
78417>>>        SQLDisconnect hdbc69
78420>>>        
78420>>>        Send Request_Find of oEGRESOS_DD ge Egresos.File_Number 1
78421>>>        Send Refresh of oEgresos 2
78422>>>    End_Procedure
78423>>>    
78423>>>    Procedure Totales 
78426>>>        Local String sQ sOptionTipoPago
78426>>>        Local Handle hdbc69 hstmt69
78426>>>        local Integer iOptionTipoPago iOpcionVista
78426>>>        Local Number nVal_TD nValPgdo nValPgdo_EF nValDispo nValDispo_EF nEgresos_EF nTotalTD_EF
78426>>>        Local Number nTOTAL_EGRESOS nTOTAL_INGRESOS nDIFERENCIA nPENDIENTE_PAGO nTOTAL_PGO nDISPONIBLE
78426>>>        
78426>>>        Get piOpcionVista of (oClientArea(oMain(Current_object))) to iOpcionVista
78427>>>        Get psOpcionPago  of (oClientArea(oMain(Current_object))) to sOptionTipoPago
78428>>>    
78428>>>        Move '' to sQ
78429>>>        Move 0  to nVal_TD
78430>>>        Append sQ " SELECT * FROM dbo.fn_ObtenerTotalesPresupuesto(" PRESUPUESTO.NUMERO ", " iOpcionVista ", '" sOptionTipoPago "'); " 
78437>>>        SQLFileConnect EGRESOS to hdbc69
78438>>>        SQLOpen hdbc69 to hstmt69
78441>>>        SQLExecDirect hstmt69 sQ
78444>>>        Repeat
78444>>>>
78444>>>           SQLFileFetch hstmt69
78450>>>           If (SQLResult) Begin
78452>>>              Get SQLColumnValue of hstmt69   1 to nTOTAL_INGRESOS
78453>>>              Get SQLColumnValue of hstmt69   2 to nTOTAL_EGRESOS
78454>>>              Get SQLColumnValue of hstmt69   3 to nDIFERENCIA
78455>>>              Get SQLColumnValue of hstmt69   4 to nTOTAL_PGO
78456>>>              Get SQLColumnValue of hstmt69   5 to nPENDIENTE_PAGO
78457>>>              Get SQLColumnValue of hstmt69   6 to nDISPONIBLE
78458>>>           End
78458>>>>
78458>>>        Until (not(SQLResult))
78460>>>        SQLClose hstmt69
78463>>>        SQLDisconnect hdbc69
78466>>>        
78466>>>        Set Value of oTOTAL_E           to nTOTAL_EGRESOS
78467>>>        Set Value of oTOTAL_INGRESOS    to nTOTAL_INGRESOS
78468>>>        Set Value of oDIFERENCIA2       to nDIFERENCIA
78469>>>        Set Value of oPENDIENTE         to nPENDIENTE_PAGO
78470>>>        Set Value of oTOTAL_PGDO        to nTOTAL_PGO
78471>>>        Set Value of oDISPONIBLE        to nDISPONIBLE
78472>>>        
78472>>>        
78472>>>        If (nTOTAL_EGRESOS > nTOTAL_INGRESOS) Begin
78474>>>            Set Color of oTOTAL_E to 9079551
78475>>>        End
78475>>>>
78475>>>        
78475>>>        If (nDISPONIBLE > 0) Begin
78477>>>            Set Color of oDISPONIBLE to 16777088
78478>>>        End
78478>>>>
78478>>>        
78478>>>       
78478>>>        
78478>>>        
78478>>>//        //COLOREA TOTAL SEGUN RANGO
78478>>>//        If (oTOTAL_E < oTOTAL_INGRESOS) Begin
78478>>>//            Set Color of oTOTAL_E  to 16777088 
78478>>>//            Set Color of Egresos   to 16641499
78478>>>//        End
78478>>>//        Else Begin
78478>>>//            Set Color of oTOTAL_E to 4227327
78478>>>//            Set Color of Egresos  to 12111868
78478>>>//        End
78478>>>//        //COLOREA TOTAL SEGUN RANGO
78478>>>//        If (nValDispo > 0) Set Color of oDISPONIBLE to 16777088 
78478>>>//        Else Set Color of oDISPONIBLE_EF to 16777088 
78478>>>//        
78478>>>//        If (nValorDiferencia gt 0) Set Color of oDiferencia to 16777088
78478>>>//        Else Set color of oDiferencia to 4227327
78478>>>//
78478>>>//        
78478>>>//        //DIFERENCUAL VISUAL
78478>>>//        Local Number nValorDiferencia
78478>>>//        Move ((nIngreso+nIngreso_EF)-nTotalTD_EF) to nValorDiferencia
78478>>>//        Set Value of oText_TOT_INGRESOS to  ("+ Q."+(String(nIngreso+nIngreso_EF)))
78478>>>//        Set value of oText_TOT_EGRESOS  to  ("- Q."+(String(nTotalTD_EF)))
78478>>>//        Set Value of oDiferencia to ("= Q."+(String(nValorDiferencia)))
78478>>>//        
78478>>>        
78478>>>        
78478>>>        
78478>>>        
78478>>>    End_Procedure
78479>>>    
78479>>>    Procedure Cargar_Eg_Fijos 
78482>>>        Local String sQ
78482>>>        Local Handle hdbc69 hstmt69
78482>>>        Local Integer iProx
78482>>>        Local Date dToday
78482>>>        Sysdate dToday
78483>>>    
78483>>>        Move '' to sQ
78484>>>        Append sQ "INSERT INTO EGRESOS (NUMERO, TIPO, DESCRIPCION, FECHA_REALIZADO, ES_FIJO_SN, MONTO, MONTO_PROYECTADO, PRESUPUESTO, FORMA_PAGO) "
78485>>>        Append sQ "SELECT (SELECT COALESCE(MAX(NUMERO), 0) FROM EGRESOS WHERE PRESUPUESTO = " PRESUPUESTO.NUMERO ") + ROW_NUMBER() OVER (ORDER BY TIPO), TIPO, DESCRIPCION, " (fSQL_date(dToday)) ", 'S', 0, MONTO_PROYECTADO, " PRESUPUESTO.NUMERO ", 'TD'"
78492>>>        Append sQ " FROM EGRESOS WHERE ES_FIJO_SN = 'S' AND PRESUPUESTO = " (PRESUPUESTO.NUMERO-1)
78494>>>        SQLFileConnect EGRESOS to hdbc69
78495>>>        SQLOpen hdbc69 to hstmt69
78498>>>        SQLExecDirect hstmt69 sQ
78501>>>        
78501>>>        Send Request_Find of oEGRESOS_DD ge Egresos.File_Number 1
78502>>>        
78502>>>        SQLClose hstmt69
78505>>>        SQLDisconnect hdbc69
78508>>>    End_Procedure
78509>>>    
78509>>>     Procedure Cargar_Eg_Pendientes 
78512>>>        Local String sQ
78512>>>        Local Handle hdbc69 hstmt69
78512>>>        Local Integer iProx
78512>>>        Local Date dToday
78512>>>        Sysdate dToday
78513>>>    
78513>>>        Move '' to sQ
78514>>>        Append sQ "INSERT INTO EGRESOS (NUMERO, TIPO, DESCRIPCION, FECHA_REALIZADO, ES_FIJO_SN, MONTO, MONTO_PROYECTADO, PRESUPUESTO, FORMA_PAGO) "
78515>>>        Append sQ "SELECT (SELECT COALESCE(MAX(NUMERO), 0) FROM EGRESOS WHERE PRESUPUESTO = " PRESUPUESTO.NUMERO ") + ROW_NUMBER() OVER (ORDER BY TIPO), TIPO, DESCRIPCION, " (fSQL_date(dToday)) ", 'N', 0, MONTO_PROYECTADO, " PRESUPUESTO.NUMERO ", 'TD'"
78522>>>        Append sQ " FROM EGRESOS WHERE FORMA_PAGO = 'TC' AND PAGADO_SN = 'S' AND PRESUPUESTO = " (PRESUPUESTO.NUMERO-1)
78524>>>        SQLFileConnect EGRESOS to hdbc69
78525>>>        SQLOpen hdbc69 to hstmt69
78528>>>        SQLExecDirect hstmt69 sQ
78531>>>        
78531>>>        Send Request_Find of oEGRESOS_DD ge Egresos.File_Number 1
78532>>>        
78532>>>        SQLClose hstmt69
78535>>>        SQLDisconnect hdbc69
78538>>>    End_Procedure
78539>>>    Set Size to 380 501
78540>>>    Set Location to 2 2
78541>>>    Set Label to "„gados"
78542>>>    
78542>>>    Object oDbContainer3d2 is a dbContainer3d
78544>>>        Set Size to 226 460
78545>>>        Set Location to 117 16
78546>>>
78546>>>        Object oEgresos is a cDbCJGrid
78548>>>            Set Server to oEGRESOS_DD
78549>>>            Set Size to 117 444
78550>>>            Set Location to 6 4
78551>>>            Set peHorizontalGridStyle to xtpGridSmallDots
78552>>>            Set peVerticalGridStyle to xtpGridSmallDots
78553>>>            Set piFocusCellBackColor to 16776960
78554>>>            Set piSelectedRowBackColor to clRed
78555>>>            Set peBorderStyle to xtpBorderNone
78556>>>            Set piHighlightBackColor to clBlue
78557>>>            Set pbUseAlternateRowBackgroundColor to  True
78558>>>
78558>>>            Object oEGRESOS_NUMERO is a cDbCJGridColumn
78560>>>                Entry_Item EGRESOS.NUMERO
78561>>>                Set piWidth to 34
78562>>>                Set psCaption to "#"
78563>>>
78563>>>                Procedure OnEntry
78566>>>                    Forward Send OnEntry
78568>>>                        Local String sQ 
78568>>>                        Local Handle hdbc69 hstmt69
78568>>>                        Local Integer iProx iNumero
78568>>>                        
78568>>>                        Get Value item 0 to iNumero
78569>>>                        
78569>>>                        If (iNumero eq 0 and PRESUPUESTO.Recnum ne 0) Begin
78571>>>                            Move '' to sQ
78572>>>                            Move 0  to iProx
78573>>>                            Append sQ " SELECT MAX(NUMERO) FROM EGRESOS WHERE PRESUPUESTO = " PRESUPUESTO.NUMERO 
78575>>>                            SQLFileConnect EGRESOS to hdbc69
78576>>>                            SQLOpen hdbc69 to hstmt69
78579>>>                            SQLExecDirect hstmt69 sQ
78582>>>                            Repeat
78582>>>>
78582>>>                               SQLFileFetch hstmt69
78588>>>                               If (SQLResult) Begin
78590>>>                                  Get SQLColumnValue of hstmt69   1 to iProx
78591>>>                               End
78591>>>>
78591>>>                            Until (not(SQLResult))
78593>>>                            SQLClose hstmt69
78596>>>                            SQLDisconnect hdbc69
78599>>>                            
78599>>>                            Set Value of oEGRESOS_NUMERO to (iProx+1)
78600>>>                        End 
78600>>>>
78600>>>                End_Procedure
78601>>>
78601>>>                //Set pbEditable to False
78601>>>            End_Object
78602>>>
78602>>>            Object oEGRESOS_TIPO is a cDbCJGridColumn
78604>>>                Entry_Item EGRESOS.TIPO
78605>>>                Set piWidth to 56
78606>>>                Set psCaption to "Tipo"
78607>>>                Set pbCapslock to True 
78608>>>                Set Prompt_Button_Mode to PB_PromptOn
78609>>>
78609>>>                Procedure OnExit
78612>>>                    Forward Send OnExit
78614>>>                    Local String sTipoEgreso 
78614>>>                    Get Value item 1 to sTipoEgreso
78615>>>                    
78615>>>                    Clear TIPO_GASTO
78616>>>                    Move sTipoEgreso to TIPO_GASTO.CLAVE
78617>>>                    Find eq TIPO_GASTO by Index.2
78618>>>>
78618>>>                End_Procedure
78619>>>            End_Object
78620>>>
78620>>>            Object oEGRESOS_DESCRIPCION is a cDbCJGridColumn
78622>>>                Entry_Item EGRESOS.DESCRIPCION
78623>>>                Set piWidth to 234
78624>>>                Set psCaption to "Descripcion"
78625>>>
78625>>>                Procedure OnEntry
78628>>>                    Forward Send OnEntry
78630>>>                    Local String sDescripcion
78630>>>                    
78630>>>                    Get Value item 2 to sDescripcion
78631>>>                    If (sDescripcion eq '') Set Value of oEGRESOS_DESCRIPCION to  TIPO_GASTO.DESCRIPCION 
78634>>>                End_Procedure
78635>>>            End_Object
78636>>>
78636>>>            Object oEGRESOS_FECHA_REALIZADO is a cDbCJGridColumn
78638>>>                Entry_Item EGRESOS.FECHA_REALIZADO
78639>>>                Set piWidth to 83
78640>>>                Set psCaption to "Fecha"
78641>>>
78641>>>                Procedure OnEntry
78644>>>                    Forward Send OnEntry
78646>>>                    Local Date dSysdate dFecha
78646>>>                    Sysdate dSysdate
78647>>>                    
78647>>>                    Get value of oEGRESOS_FECHA_REALIZADO to dFecha
78648>>>                    If (dFecha eq '') Set Value of oEGRESOS_FECHA_REALIZADO to dSysdate
78651>>>                End_Procedure
78652>>>            End_Object
78653>>>
78653>>>            Object oEGRESOS_ES_FIJO_SN is a cDbCJGridColumn
78655>>>                Entry_Item EGRESOS.ES_FIJO_SN
78656>>>                Set piWidth to 55
78657>>>                Set psCaption to "Es fijo?"
78658>>>                Set pbCapslock to True 
78659>>>                Set pbCheckbox to True
78660>>>            End_Object
78661>>>
78661>>>            Object oEGRESOS_MONTO_PROYECTADO is a cDbCJGridColumn
78663>>>                Entry_Item EGRESOS.MONTO_PROYECTADO
78664>>>                Set piWidth to 81
78665>>>                Set psCaption to "Proyectado"
78666>>>            End_Object
78667>>>
78667>>>            Object oEGRESOS_MONTO is a cDbCJGridColumn
78669>>>                Entry_Item EGRESOS.MONTO
78670>>>                Set piWidth to 84
78671>>>                Set psCaption to "Monto"
78672>>>            End_Object
78673>>>
78673>>>            Object oEGRESOS_PAGADO_SN is a cDbCJGridColumn
78675>>>                Entry_Item EGRESOS.PAGADO_SN
78676>>>                Set piWidth to 51
78677>>>                Set psCaption to "Pgdo?"
78678>>>                Set pbCapslock to True 
78679>>>                Set pbCheckbox to True
78680>>>            End_Object
78681>>>
78681>>>            Object oEGRESOS_FORMA_PAGO is a cDbCJGridColumn
78683>>>                Entry_Item EGRESOS.FORMA_PAGO
78684>>>                Set piWidth to 65
78685>>>                Set psCaption to "F.Pago"
78686>>>                Set pbCapslock to True
78687>>>
78687>>>                Procedure OnExit
78690>>>                    Forward Send OnExit
78692>>>                    Local String sFma_pago sLiquidado
78692>>>                    Get Value item 8 to sFma_pago
78693>>>                    Get Value item 10 to sLiquidado
78694>>>                    
78694>>>//                    If (sFma_pago eq 'TC' and sLiquidado ne 'S') Begin
78694>>>//                        Send Popup to oPanel_TC
78694>>>//                    End
78694>>>                End_Procedure
78695>>>            End_Object
78696>>>
78696>>>            Object oEGRESOS_LIQUIDAR is a cDbCJGridColumn
78698>>>                Entry_Item EGRESOS.LIQUIDAR
78699>>>                Set piWidth to 69
78700>>>                Set psCaption to "Liquidar?"
78701>>>                Set pbCheckbox to True
78702>>>            End_Object
78703>>>
78703>>>            Object oEGRESOS_LIQUIDADO is a cDbCJGridColumn
78705>>>                Entry_Item EGRESOS.LIQUIDADO
78706>>>                Set piWidth to 76
78707>>>                Set psCaption to "Liquidado"
78708>>>                Set pbCheckbox to True
78709>>>                Set pbEditable to False
78710>>>            End_Object
78711>>>        End_Object
78712>>>
78712>>>        Object oDbGroup2 is a dbGroup
78714>>>            Set Size to 90 440
78715>>>            Set Location to 130 5
78716>>>            Set Label to 'Integraci¢n de Gastos'
78717>>>            Set Color to clScrollBar
78718>>>
78718>>>            Object oSubdetalle_title is a TextBox
78720>>>                Set Auto_Size_State to False
78721>>>                Set Size to 9 290
78722>>>                Set Location to 9 75
78723>>>                Set Label to "-"
78724>>>                Set Color to 16777088
78725>>>            End_Object
78726>>>            Object oDbCJGrid1 is a cDbCJGrid
78728>>>                Set Server to oSUB_EGRESOS_DD
78729>>>                Set Size to 61 290
78730>>>                Set Location to 20 75
78731>>>                Set pbUseAlternateRowBackgroundColor to True
78732>>>    
78732>>>                Object oSUB_EGRESOS_NUMERO is a cDbCJGridColumn
78734>>>                    Entry_Item SUB_EGRESOS.NUMERO
78735>>>                    Set piWidth to 34
78736>>>                    Set psCaption to "#"
78737>>>                End_Object
78738>>>    
78738>>>                Object oSUB_EGRESOS_FECHA_REALIZADO is a cDbCJGridColumn
78740>>>                    Entry_Item SUB_EGRESOS.FECHA_REALIZADO
78741>>>                    Set piWidth to 116
78742>>>                    Set psCaption to "Fecha"
78743>>>                End_Object
78744>>>    
78744>>>                Object oSUB_EGRESOS_DESCRIPCION is a cDbCJGridColumn
78746>>>                    Entry_Item SUB_EGRESOS.DESCRIPCION
78747>>>                    Set piWidth to 345
78748>>>                    Set psCaption to "Descripcion"
78749>>>
78749>>>                    Procedure OnEntry
78752>>>                        Forward Send OnEntry
78754>>>                        Local String sDescripcion
78754>>>                        Local Date dSysdate
78754>>>                        Sysdate dSysdate
78755>>>                        Get Value of oSUB_EGRESOS_DESCRIPCION to sDescripcion
78756>>>                        If (sDescripcion eq '') Set Value of  oSUB_EGRESOS_DESCRIPCION to (TIPO_GASTO.DESCRIPCION+ String(dSysdate))
78759>>>                    End_Procedure
78760>>>                End_Object
78761>>>    
78761>>>                Object oSUB_EGRESOS_MONTO is a cDbCJGridColumn
78763>>>                    Entry_Item SUB_EGRESOS.MONTO
78764>>>                    Set piWidth to 85
78765>>>                    Set psCaption to "Monto"
78766>>>                End_Object
78767>>>            End_Object
78768>>>        End_Object
78769>>>
78769>>>        Object oPanel_TC is a dbContainer3d
78771>>>            Set Size to 40 124
78772>>>            Set Location to 28 268
78773>>>            Set Color to 16776960
78774>>>            Set Popup_State to true
78775>>>    
78775>>>            Object oEGRESOS_TC is a dbForm
78777>>>                Entry_Item EGRESOS.TC
78778>>>    
78778>>>                Set Server to oEGRESOS_DD
78779>>>                Set Location to 15 16
78780>>>                Set Size to 13 51
78781>>>                Set Label to "Tarjeta Credito"
78782>>>                Set Label_Justification_Mode to JMode_Top
78783>>>                Set Label_Col_Offset to 1
78784>>>                Set Prompt_Button_Mode to PB_PromptOn
78785>>>            End_Object
78786>>>    
78786>>>            Object oButton1 is a Button
78788>>>                Set Size to 20 25
78789>>>                Set Location to 10 80
78790>>>                Set Label to 'ok'
78791>>>                Set Bitmap to 'aceptar.bmp'
78792>>>            
78792>>>                // fires when the button is clicked
78792>>>                Procedure OnClick
78795>>>                    Send Msg_Exit to oPanel_TC
78796>>>                End_Procedure
78797>>>            
78797>>>            End_Object
78798>>>        End_Object
78799>>>    End_Object
78800>>>
78800>>>    Object oDbContainer3d1 is a dbContainer3d
78802>>>        Set Size to 112 458
78803>>>        Set Location to 3 17
78804>>>
78804>>>        Object oDbGroup1 is a dbGroup
78806>>>            Set Size to 45 360
78807>>>            Set Location to 3 6
78808>>>            Set Label to "PRESUPUESTO"
78809>>>
78809>>>            Object oPRESUPUESTO_NUMERO is a dbForm
78811>>>                Use PRESUPUESTO.sl
Including file: PRESUPUESTO.sl    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\PRESUPUESTO.sl)
78811>>>>>Use Windows.pkg
78811>>>>>Use DFClient.pkg
78811>>>>>Use cDbCJGridPromptList.pkg
78811>>>>>Use cPRESUPUESTO_DataDictionary.dd
78811>>>>>Use cdbCJGridColumn.pkg
78811>>>>>
78811>>>>>Object PRESUPUESTO_SL is a dbModalPanel
78813>>>>>    Object oPRESUPUESTO_DD is a cPRESUPUESTODataDictionary
78815>>>>>    End_Object
78816>>>>>
78816>>>>>    Set Main_DD to oPRESUPUESTO_DD
78817>>>>>    Set Server to oPRESUPUESTO_DD
78818>>>>>
78818>>>>>    Set Size to 94 197
78819>>>>>    Set Location     to 4 5
78820>>>>>    Set Border_Style to Border_Thick
78821>>>>>    Set Label to "PRESUPUESTO"
78822>>>>>
78822>>>>>    Object oSelList is a dbList
78824>>>>>        Set Main_File to PRESUPUESTO.File_Number
78825>>>>>        Set Size to 65 185
78826>>>>>        Set Location to 6 7
78827>>>>>    
78827>>>>>        Begin_Row
78830>>>>>            Entry_Item PRESUPUESTO.Numero
78831>>>>>            Entry_Item PRESUPUESTO.CLAVE
78832>>>>>            Entry_Item PRESUPUESTO.FECHA_INICIO
78833>>>>>            Entry_Item PRESUPUESTO.FECHA_FIN
78834>>>>>        End_Row
78839>>>>>    
78839>>>>>        Set Form_Width 0 to 19
78840>>>>>        Set Header_Label  item 0 to "#"
78841>>>>>        
78841>>>>>        Set Form_Width 1 to 43
78842>>>>>        Set Header_Label  item 1 to "Clave"
78843>>>>>        
78843>>>>>        Set Form_Width 2 to 58
78844>>>>>        Set Header_Label  item 2 to "Fecha Inicio"
78845>>>>>        
78845>>>>>        Set Form_Width 3 to 56
78846>>>>>        Set Header_Label  item 3 to "Fecha Fin"
78847>>>>>        
78847>>>>>         Set Export_Column to  0
78848>>>>>         Set Initial_Column to 0
78849>>>>>        
78849>>>>>    End_Object    // oSelList
78850>>>>>
78850>>>>>    Object oOK_bn is a Button
78852>>>>>        Set Label     to "&OK"
78853>>>>>        Set Location to 76 19
78854>>>>>        Set peAnchors to anBottomRight
78855>>>>>
78855>>>>>        Procedure OnClick
78858>>>>>            Send Ok of oSelList
78859>>>>>        End_Procedure
78860>>>>>
78860>>>>>    End_Object
78861>>>>>
78861>>>>>    Object oCancel_bn is a Button
78863>>>>>        Set Label     to "&Cancel"
78864>>>>>        Set Location to 76 73
78865>>>>>        Set peAnchors to anBottomRight
78866>>>>>
78866>>>>>        Procedure OnClick
78869>>>>>            Send Cancel of oSelList
78870>>>>>        End_Procedure
78871>>>>>
78871>>>>>    End_Object
78872>>>>>
78872>>>>>    Object oSearch_bn is a Button
78874>>>>>        Set Label     to "&Search..."
78875>>>>>        Set Location to 76 127
78876>>>>>        Set peAnchors to anBottomRight
78877>>>>>
78877>>>>>        Procedure OnClick
78880>>>>>            Send Search of oSelList
78881>>>>>        End_Procedure
78882>>>>>
78882>>>>>    End_Object
78883>>>>>
78883>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
78884>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
78885>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
78886>>>>>
78886>>>>>End_Object
78887>>>>>
78887>>>                Entry_Item PRESUPUESTO.NUMERO
78888>>>                Set Location to 10 83
78889>>>                Set Size to 13 48
78890>>>                Set Label to "N£mero:"
78891>>>                Set Label_Col_Offset to 2
78892>>>                Set Label_Justification_Mode to JMode_Right
78893>>>                Set Prompt_Button_Mode to PB_PromptOn
78894>>>                Set Prompt_Object to PRESUPUESTO_SL
78895>>>
78895>>>                Procedure Exiting Handle hoDestination Returns Integer
78898>>>                    Integer iRetVal
78898>>>                    Forward Get msg_Exiting hoDestination to iRetVal
78900>>>                    Local Integer iNumero_presupuesto
78900>>>                    Get Value of oPRESUPUESTO_NUMERO to iNumero_presupuesto
78901>>>                    
78901>>>                    If (iNumero_presupuesto ne 0 or iNumero_presupuesto ne '') Begin
78903>>>                        Clear PRESUPUESTO
78904>>>                        Move iNumero_presupuesto to PRESUPUESTO.NUMERO
78905>>>                        Find eq PRESUPUESTO by Index.1
78906>>>>
78906>>>                        If [not Found] Begin
78908>>>                            Send Stop_Box 'Numero presupuesto Inv lido...' "!"
78909>>>                            Move 1 to iRetVal
78910>>>                        End
78910>>>>
78910>>>                        Else Begin
78911>>>                            Send Request_Find of oPRESUPUESTO_DD GE PRESUPUESTO.File_Number 1 
78912>>>                        End
78912>>>>
78912>>>                    End
78912>>>>
78912>>>                    
78912>>>                    
78912>>>                    Procedure_Return iRetVal
78913>>>                End_Procedure
78914>>>            End_Object
78915>>>
78915>>>            Object oPRESUPUESTO_CLAVE is a dbForm
78917>>>                Entry_Item PRESUPUESTO.CLAVE
78918>>>                Set Location to 10 173
78919>>>                Set Size to 13 48
78920>>>                Set Label to "Clave:"
78921>>>                Set Label_Justification_Mode to JMode_Right
78922>>>                Set Label_Col_Offset to 2
78923>>>            End_Object
78924>>>
78924>>>            Object oPRESUPUESTO_VLR_EFECTIVO is a dbForm
78926>>>                Entry_Item PRESUPUESTO.VLR_EFECTIVO
78927>>>                Set Location to 25 83
78928>>>                Set Size to 13 48
78929>>>                Set Label to "Efectivo"
78930>>>                Set Numeric_Mask 0 to 4 2
78931>>>                Set Label_Col_Offset to 2
78932>>>                Set Label_Justification_Mode to JMode_Right
78933>>>            End_Object
78934>>>
78934>>>            Object oPRESUPUESTO_VLR_QUINCENA is a dbForm
78936>>>                Entry_Item PRESUPUESTO.VLR_QUINCENA
78937>>>                Set Location to 25 173
78938>>>                Set Size to 13 48
78939>>>                Set Label to "Quincena"
78940>>>                Set Numeric_Mask 0 to 4 2
78941>>>                Set Label_Col_Offset to 2
78942>>>                Set Label_Justification_Mode to JMode_Right
78943>>>            End_Object
78944>>>            Object oPRESUPUESTO_FECHA_INICIO is a dbForm
78946>>>                Entry_Item PRESUPUESTO.FECHA_INICIO
78947>>>                Set Location to 10 267
78948>>>                Set Size to 13 48
78949>>>                Set Label to "Fecha Inicio:"
78950>>>                Set Label_Col_Offset to 2
78951>>>                Set Label_Justification_Mode to JMode_Right
78952>>>            End_Object
78953>>>            Object oPRESUPUESTO_FECHA_FIN is a dbForm
78955>>>                Entry_Item PRESUPUESTO.FECHA_FIN
78956>>>                Set Location to 25 267
78957>>>                Set Size to 13 48
78958>>>                Set Label to "Fecha Fin:"
78959>>>                Set Label_Col_Offset to 2
78960>>>                Set Label_Justification_Mode to JMode_Right
78961>>>
78961>>>                Procedure Exiting Handle hoDestination Returns Integer
78964>>>                    Integer iRetVal
78964>>>                    Forward Get msg_Exiting hoDestination to iRetVal
78966>>>                    Send Request_Save of oPRESUPUESTO_DD
78967>>>                    Procedure_Return iRetVal
78968>>>                End_Procedure
78969>>>            End_Object
78970>>>        End_Object
78971>>>
78971>>>        Object oDbContainer3d4 is a dbContainer3d
78973>>>            Set Size to 37 360
78974>>>            Set Location to 50 6
78975>>>            Set Border_Style to Border_StaticEdge
78976>>>            Set Enabled_State to False
78977>>>
78977>>>            Object oTOTAL_INGRESOS is a Form
78979>>>                Set Size to 13 47
78980>>>                Set Location to 4 73
78981>>>                Set Label_Col_Offset to 2
78982>>>                Set Label to "Total Ingresos:"
78983>>>                Set Label_Justification_Mode to JMode_Right
78984>>>                Set Entry_State to False
78985>>>                Set Numeric_Mask item 0 to 8 2 ",*"
78986>>>            
78986>>>                // OnChange is called on every changed character
78986>>>            //    Procedure OnChange
78986>>>            //        String sValue
78986>>>            //    
78986>>>            //        Get Value to sValue
78986>>>            //    End_Procedure
78986>>>            
78986>>>            End_Object
78987>>>            Object oTOTAL_E is a Form
78989>>>                Set Size to 13 47
78990>>>                Set Location to 19 73
78991>>>                Set Numeric_Mask 0 to 4 2
78992>>>                Set Entry_State to False
78993>>>                Set Label to "Total Egresos:"
78994>>>                Set Label_Col_Offset to 2
78995>>>                Set Label_Justification_Mode to JMode_Right
78996>>>                Set Numeric_Mask item 0 to 8 2 ",*"
78997>>>            End_Object
78998>>>
78998>>>            Object oDIFERENCIA2 is a Form
79000>>>                Set Size to 13 47
79001>>>                Set Location to 19 124
79002>>>                Set Numeric_Mask 0 to 4 2
79003>>>                Set Entry_State to False
79004>>>                Set Label_Col_Offset to -1
79005>>>                Set Label to "Diferencia:"
79006>>>                Set Label_Justification_Mode to JMode_Top
79007>>>                Set Numeric_Mask item 0 to 8 2 ",*"
79008>>>                Set Enabled_State to False
79009>>>            End_Object
79010>>>
79010>>>            Object oTOTAL_PGDO is a Form
79012>>>                Set Size to 13 47
79013>>>                Set Location to 4 231
79014>>>                Set Numeric_Mask 0 to 4 2
79015>>>                Set Entry_State to False
79016>>>                Set Label to "Total Pagado:"
79017>>>                Set Label_Col_Offset to 2
79018>>>                Set Label_Justification_Mode to JMode_Right
79019>>>                Set Numeric_Mask item 0 to 8 2 ",*"
79020>>>                Set Enabled_State to False
79021>>>            End_Object
79022>>>            Object oPENDIENTE is a Form
79024>>>                Set Size to 13 47
79025>>>                Set Location to 19 231
79026>>>                Set Numeric_Mask 0 to 4 2
79027>>>                Set Entry_State to False
79028>>>                Set Label to "Pendiente Pgo:"
79029>>>                Set Label_Col_Offset to 2
79030>>>                Set Label_Justification_Mode to JMode_Right
79031>>>                Set Numeric_Mask item 0 to 8 2 ",*"
79032>>>            End_Object
79033>>>
79033>>>            Object oDISPONIBLE is a Form
79035>>>                Set Size to 13 47
79036>>>                Set Location to 19 280
79037>>>                Set Numeric_Mask 0 to 4 2
79038>>>                Set Entry_State to False
79039>>>                Set Label_Col_Offset to 0
79040>>>                Set Label_Justification_Mode to JMode_Top
79041>>>                Set Label to "Disponible:"
79042>>>                Set Numeric_Mask item 0 to 8 2 ",*"
79043>>>            End_Object
79044>>>        End_Object
79045>>>
79045>>>        Object oVISTA is a RadioGroup
79047>>>            Set Location to 86 6
79048>>>            Set Size to 21 207
79049>>>        
79049>>>            Object oRadio1 is a Radio
79051>>>                Set Label to "Pendientes"
79052>>>                Set Size to 10 47
79053>>>                Set Location to 8 5
79054>>>            End_Object
79055>>>        
79055>>>            Object oRadio2 is a Radio
79057>>>                Set Label to "Pagados"
79058>>>                Set Size to 10 40
79059>>>                Set Location to 8 58
79060>>>            End_Object
79061>>>        
79061>>>            Object oRadio3 is a Radio
79063>>>                Set Label to "No esperados"
79064>>>                Set Size to 10 60
79065>>>                Set Location to 8 102
79066>>>            End_Object
79067>>>        
79067>>>            Procedure Notify_Select_State Integer iToItem Integer iFromItem
79070>>>                Forward Send Notify_Select_State iToItem iFromItem
79072>>>                If (iToItem eq 0) Set psFiltro to " PAGADO_SN = 'N'"
79075>>>                If (iToItem eq 1) Set psFiltro to " PAGADO_SN = 'S'"
79078>>>                If (iToItem eq 2) Set psFiltro to " MONTO > MONTO_PROYECTADO "
79081>>>                If (iToItem eq 3) Set psFiltro to ""
79084>>>                Set piOpcionVista to iToItem
79085>>>                Send Totales
79086>>>                Send OnConstrain of oEGRESOS_DD
79087>>>                Send Refresh of oEgresos 2
79088>>>            End_Procedure
79089>>>
79089>>>            Object oRadio4 is a Radio
79091>>>                Set Size to 10 50
79092>>>                Set Location to 9 169
79093>>>                Set Label to "Todos"
79094>>>            End_Object
79095>>>        
79095>>>            // If you set Current_Radio, you must set it AFTER the
79095>>>            // radio objects have been created AND AFTER Notify_Select_State has been
79095>>>            // created. i.e. Set in bottom-code of object at the end!!
79095>>>        //    Set Current_Radio to 0
79095>>>        
79095>>>        End_Object
79096>>>
79096>>>        Object oTIPO_GASTO is a RadioGroup
79098>>>            Set Location to 86 217
79099>>>            Set Size to 21 149
79100>>>        
79100>>>            Procedure Notify_Select_State Integer iToItem Integer iFromItem
79103>>>                Forward Send Notify_Select_State iToItem iFromItem
79105>>>                If (iToItem eq 0) Set psOpcionPago to 'TODOS'
79108>>>                If (iToItem eq 1) Set psOpcionPago to 'TD'
79111>>>                If (iToItem eq 2) Set psOpcionPago to 'TC'
79114>>>                If (iToItem eq 3) Set psOpcionPago to 'EF'
79117>>>                Send Totales
79118>>>                Send OnConstrain of oEGRESOS_DD
79119>>>                Send Refresh of oEgresos 2
79120>>>                // for augmentation
79120>>>            End_Procedure
79121>>>
79121>>>            Object oRadio1 is a Radio
79123>>>                Set Label to "Todos"
79124>>>                Set Size to 10 32
79125>>>                Set Location to 8 10
79126>>>            End_Object
79127>>>            Object oRadio2 is a Radio
79129>>>                Set Label to "TD"
79130>>>                Set Size to 10 23
79131>>>                Set Location to 8 50
79132>>>            End_Object
79133>>>            Object oRadio3 is a Radio
79135>>>                Set Label to "TC"
79136>>>                Set Size to 10 23
79137>>>                Set Location to 8 83
79138>>>            End_Object
79139>>>            Object oRadio4 is a Radio
79141>>>                Set Size to 10 23
79142>>>                Set Location to 9 116
79143>>>                Set Label to "EF"
79144>>>            End_Object
79145>>>        
79145>>>            // If you set Current_Radio, you must set it AFTER the
79145>>>            // radio objects have been created AND AFTER Notify_Select_State has been
79145>>>            // created. i.e. Set in bottom-code of object at the end!!
79145>>>        //    Set Current_Radio to 0
79145>>>        
79145>>>        End_Object
79146>>>
79146>>>        Object oCargaFijos is a Button
79148>>>            Set Size to 23 30
79149>>>            Set Location to 8 374
79150>>>            Set Label to 'CargaFijos'
79151>>>            Set Bitmap to 'upload.bmp'
79152>>>        
79152>>>            // fires when the button is clicked
79152>>>            Procedure OnClick
79155>>>                Send Cargar_Eg_Fijos
79156>>>            End_Procedure
79157>>>        
79157>>>        End_Object
79158>>>        Object oTextBox1 is a TextBox
79160>>>            Set Size to 9 40
79161>>>            Set Location to 33 371
79162>>>            Set Label to 'Cargar Fijos'
79163>>>        End_Object
79164>>>        Object oCargaPendientes is a Button
79166>>>            Set Size to 23 30
79167>>>            Set Location to 50 375
79168>>>            Set Label to 'Carga Pendientes'
79169>>>            Set Bitmap to 'getmoney.bmp'
79170>>>        
79170>>>            // fires when the button is clicked
79170>>>            Procedure OnClick
79173>>>                Local Integer iConfirm
79173>>>                Get Confirm 'Se cargar n los Movimientos a cr‚dito pagados de la quincena anterior, desea continuar?' 'Atencion!' to iConfirm
79174>>>                
79174>>>                If (iConfirm eq 1) Procedure_Return
79177>>>                
79177>>>                Send Cargar_Eg_Pendientes
79178>>>            End_Procedure
79179>>>        
79179>>>        End_Object
79180>>>        Object oTextBox2 is a TextBox
79182>>>            Set Auto_Size_State to False
79183>>>            Set Size to 23 38
79184>>>            Set Location to 76 376
79185>>>            Set Label to 'Cargar Gastos Pendientes'
79186>>>            Set Justification_Mode to JMode_Left
79187>>>        End_Object
79188>>>
79188>>>        Object oLiquidar is a Button
79190>>>            Set Size to 23 30
79191>>>            Set Location to 8 417
79192>>>            Set Label to 'CargaFijos'
79193>>>            Set Bitmap to 'Tarjeta_mini.bmp'
79194>>>        
79194>>>            // fires when the button is clicked
79194>>>            Procedure OnClick
79197>>>                Send Liquidar
79198>>>            End_Procedure
79199>>>        
79199>>>        End_Object
79200>>>
79200>>>        Object oTextBox1 is a TextBox
79202>>>            Set Size to 9 40
79203>>>            Set Location to 33 419
79204>>>            Set Label to "Liquidar"
79205>>>        End_Object
79206>>>    End_Object
79207>>>
79207>>>Cd_End_Object
79209>>>>
79209>        Use TIPO_GASTO.vw
Including file: TIPO_GASTO.vw    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\TIPO_GASTO.vw)
79209>>>Use Windows.pkg
79209>>>Use DFClient.pkg
79209>>>Use cTIPO_GASTO_DataDictionary.dd
79209>>>Use cDbCJGrid.pkg
79209>>>Use cdbCJGridColumn.pkg
79209>>>
79209>>>Deferred_View Activate_TIPO_GASTO for ;Object TIPO_GASTO is a dbView
79234>>>    Object oTIPO_GASTO_DD is a cTIPO_GASTO_DataDictionary
79236>>>    End_Object
79237>>>
79237>>>    Set Main_DD to oTIPO_GASTO_DD
79238>>>    Set Server to oTIPO_GASTO_DD
79239>>>
79239>>>    Set Border_Style to Border_Thick
79240>>>    Set Size to 142 300
79241>>>    Set Location to 2 2
79242>>>    Set Label to "Catalogo Tipos de Gastos"
79243>>>
79243>>>    Object oDbGroup1 is a dbGroup
79245>>>        Set Size to 130 277
79246>>>        Set Location to 6 9
79247>>>        Set Label to 'Cat logo Tipo de Gastos'
79248>>>
79248>>>        Object oDbCJGrid1 is a cDbCJGrid
79250>>>            Set Size to 100 267
79251>>>            Set Location to 12 5
79252>>>
79252>>>            Object oTIPO_GASTO_NUMERO is a cDbCJGridColumn
79254>>>                Entry_Item TIPO_GASTO.NUMERO
79255>>>                Set piWidth to 70
79256>>>                Set psCaption to "#"
79257>>>            End_Object
79258>>>
79258>>>            Object oTIPO_GASTO_CLAVE is a cDbCJGridColumn
79260>>>                Entry_Item TIPO_GASTO.CLAVE
79261>>>                Set piWidth to 77
79262>>>                Set psCaption to "Clave"
79263>>>                Set pbCapslock to True
79264>>>            End_Object
79265>>>
79265>>>            Object oTIPO_GASTO_DESCRIPCION is a cDbCJGridColumn
79267>>>                Entry_Item TIPO_GASTO.DESCRIPCION
79268>>>                Set piWidth to 387
79269>>>                Set psCaption to "Descripcion"
79270>>>            End_Object
79271>>>        End_Object
79272>>>    End_Object
79273>>>
79273>>>Cd_End_Object
79275>>>>
79275>        Use GASTOS_01.rv
Including file: GASTOS_01.rv    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\GASTOS_01.rv)
79275>>>Use Windows.pkg
79275>>>Use DFRptVw.pkg
79275>>>Use DFRpt.pkg
79275>>>Use File_Dlg.Pkg
79275>>>Use PRESUPUESTO.sl
79275>>>
79275>>>Activate_View Activate_GASTOS_01 for GASTOS_01
79285>>>>
79285>>>Object GASTOS_01 is a ReportView
79287>>>    Set Location to 6 6
79288>>>    Set Size to 56 181
79289>>>    Set Label to "Grafica de Gastos"
79290>>>
79290>>>    Object oOkButton is a Button
79292>>>        Set Label to "&OK"
79293>>>        Set Location to 35 38
79294>>>        Set Default_State to TRUE
79295>>>
79295>>>        Procedure OnClick
79298>>>            Send Comenzar_reporte
79299>>>        End_Procedure
79300>>>
79300>>>    End_Object
79301>>>
79301>>>    Object oCancelButton is a Button
79303>>>        Set Label to "&Cancel"
79304>>>        Set Location to 35 93
79305>>>
79305>>>        Procedure OnClick
79308>>>            Send Request_Cancel
79309>>>        End_Procedure
79310>>>
79310>>>    End_Object
79311>>>
79311>>>    Object oSaveAsDialog is a SaveAsDialog
79313>>>    End_Object
79314>>>
79314>>>     Procedure Comenzar_reporte
79317>>>        Set Report_name of (S4006(Current_Object)) to "Report2.rpt"
79318>>>        Send Run_Report to (S4006(Current_Object))
79319>>>    End_Procedure
79320>>>    
79320>>>    Object S4006 is a WinQLReport
79322>>>        Set Output_Destination to WQL_PRINT_TO_WINDOW
79323>>>    
79323>>>        Procedure OnInitializeReport
79326>>>            Forward Send OninitializeReport
79328>>>            Local Number nPresupuesto
79328>>>            Local String @Seleccion
79328>>>            
79328>>>            Get Value of oPRESUPUESTO to nPresupuesto
79329>>>            Move '' to @Seleccion
79330>>>            
79330>>>            Clear PRESUPUESTO
79331>>>            Move nPresupuesto to PRESUPUESTO.NUMERO
79332>>>            Find eq PRESUPUESTO by Index.1
79333>>>>
79333>>>            If [not Found] Begin
79335>>>                Send Stop_Box 'Ingrese un presupuesto valido' '!'
79336>>>                Procedure_Return
79337>>>            End
79337>>>>
79337>>>            
79337>>>            If (nPresupuesto ne 0)   Begin
79339>>>                Append @Seleccion '  {PRESUPUESTO.NUMERO} = ' PRESUPUESTO.NUMERO
79341>>>            End
79341>>>>
79341>>>            
79341>>>            Set SelectionFormula      to @Seleccion
79342>>>        End_Procedure
79343>>>        
79343>>>    End_Object
79344>>>
79344>>>    Object oPRESUPUESTO is a Form
79346>>>        Set Size to 13 69
79347>>>        Set Location to 10 72
79348>>>        Set Label_Col_Offset to 2
79349>>>        Set Label to "Presupuesto:"
79350>>>        Set Label_Justification_Mode to JMode_Right
79351>>>        Set Prompt_Button_Mode to PB_PromptOn
79352>>>        Set Prompt_Object to PRESUPUESTO_SL
79353>>>    
79353>>>        // OnChange is called on every changed character
79353>>>    //    Procedure OnChange
79353>>>    //        String sValue
79353>>>    //    
79353>>>    //        Get Value to sValue
79353>>>    //    End_Procedure
79353>>>    
79353>>>    End_Object
79354>>>    
79354>>>    On_Key Key_Alt+Key_O Send KeyAction of oOkButton
79355>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancelButton
79356>>>
79356>>>End_Object
79357>        Use GASTOS_02.rv
Including file: GASTOS_02.rv    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\GASTOS_02.rv)
79357>>>Use Windows.pkg
79357>>>Use DFRptVw.pkg
79357>>>Use DFRpt.pkg
79357>>>Use File_Dlg.Pkg
79357>>>Use PRESUPUESTO.sl
79357>>>
79357>>>Activate_View Activate_GASTOS_02 for GASTOS_02
79367>>>>
79367>>>Object GASTOS_02 is a ReportView
79369>>>    Set Location to 6 6
79370>>>    Set Size to 59 181
79371>>>    Set Label to "Listado de Gastos"
79372>>>
79372>>>    Object oOkButton is a Button
79374>>>        Set Label to "&OK"
79375>>>        Set Location to 34 42
79376>>>        Set Default_State to TRUE
79377>>>
79377>>>        Procedure OnClick
79380>>>            Send Comenzar_reporte
79381>>>        End_Procedure
79382>>>
79382>>>    End_Object
79383>>>
79383>>>    Object oCancelButton is a Button
79385>>>        Set Label to "&Cancel"
79386>>>        Set Location to 34 97
79387>>>
79387>>>        Procedure OnClick
79390>>>            Send Request_Cancel
79391>>>        End_Procedure
79392>>>
79392>>>    End_Object
79393>>>
79393>>>    Object oSaveAsDialog is a SaveAsDialog
79395>>>    End_Object
79396>>>
79396>>>     Procedure Comenzar_reporte
79399>>>        Set Report_name of (S4006(Current_Object)) to "Report1.rpt"
79400>>>        Send Run_Report to (S4006(Current_Object))
79401>>>        
79401>>>    End_Procedure
79402>>>    
79402>>>    Object S4006 is a WinQLReport
79404>>>        Set Output_Destination to WQL_PRINT_TO_WINDOW
79405>>>    
79405>>>        Procedure OnInitializeReport
79408>>>            Forward Send OninitializeReport
79410>>>            Local Number nPresupuesto
79410>>>            Local String @Seleccion
79410>>>            
79410>>>            Get Value of oPRESUPUESTO to nPresupuesto
79411>>>            Move '' to @Seleccion
79412>>>            
79412>>>            Clear PRESUPUESTO
79413>>>            Move nPresupuesto to PRESUPUESTO.NUMERO
79414>>>            Find eq PRESUPUESTO by Index.1
79415>>>>
79415>>>            If [not Found] Begin
79417>>>                Send Stop_Box 'Ingrese un presupuesto valido' '!'
79418>>>                Procedure_Return
79419>>>            End
79419>>>>
79419>>>            
79419>>>            If (nPresupuesto ne 0)   Begin
79421>>>                Append @Seleccion '  {PRESUPUESTO.NUMERO} = ' PRESUPUESTO.NUMERO
79423>>>            End
79423>>>>
79423>>>            
79423>>>            Set SelectionFormula      to @Seleccion
79424>>>        End_Procedure
79425>>>        
79425>>>    End_Object
79426>>>
79426>>>    Object oPRESUPUESTO is a Form
79428>>>        Set Size to 13 69
79429>>>        Set Location to 10 67
79430>>>        Set Label_Col_Offset to 2
79431>>>        Set Label to "Presupuesto:"
79432>>>        Set Label_Justification_Mode to JMode_Right
79433>>>        Set Prompt_Button_Mode to PB_PromptOn
79434>>>        Set Prompt_Object to PRESUPUESTO_SL
79435>>>    
79435>>>        // OnChange is called on every changed character
79435>>>    //    Procedure OnChange
79435>>>    //        String sValue
79435>>>    //    
79435>>>    //        Get Value to sValue
79435>>>    //    End_Procedure
79435>>>    
79435>>>    End_Object
79436>>>    
79436>>>    On_Key Key_Alt+Key_O Send KeyAction of oOkButton
79437>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancelButton
79438>>>
79438>>>End_Object
79439>        Use AHORRO.vw
Including file: AHORRO.vw    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\AHORRO.vw)
79439>>>Use Windows.pkg
79439>>>Use DFClient.pkg
79439>>>Use cAHORRO_H_DataDictionary.dd
Including file: cAHORRO_H_DataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cAHORRO_H_DataDictionary.dd)
79439>>>>>Use DataDict.pkg
79439>>>>>
79439>>>>>Open AHORRO_H
Including file: AHORRO_H.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\AHORRO_H.fd)
79441>>>>>Open AHORRO_D
Including file: AHORRO_D.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\AHORRO_D.fd)
79443>>>>>
79443>>>>>Class cAHORRO_H_DataDictionary is a DataDictionary
79444>>>>>    
79444>>>>>    Procedure Construct_Object
79446>>>>>        Forward Send Construct_Object
79448>>>>>        Set Main_File to AHORRO_H.File_Number
79449>>>>>
79449>>>>>        Set Add_Client_File to AHORRO_D.File_Number
79450>>>>>
79450>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79451>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79452>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79453>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79454>>>>>
79454>>>>>        Set Field_Class_Name Field AHORRO_H.PRIORIDAD to "Combo"
79455>>>>>
79455>>>>>    End_Procedure
79456>>>>>
79456>>>>>    Procedure Field_Defaults
79458>>>>>        Forward Send Field_Defaults
79460>>>>>    End_Procedure
79461>>>>>
79461>>>>>End_Class
79462>>>Use cAHORRO_D_DataDictionary.dd
Including file: cAHORRO_D_DataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cAHORRO_D_DataDictionary.dd)
79462>>>>>Use DataDict.pkg
79462>>>>>
79462>>>>>Open AHORRO_D
79464>>>>>Open AHORRO_H
79466>>>>>
79466>>>>>Class cAHORRO_D_DataDictionary is a DataDictionary
79467>>>>>    
79467>>>>>    Procedure Construct_Object
79469>>>>>        Forward Send Construct_Object
79471>>>>>        Set Main_File to AHORRO_D.File_Number
79472>>>>>
79472>>>>>        Set Add_Server_File to AHORRO_H.File_Number
79473>>>>>
79473>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79474>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79475>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79476>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79477>>>>>
79477>>>>>        Set Field_Class_Name Field AHORRO_D.PAGADO_SN to "Checkbox"
79478>>>>>        Set Field_Checkbox_Values Field AHORRO_D.PAGADO_SN to "S" "N"
79479>>>>>
79479>>>>>    End_Procedure
79480>>>>>
79480>>>>>    Procedure Field_Defaults
79482>>>>>        Forward Send Field_Defaults
79484>>>>>        Set Field_Changed_Value Field AHORRO_D.PAGADO_SN to "N"
79485>>>>>    End_Procedure
79486>>>>>
79486>>>>>End_Class
79487>>>Use DFEntry.pkg
79487>>>Use cDbCJGrid.pkg
79487>>>Use cdbCJGridColumn.pkg
79487>>>Use DfCentry.pkg
79487>>>
79487>>>Deferred_View Activate_AHORRO for ;Object AHORRO is a dbView
79512>>>    Object oAHORRO_H_DD is a cAHORRO_H_DataDictionary
79514>>>        Procedure Relate_Main_File 
79517>>>            Forward Send Relate_Main_File
79519>>>                Set Shadow_State of oAHORRO_H_DESCRIPCION         to True
79520>>>                Set Shadow_State of oAHORRO_H_FECHA_INICIO        to True
79521>>>                Set Shadow_State of oAHORRO_H_FECHA_OBJETIVO      to True 
79522>>>                Set Shadow_State of oAHORRO_H_PRIORIDAD           to True
79523>>>            Send Totales
79524>>>        End_Procedure
79525>>>    End_Object
79526>>>    
79526>>>    Procedure Request_Clear
79529>>>        Forward Send Request_Clear
79531>>>        Set Shadow_State of oAHORRO_H_DESCRIPCION         to False
79532>>>        Set Shadow_State of oAHORRO_H_FECHA_INICIO        to False
79533>>>        Set Shadow_State of oAHORRO_H_FECHA_OBJETIVO      to False 
79534>>>        Set Shadow_State of oAHORRO_H_PRIORIDAD           to False
79535>>>        Set Value of oTOTAL         to ''
79536>>>        Set Value of oTOTAL_PROYECT to ''
79537>>>    End_Procedure
79538>>>    
79538>>>    Procedure Request_Clear_All
79541>>>        Forward Send Request_Clear_All
79543>>>        Set Shadow_State of oAHORRO_H_DESCRIPCION         to False
79544>>>        Set Shadow_State of oAHORRO_H_FECHA_INICIO        to False
79545>>>        Set Shadow_State of oAHORRO_H_FECHA_OBJETIVO      to False 
79546>>>        Set Shadow_State of oAHORRO_H_PRIORIDAD           to False
79547>>>        Set Value of oTOTAL         to ''
79548>>>        Set Value of oTOTAL_PROYECT to ''
79549>>>    End_Procedure
79550>>>
79550>>>    Object oAHORRO_D_DD is a cAHORRO_D_DataDictionary
79552>>>        Set Constrain_file to AHORRO_H.File_number
79553>>>        Set DDO_Server to oAHORRO_H_DD
79554>>>        
79554>>>        
79554>>>        Procedure request_save
79557>>>            Forward Send Request_Save
79559>>>            Move AHORRO_H.NUMERO to AHORRO_D.AHORRO_H
79560>>>        End_Procedure
79561>>>    End_Object
79562>>>    
79562>>>    //FUNCIONES Y PROCEDIMIENTOS
79562>>>    Procedure Totales 
79565>>>        Local String sQ
79565>>>        Local Handle hdbc69 hstmt69
79565>>>        Local Number nMonto nMontoEsp nValPgdo nValDispo
79565>>>    
79565>>>        Move '' to sQ
79566>>>        Move 0  to nMonto
79567>>>        Move 0  to nMontoEsp
79568>>>        Append sQ " SELECT SUM(MONTO) FROM AHORRO_D WHERE PAGADO_SN = 'S' AND AHORRO_H =  " AHORRO_H.NUMERO 
79570>>>        SQLFileConnect EGRESOS to hdbc69
79571>>>        SQLOpen hdbc69 to hstmt69
79574>>>        SQLExecDirect hstmt69 sQ
79577>>>        Repeat
79577>>>>
79577>>>           SQLFileFetch hstmt69
79583>>>           If (SQLResult) Begin
79585>>>              Get SQLColumnValue of hstmt69   1 to nMonto
79586>>>           End
79586>>>>
79586>>>        Until (not(SQLResult))
79588>>>        SQLClose hstmt69
79591>>>        SQLDisconnect hdbc69
79594>>>        
79594>>>        Move '' to sQ
79595>>>        Append sQ " SELECT SUM(MONTO_PROYECTADO) FROM AHORRO_D WHERE AHORRO_H =  " AHORRO_H.NUMERO //SUM(MONTO_PROYECTADO)
79597>>>        SQLFileConnect EGRESOS to hdbc69
79598>>>        SQLOpen hdbc69 to hstmt69
79601>>>        SQLExecDirect hstmt69 sQ
79604>>>        Repeat
79604>>>>
79604>>>           SQLFileFetch hstmt69
79610>>>           If (SQLResult) Begin
79612>>>              Get SQLColumnValue of hstmt69   1 to nMontoEsp
79613>>>           End
79613>>>>
79613>>>        Until (not(SQLResult))
79615>>>        SQLClose hstmt69
79618>>>        SQLDisconnect hdbc69
79621>>>        
79621>>>        Set Value of oTOTAL         to nMonto
79622>>>        Set Value of oTOTAL_PROYECT to nMontoEsp
79623>>>        
79623>>>    End_Procedure
79624>>>
79624>>>    Set Main_DD to oAHORRO_H_DD
79625>>>    Set Server to oAHORRO_H_DD
79626>>>
79626>>>    Set Border_Style to Border_Thick
79627>>>    Set Size to 266 336
79628>>>    Set Location to 2 2
79629>>>    Set Label to "Control De Ahorros..."
79630>>>    Set Color to 9824917
79631>>>
79631>>>    Object oDbContainer3d1 is a dbContainer3d
79633>>>        Set Size to 108 315
79634>>>        Set Location to 3 11
79635>>>
79635>>>        Object oDbGroup1 is a dbGroup
79637>>>            Set Size to 101 238
79638>>>            Set Location to 1 5
79639>>>            Set Label to 'Ahorro'
79640>>>
79640>>>            Object oAHORRO_H_NUMERO is a dbForm
79642>>>                Entry_Item AHORRO_H.NUMERO
79643>>>                Set Location to 17 67
79644>>>                Set Size to 13 66
79645>>>                Set Label to "NUMERO:"
79646>>>            End_Object
79647>>>
79647>>>            Object oAHORRO_H_DESCRIPCION is a dbForm
79649>>>                Entry_Item AHORRO_H.DESCRIPCION
79650>>>                Set Location to 32 67
79651>>>                Set Size to 13 139
79652>>>                Set Label to "DESCRIPCION:"
79653>>>            End_Object
79654>>>
79654>>>            Object oAHORRO_H_FECHA_INICIO is a dbForm
79656>>>                Entry_Item AHORRO_H.FECHA_INICIO
79657>>>                Set Location to 47 67
79658>>>                Set Size to 13 66
79659>>>                Set Label to "FECHA INICIO:"
79660>>>            End_Object
79661>>>
79661>>>            Object oAHORRO_H_FECHA_OBJETIVO is a dbForm
79663>>>                Entry_Item AHORRO_H.FECHA_OBJETIVO
79664>>>                Set Location to 62 67
79665>>>                Set Size to 13 66
79666>>>                Set Label to "FECHA OBJETIVO:"
79667>>>            End_Object
79668>>>
79668>>>            Object oAHORRO_H_PRIORIDAD is a dbComboForm
79670>>>                Entry_Item AHORRO_H.PRIORIDAD
79671>>>                Set Location to 79 67
79672>>>                Set Size to 13 66
79673>>>                Set Label to "PRIORIDAD:"
79674>>>                
79674>>>                Procedure Combo_Fill_List
79677>>>                    Send Combo_Add_Item "ALTA"
79678>>>                    Send Combo_Add_Item "MEDIA"
79679>>>                    Send Combo_Add_Item "BAJA"
79680>>>                End_Procedure
79681>>>
79681>>>            End_Object
79682>>>        End_Object
79683>>>
79683>>>        Object oTOTAL is a dbForm
79685>>>            Set Size to 13 57
79686>>>            Set Location to 87 249
79687>>>            Set Entry_State to False
79688>>>            Set Color to 4643654
79689>>>            Set Numeric_Mask 0 to 4 2
79690>>>        End_Object
79691>>>
79691>>>        Object oTOTAL_PROYECT is a dbForm
79693>>>            Set Size to 13 57
79694>>>            Set Location to 64 249
79695>>>            Set Entry_State to False
79696>>>            Set Numeric_Mask 0 to 4 2
79697>>>        End_Object
79698>>>
79698>>>        Object oTextBox1 is a TextBox
79700>>>            Set Size to 9 40
79701>>>            Set Location to 78 250
79702>>>            Set Label to 'Total Actual'
79703>>>        End_Object
79704>>>
79704>>>        Object oTextBox1 is a TextBox
79706>>>            Set Size to 9 57
79707>>>            Set Location to 55 250
79708>>>            Set Label to 'Total Proyectado'
79709>>>        End_Object
79710>>>    End_Object
79711>>>
79711>>>    Object oDbContainer3d2 is a dbContainer3d
79713>>>        Set Size to 148 314
79714>>>        Set Location to 114 12
79715>>>
79715>>>        Object oDbCJGrid1 is a cDbCJGrid
79717>>>            Set Server to oAHORRO_D_DD
79718>>>            Set Size to 139 301
79719>>>            Set Location to 3 4
79720>>>
79720>>>            Object oAHORRO_D_NUMERO is a cDbCJGridColumn
79722>>>                Entry_Item AHORRO_D.NUMERO
79723>>>                Set piWidth to 45
79724>>>                Set psCaption to "#"
79725>>>            End_Object
79726>>>
79726>>>            Object oAHORRO_D_DESCRIPCION is a cDbCJGridColumn
79728>>>                Entry_Item AHORRO_D.DESCRIPCION
79729>>>                Set piWidth to 239
79730>>>                Set psCaption to "Descripcion"
79731>>>            End_Object
79732>>>
79732>>>            Object oAHORRO_D_MONTO is a cDbCJGridColumn
79734>>>                Entry_Item AHORRO_D.MONTO
79735>>>                Set piWidth to 79
79736>>>                Set psCaption to "Monto"
79737>>>            End_Object
79738>>>
79738>>>            Object oAHORRO_D_MONTO_PROYECTADO is a cDbCJGridColumn
79740>>>                Entry_Item AHORRO_D.MONTO_PROYECTADO
79741>>>                Set piWidth to 89
79742>>>                Set psCaption to "Mnto Espe."
79743>>>            End_Object
79744>>>
79744>>>            Object oAHORRO_D_PAGADO_SN is a cDbCJGridColumn
79746>>>                Entry_Item AHORRO_D.PAGADO_SN
79747>>>                Set piWidth to 52
79748>>>                Set psCaption to "Pgdo?"
79749>>>                Set pbCheckbox to True
79750>>>            End_Object
79751>>>
79751>>>            Object oAHORRO_D_FECHA_REALIZADO is a cDbCJGridColumn
79753>>>                Entry_Item AHORRO_D.FECHA_REALIZADO
79754>>>                Set piWidth to 98
79755>>>                Set psCaption to "Fecha"
79756>>>            End_Object
79757>>>        End_Object
79758>>>    End_Object
79759>>>
79759>>>Cd_End_Object
79761>>>>
79761>        Use Deudas.vw
Including file: Deudas.vw    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\Deudas.vw)
79761>>>Use Windows.pkg
79761>>>Use DFClient.pkg
79761>>>Use cDEUDA_H_DataDictionary.dd
Including file: cDEUDA_H_DataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cDEUDA_H_DataDictionary.dd)
79761>>>>>Use DataDict.pkg
79761>>>>>
79761>>>>>Open DEUDA_H
Including file: DEUDA_H.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\DEUDA_H.fd)
79763>>>>>Open DEUDA_D
Including file: DEUDA_D.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\DEUDA_D.fd)
79765>>>>>
79765>>>>>Class cDEUDA_H_DataDictionary is a DataDictionary
79766>>>>>    
79766>>>>>    Procedure Construct_Object
79768>>>>>        Forward Send Construct_Object
79770>>>>>        Set Main_File to DEUDA_H.File_Number
79771>>>>>
79771>>>>>        Set Add_Client_File to DEUDA_D.File_Number
79772>>>>>
79772>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79773>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79774>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79775>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79776>>>>>
79776>>>>>        Set Field_Checkbox_Values Field DEUDA_H.A_FAVOR to "S" "N"
79777>>>>>        Set Field_Class_Name Field DEUDA_H.A_FAVOR to "Checkbox"
79778>>>>>
79778>>>>>    End_Procedure
79779>>>>>
79779>>>>>    Procedure Field_Defaults
79781>>>>>        Forward Send Field_Defaults
79783>>>>>        Set Field_Changed_Value Field DEUDA_H.A_FAVOR to "N"
79784>>>>>    End_Procedure
79785>>>>>
79785>>>>>End_Class
79786>>>Use cDEUDA_D_DataDictionary.dd
Including file: cDEUDA_D_DataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cDEUDA_D_DataDictionary.dd)
79786>>>>>Use DataDict.pkg
79786>>>>>
79786>>>>>Open DEUDA_D
79788>>>>>Open DEUDA_H
79790>>>>>
79790>>>>>Class cDEUDA_D_DataDictionary is a DataDictionary
79791>>>>>    
79791>>>>>    Procedure Construct_Object
79793>>>>>        Forward Send Construct_Object
79795>>>>>        Set Main_File to DEUDA_D.File_Number
79796>>>>>
79796>>>>>        Set Add_Server_File to DEUDA_H.File_Number
79797>>>>>
79797>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79798>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79799>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79800>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79801>>>>>
79801>>>>>        Set Field_Class_Name Field DEUDA_D.PAGADO_SN to "Checkbox"
79802>>>>>        Set Field_Checkbox_Values Field DEUDA_D.PAGADO_SN to "S" "N"
79803>>>>>
79803>>>>>    End_Procedure
79804>>>>>
79804>>>>>    Procedure Field_Defaults
79806>>>>>        Forward Send Field_Defaults
79808>>>>>        Set Field_Changed_Value Field DEUDA_D.PAGADO_SN to "N"
79809>>>>>    End_Procedure
79810>>>>>
79810>>>>>End_Class
79811>>>Use DFEntry.pkg
79811>>>Use cDbCJGrid.pkg
79811>>>Use cdbCJGridColumn.pkg
79811>>>Use DFEnChk.pkg
79811>>>
79811>>>Deferred_View Activate_Deudas for ;Object Deudas is a dbView
79836>>>    Procedure Request_Clear
79839>>>        Forward Send Request_Clear
79841>>>            Set Shadow_State of oDEUDA_H_CLAVE        to False
79842>>>            Set Shadow_State of oDEUDA_H_MONTO        to False
79843>>>            Set Shadow_State of oDEUDA_H_TIPO         to False 
79844>>>            Set Shadow_State of oDEUDA_H_FECHA_INICIO to False
79845>>>            Set Shadow_State of oDEUDA_H_FECHA_FIN    to False
79846>>>            Set Shadow_State of oDEUDA_H_DESCRIPCION  to False
79847>>>            Set Value of oTOTAL         to ''
79848>>>            Set Value of oTOTAL_PROYECT to ''
79849>>>    End_Procedure
79850>>>    
79850>>>    Procedure Request_Clear_All
79853>>>        Forward Send Request_Clear_All
79855>>>            Set Shadow_State of oDEUDA_H_CLAVE        to False
79856>>>            Set Shadow_State of oDEUDA_H_MONTO        to False
79857>>>            Set Shadow_State of oDEUDA_H_TIPO         to False 
79858>>>            Set Shadow_State of oDEUDA_H_FECHA_INICIO to False
79859>>>            Set Shadow_State of oDEUDA_H_FECHA_FIN    to False
79860>>>            Set Shadow_State of oDEUDA_H_DESCRIPCION  to False
79861>>>            Set Value of oTOTAL         to ''
79862>>>            Set Value of oTOTAL_PROYECT to ''
79863>>>    End_Procedure
79864>>>    
79864>>>    
79864>>>    Object oDEUDA_H_DD is a cDEUDA_H_DataDictionary
79866>>>        Procedure Relate_Main_File
79869>>>            Forward Send Relate_Main_File
79871>>>            
79871>>>            // SI ES A FAVOR LOS TOTALES SON CON DIFERENTE LOGICA 
79871>>>            If (DEUDA_H.A_FAVOR eq 'N') Send Totales
79874>>>            Else Send Totales2
79876>>>            
79876>>>            Set Shadow_State of oDEUDA_H_CLAVE        to True
79877>>>            Set Shadow_State of oDEUDA_H_MONTO        to True
79878>>>            Set Shadow_State of oDEUDA_H_TIPO         to True 
79879>>>            Set Shadow_State of oDEUDA_H_FECHA_INICIO to True
79880>>>            Set Shadow_State of oDEUDA_H_FECHA_FIN    to True
79881>>>            Set Shadow_State of oDEUDA_H_DESCRIPCION  to True
79882>>>        End_Procedure
79883>>>        
79883>>>    End_Object
79884>>>
79884>>>    Object oDEUDA_D_DD is a cDEUDA_D_DataDictionary
79886>>>        Set Constrain_file to DEUDA_H.File_number
79887>>>        Set DDO_Server to oDEUDA_H_DD
79888>>>        
79888>>>        
79888>>>        Procedure Request_Save 
79891>>>            Forward Send Request_Save
79893>>>                Move DEUDA_H.NUMERO to DEUDA_D.DEUDA_H
79894>>>        End_Procedure
79895>>>        
79895>>>    End_Object
79896>>>    
79896>>>    
79896>>>    //FUNCIONES Y PROCEDIMIENTOS
79896>>>    Procedure Totales 
79899>>>        Local String sQ
79899>>>        Local Handle hdbc69 hstmt69
79899>>>        Local Number nMonto nMontoEsp nTotalDeuda 
79899>>>    
79899>>>        Move '' to sQ
79900>>>        Move 0  to nMonto
79901>>>        Move 0  to nMontoEsp
79902>>>        Append sQ " SELECT SUM(MONTO) FROM DEUDA_D WHERE PAGADO_SN = 'S' AND DEUDA_H =  " DEUDA_H.NUMERO 
79904>>>        SQLFileConnect EGRESOS to hdbc69
79905>>>        SQLOpen hdbc69 to hstmt69
79908>>>        SQLExecDirect hstmt69 sQ
79911>>>        Repeat
79911>>>>
79911>>>           SQLFileFetch hstmt69
79917>>>           If (SQLResult) Begin
79919>>>              Get SQLColumnValue of hstmt69   1 to nMonto
79920>>>           End
79920>>>>
79920>>>        Until (not(SQLResult))
79922>>>        SQLClose hstmt69
79925>>>        SQLDisconnect hdbc69
79928>>>        
79928>>>        Move '' to sQ
79929>>>        Append sQ " SELECT SUM(MONTO_PROYECTADO) FROM DEUDA_D WHERE DEUDA_H =  " DEUDA_H.NUMERO 
79931>>>        SQLFileConnect EGRESOS to hdbc69
79932>>>        SQLOpen hdbc69 to hstmt69
79935>>>        SQLExecDirect hstmt69 sQ
79938>>>        Repeat
79938>>>>
79938>>>           SQLFileFetch hstmt69
79944>>>           If (SQLResult) Begin
79946>>>              Get SQLColumnValue of hstmt69   1 to nMontoEsp
79947>>>           End
79947>>>>
79947>>>        Until (not(SQLResult))
79949>>>        SQLClose hstmt69
79952>>>        SQLDisconnect hdbc69
79955>>>        
79955>>>        Get Value of oDEUDA_H_MONTO to nTotalDeuda
79956>>>        
79956>>>        Move (DEUDA_H.MONTO -nMonto)    to nMonto
79957>>>        Move (DEUDA_H.MONTO -nMontoEsp) to nMontoEsp
79958>>>        
79958>>>        Set Value of oTOTAL         to nMonto
79959>>>        Set Value of oTOTAL_PROYECT to nMontoEsp
79960>>>        Set Value of oTextDIFERENCIA to '--'
79961>>>        
79961>>>    End_Procedure
79962>>>    
79962>>>    
79962>>>    //FUNCIONES Y PROCEDIMIENTOS
79962>>>    Procedure Totales2 
79965>>>        Local String sQ
79965>>>        Local Handle hdbc69 hstmt69
79965>>>        Local Number nMonto nMontoEsp nTotalDeuda nDiferencia
79965>>>    
79965>>>        Move '' to sQ
79966>>>        Move 0  to nMonto
79967>>>        Move 0  to nMontoEsp
79968>>>        Append sQ " SELECT SUM(MONTO) FROM DEUDA_D WHERE PAGADO_SN = 'S' AND DEUDA_H =  " DEUDA_H.NUMERO 
79970>>>        SQLFileConnect EGRESOS to hdbc69
79971>>>        SQLOpen hdbc69 to hstmt69
79974>>>        SQLExecDirect hstmt69 sQ
79977>>>        Repeat
79977>>>>
79977>>>           SQLFileFetch hstmt69
79983>>>           If (SQLResult) Begin
79985>>>              Get SQLColumnValue of hstmt69   1 to nMonto
79986>>>           End
79986>>>>
79986>>>        Until (not(SQLResult))
79988>>>        SQLClose hstmt69
79991>>>        SQLDisconnect hdbc69
79994>>>        
79994>>>        Move '' to sQ
79995>>>        Append sQ " SELECT SUM(MONTO_PROYECTADO) FROM DEUDA_D WHERE DEUDA_H =  " DEUDA_H.NUMERO 
79997>>>        SQLFileConnect EGRESOS to hdbc69
79998>>>        SQLOpen hdbc69 to hstmt69
80001>>>        SQLExecDirect hstmt69 sQ
80004>>>        Repeat
80004>>>>
80004>>>           SQLFileFetch hstmt69
80010>>>           If (SQLResult) Begin
80012>>>              Get SQLColumnValue of hstmt69   1 to nMontoEsp
80013>>>           End
80013>>>>
80013>>>        Until (not(SQLResult))
80015>>>        SQLClose hstmt69
80018>>>        SQLDisconnect hdbc69
80021>>>        
80021>>>        Set Value of oTOTAL         to nMonto
80022>>>        Set Value of oTOTAL_PROYECT to nMontoEsp
80023>>>        Move (nMontoEsp-nMonto) to nDiferencia
80024>>>        Set Value of oTextDIFERENCIA to ("Pendiente: "+String(nDiferencia))
80025>>>        
80025>>>        
80025>>>        Reread DEUDA_H
80029>>>        Move nMontoEsp to DEUDA_H.MONTO
80030>>>        SaveRecord DEUDA_H
80031>>>        Unlock
80032>>>>
80032>>>        
80032>>>    End_Procedure
80033>>>
80033>>>    Set Main_DD to oDEUDA_H_DD
80034>>>    Set Server to oDEUDA_H_DD
80035>>>
80035>>>    Set Border_Style to Border_Thick
80036>>>    Set Size to 284 263
80037>>>    Set Location to 2 2
80038>>>    Set Label to "Deudas"
80039>>>    Set Delegation_Mode to No_Delegate_Or_Error
80040>>>    Set Color to 16641499
80041>>>
80041>>>    Object oDbContainer3d1 is a dbContainer3d
80043>>>        Set Size to 122 247
80044>>>        Set Location to 4 9
80045>>>        Set Color to clMenu
80046>>>
80046>>>        Object oDEUDA_H_NUMERO is a dbForm
80048>>>            Entry_Item DEUDA_H.NUMERO
80049>>>            Set Location to 4 56
80050>>>            Set Size to 12 66
80051>>>            Set Label to "NUMERO:"
80052>>>            Set Label_Col_Offset to 2
80053>>>            Set Label_Justification_Mode to JMode_Right
80054>>>        End_Object
80055>>>
80055>>>        Object oDEUDA_H_CLAVE is a dbForm
80057>>>            Entry_Item DEUDA_H.CLAVE
80058>>>            Set Location to 4 165
80059>>>            Set Size to 12 66
80060>>>            Set Label to "CLAVE:"
80061>>>            Set Label_Col_Offset to 2
80062>>>            Set Label_Justification_Mode to JMode_Right
80063>>>        End_Object
80064>>>
80064>>>        Object oDEUDA_H_DESCRIPCION is a dbForm
80066>>>            Entry_Item DEUDA_H.DESCRIPCION
80067>>>            Set Location to 52 55
80068>>>            Set Size to 12 176
80069>>>            Set Label to "DESCRIPCION:"
80070>>>            Set Label_Col_Offset to 2
80071>>>            Set Label_Justification_Mode to JMode_Right
80072>>>        End_Object
80073>>>
80073>>>        Object oDEUDA_H_MONTO is a dbForm
80075>>>            Entry_Item DEUDA_H.MONTO
80076>>>            Set Location to 20 56
80077>>>            Set Size to 12 66
80078>>>            Set Label to "MONTO:"
80079>>>            Set Label_Col_Offset to 2
80080>>>            Set Label_Justification_Mode to JMode_Right
80081>>>        End_Object
80082>>>
80082>>>        Object oDEUDA_H_FECHA_INICIO is a dbForm
80084>>>            Entry_Item DEUDA_H.FECHA_INICIO
80085>>>            Set Location to 36 56
80086>>>            Set Size to 12 66
80087>>>            Set Label to "FECHA INICIO:"
80088>>>            Set Label_Col_Offset to 2
80089>>>            Set Label_Justification_Mode to JMode_Right
80090>>>        End_Object
80091>>>
80091>>>        Object oDEUDA_H_FECHA_FIN is a dbForm
80093>>>            Entry_Item DEUDA_H.FECHA_FIN
80094>>>            Set Location to 36 165
80095>>>            Set Size to 12 66
80096>>>            Set Label to "FECHA FIN:"
80097>>>            Set Label_Col_Offset to 2
80098>>>            Set Label_Justification_Mode to JMode_Right
80099>>>        End_Object
80100>>>
80100>>>        Object oDEUDA_H_TIPO is a dbForm
80102>>>            Entry_Item DEUDA_H.TIPO
80103>>>            Set Location to 20 165
80104>>>            Set Size to 12 20
80105>>>            Set Label to "TIPO:"
80106>>>            Set Label_Col_Offset to 2
80107>>>            Set Label_Justification_Mode to JMode_Right
80108>>>        End_Object
80109>>>
80109>>>        Object oDbGroup1 is a dbGroup
80111>>>            Set Size to 43 225
80112>>>            Set Location to 66 7
80113>>>            Set Label to 'Totales'
80114>>>            Set Color to 16641499
80115>>>
80115>>>            Object oTextBox1 is a TextBox
80117>>>                Set Size to 9 38
80118>>>                Set Location to 11 18
80119>>>                Set Label to 'Proyect.'
80120>>>            End_Object
80121>>>            Object oTOTAL_PROYECT is a dbForm
80123>>>                Set Size to 13 68
80124>>>                Set Location to 8 48
80125>>>                Set Entry_State to False
80126>>>                Set Numeric_Mask 0 to 4 2
80127>>>                Set Color to 16744576
80128>>>            End_Object
80129>>>
80129>>>            Object oTextBox1 is a TextBox
80131>>>                Set Size to 9 19
80132>>>                Set Location to 27 23
80133>>>                Set Label to 'Pdgo.'
80134>>>            End_Object
80135>>>            Object oTOTAL is a dbForm
80137>>>                Set Size to 13 68
80138>>>                Set Location to 24 48
80139>>>                Set Entry_State to False
80140>>>                Set Color to 16776960
80141>>>                Set Numeric_Mask 0 to 4 2
80142>>>            End_Object
80143>>>
80143>>>            Object oTextDIFERENCIA is a TextBox
80145>>>                Set Auto_Size_State to False
80146>>>                Set Size to 10 83
80147>>>                Set Location to 25 125
80148>>>                Set Label to '--'
80149>>>                Set Color to 16641499
80150>>>                Set Justification_Mode to JMode_Right
80151>>>            End_Object
80152>>>        End_Object
80153>>>
80153>>>        Object oDEUDA_H_A_FAVOR is a dbCheckBox
80155>>>            Entry_Item DEUDA_H.A_FAVOR
80156>>>            Set Location to 22 192
80157>>>            Set Size to 10 60
80158>>>            Set Label to "A FAVOR"
80159>>>        End_Object
80160>>>    End_Object
80161>>>
80161>>>    Object oDbContainer3d2 is a dbContainer3d
80163>>>        Set Size to 154 247
80164>>>        Set Location to 131 9
80165>>>
80165>>>        Object oDbCJGrid1 is a cDbCJGrid
80167>>>            Set Server to oDEUDA_D_DD
80168>>>            Set Size to 157 236
80169>>>            Set Location to 5 3
80170>>>            Set piSelectedRowBackColor to 65535
80171>>>            Set piGridLineColor to clScrollBar
80172>>>            Set piSelectedRowForeColor to 65408
80173>>>            Set peVisualTheme to xtpReportThemeVisualStudio2012Light
80174>>>
80174>>>            Object oDEUDA_D_NUMERO is a cDbCJGridColumn
80176>>>                Entry_Item DEUDA_D.RENGLON
80177>>>                Set piWidth to 20
80178>>>                Set psCaption to "#"
80179>>>            End_Object
80180>>>
80180>>>            Object oDEUDA_H_DESCRIPCION1 is a cDbCJGridColumn
80182>>>                Entry_Item DEUDA_D.DESCRIPCION
80183>>>                Set piWidth to 131
80184>>>                Set psCaption to "Descripcion"
80185>>>            End_Object
80186>>>
80186>>>            Object oDEUDA_D_MONTO is a cDbCJGridColumn
80188>>>                Entry_Item DEUDA_D.MONTO
80189>>>                Set piWidth to 93
80190>>>                Set psCaption to "Monto"
80191>>>            End_Object
80192>>>
80192>>>            Object oDEUDA_D_MONTO_PROYECTADO is a cDbCJGridColumn
80194>>>                Entry_Item DEUDA_D.MONTO_PROYECTADO
80195>>>                Set piWidth to 84
80196>>>                Set psCaption to "Proyectado"
80197>>>            End_Object
80198>>>
80198>>>            Object oDEUDA_D_FECHA_REALIZADO is a cDbCJGridColumn
80200>>>                Entry_Item DEUDA_D.FECHA_REALIZADO
80201>>>                Set piWidth to 91
80202>>>                Set psCaption to "F. Realizado"
80203>>>            End_Object
80204>>>
80204>>>            Object oDEUDA_D_PAGADO_SN is a cDbCJGridColumn
80206>>>                Entry_Item DEUDA_D.PAGADO_SN
80207>>>                Set piWidth to 53
80208>>>                Set psCaption to "Pgdo?"
80209>>>                Set pbCheckbox to True
80210>>>            End_Object
80211>>>        End_Object
80212>>>    End_Object
80213>>>
80213>>>Cd_End_Object
80215>>>>
80215>        Set Bitmap of (oClientArea(oMain(Current_object))) to "logo_sid.bmp"
80216>        Set Bitmap_Style to Bitmap_Center
80217>        Use PRESUPUESTO.sl
80217>        Use TARJETA.vw
Including file: TARJETA.vw    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\TARJETA.vw)
80217>>>Use Windows.pkg
80217>>>Use DFClient.pkg
80217>>>Use cDbCJGrid.pkg
80217>>>Use TARJETA.dd
80217>>>Use cPRESUPUESTO_DataDictionary.dd
80217>>>Use cEGRESOSDataDictionary.dd
80217>>>Use cTIPO_GASTO_DataDictionary.dd
80217>>>Use cdbCJGridColumn.pkg
80217>>>Use DFEntry.pkg
80217>>>
80217>>>Deferred_View Activate_TARJETA for ;Object TARJETA is a dbView
80242>>>    Object oTIPO_GASTO_DD is a cTIPO_GASTO_DataDictionary
80244>>>    End_Object
80245>>>
80245>>>    Object oPRESUPUESTO_DD is a cPRESUPUESTODataDictionary
80247>>>    End_Object
80248>>>
80248>>>    Object oEGRESOS_DD is a cEGRESOSDataDictionary
80250>>>        Set DDO_Server to oPRESUPUESTO_DD
80251>>>        
80251>>>        Procedure OnConstrain
80254>>>            Forward Send OnConstrain
80256>>>                Local String @Filtro
80256>>>                Set pbUseDDSQLFilters to True
80257>>>                
80257>>>                Move " TC <> 0 AND FORMA_PAGO = 'TC'" to @Filtro
80258>>>                
80258>>>                Set psSQLFilter to @Filtro
80259>>>        End_Procedure
80260>>>        
80260>>>    End_Object
80261>>>
80261>>>    Object oTARJETA_DD is a TARJETA_DataDictionary
80263>>>    End_Object
80264>>>
80264>>>    Set Main_DD to oTARJETA_DD
80265>>>    Set Server to oTARJETA_DD
80266>>>
80266>>>    Set Border_Style to Border_Thick
80267>>>    Set Size to 217 479
80268>>>    Set Location to 2 2
80269>>>    Set Label to "TARJETA"
80270>>>    Set Color to 16641499
80271>>>
80271>>>    Object oDbContainer3d1 is a dbContainer3d
80273>>>        Set Size to 176 449
80274>>>        Set Location to 12 15
80275>>>
80275>>>        Object oDbGroup1 is a dbGroup
80277>>>            Set Size to 53 414
80278>>>            Set Location to 7 19
80279>>>            Set Label to "Tarjetas de Credito:"
80280>>>
80280>>>            Object oTARJETA_NUMERO is a dbForm
80282>>>                Use TARJETAS.sl
80282>>>                Entry_Item TARJETA.NUMERO
80283>>>                Set Location to 12 34
80284>>>                Set Size to 13 53
80285>>>                Set Label to "#"
80286>>>                Set Label_Justification_Mode to JMode_Right
80287>>>                Set Label_Col_Offset to 2
80288>>>                Set Prompt_Button_Mode to PB_PromptOn
80289>>>                Set Prompt_Object to TARJETAS_SL
80290>>>            End_Object
80291>>>            Object oTARJETA_CLAVE is a dbForm
80293>>>                Entry_Item TARJETA.CLAVE
80294>>>                Set Location to 28 34
80295>>>                Set Size to 13 53
80296>>>                Set Label to "Clave:"
80297>>>                Set Label_Col_Offset to 2
80298>>>                Set Label_Justification_Mode to JMode_Right
80299>>>            End_Object
80300>>>
80300>>>            Object oTARJETA_DESCRIPCION is a dbForm
80302>>>                Entry_Item TARJETA.DESCRIPCION
80303>>>                Set Location to 28 145
80304>>>                Set Size to 13 124
80305>>>                Set Label to "Descripcion:"
80306>>>                Set Label_Col_Offset to 2
80307>>>                Set Label_Justification_Mode to JMode_Right
80308>>>            End_Object
80309>>>
80309>>>            Object oTARJETA_LIMITE is a dbForm
80311>>>                Entry_Item TARJETA.LIMITE
80312>>>                Set Location to 12 145
80313>>>                Set Size to 13 33
80314>>>                Set Label to "Limite TC:"
80315>>>                Set Label_Col_Offset to 2
80316>>>                Set Label_Justification_Mode to JMode_Right
80317>>>            End_Object
80318>>>
80318>>>            Object oTARJETA_LIMITE_MAX is a dbForm
80320>>>                Entry_Item TARJETA.LIMITE_MAX
80321>>>                Set Location to 11 235
80322>>>                Set Size to 13 33
80323>>>                Set Label to "Limite Personal:"
80324>>>                Set Label_Col_Offset to 2
80325>>>                Set Label_Justification_Mode to JMode_Right
80326>>>            End_Object
80327>>>
80327>>>            Object oTARJETA_DIA_PAGO is a dbForm
80329>>>                Entry_Item TARJETA.DIA_PAGO
80330>>>                Set Location to 11 319
80331>>>                Set Size to 13 54
80332>>>                Set Label to "D¡a Pago:"
80333>>>                Set Label_Col_Offset to 2
80334>>>                Set Label_Justification_Mode to JMode_Right
80335>>>            End_Object
80336>>>
80336>>>            Object oTARJETA_DIA_CORTE is a dbForm
80338>>>                Entry_Item TARJETA.DIA_CORTE
80339>>>                Set Location to 28 319
80340>>>                Set Size to 13 54
80341>>>                Set Label to "D¡a Corte:"
80342>>>                Set Label_Col_Offset to 2
80343>>>                Set Label_Justification_Mode to JMode_Right
80344>>>            End_Object
80345>>>        End_Object
80346>>>
80346>>>        Object oDbGroup2 is a dbGroup
80348>>>            Set Size to 104 414
80349>>>            Set Location to 61 18
80350>>>            Set Label to 'Movimientos'
80351>>>
80351>>>            Object oDbCJGrid1 is a cDbCJGrid
80353>>>                Set Server to oEGRESOS_DD
80354>>>                Set Size to 81 397
80355>>>                Set Location to 14 11
80356>>>
80356>>>                Object oEGRESOS_TIPO is a cDbCJGridColumn
80358>>>                    Entry_Item EGRESOS.TIPO
80359>>>                    Set piWidth to 41
80360>>>                    Set psCaption to "Tipo"
80361>>>                End_Object
80362>>>
80362>>>                Object oEGRESOS_DESCRIPCION is a cDbCJGridColumn
80364>>>                    Entry_Item EGRESOS.DESCRIPCION
80365>>>                    Set piWidth to 153
80366>>>                    Set psCaption to "Descripcion"
80367>>>                End_Object
80368>>>
80368>>>                Object oEGRESOS_FECHA_REALIZADO is a cDbCJGridColumn
80370>>>                    Entry_Item EGRESOS.FECHA_REALIZADO
80371>>>                    Set piWidth to 83
80372>>>                    Set psCaption to "F.Realizado"
80373>>>                End_Object
80374>>>
80374>>>//                Object oEGRESOS_ES_FIJO_SN is a cDbCJGridColumn
80374>>>//                    Entry_Item EGRESOS.ES_FIJO_SN
80374>>>//                    Set piWidth to 38
80374>>>//                    Set psCaption to "Fijo?"
80374>>>//                    Set pbCheckbox to True
80374>>>//                End_Object
80374>>>
80374>>>//                Object oEGRESOS_MONTO is a cDbCJGridColumn
80374>>>//                    Entry_Item EGRESOS.MONTO
80374>>>//                    Set piWidth to 72
80374>>>//                    Set psCaption to "Pagado"
80374>>>//                End_Object
80374>>>
80374>>>                Object oEGRESOS_MONTO is a cDbCJGridColumn
80376>>>                    Entry_Item EGRESOS.MONTO
80377>>>                    Set piWidth to 80
80378>>>                    Set psCaption to "Pagado"
80379>>>                End_Object
80380>>>
80380>>>                Object oEGRESOS_PRESUPUESTO is a cDbCJGridColumn
80382>>>                    Entry_Item PRESUPUESTO.NUMERO
80383>>>                    Set piWidth to 87
80384>>>                    Set psCaption to "Presupuesto"
80385>>>                End_Object
80386>>>
80386>>>//                Object oEGRESOS_PAGADO_SN is a cDbCJGridColumn
80386>>>//                    Entry_Item EGRESOS.PAGADO_SN
80386>>>//                    Set piWidth to 60
80386>>>//                    Set psCaption to "Pgdo?"
80386>>>//                    Set pbCheckbox to True
80386>>>//                End_Object
80386>>>
80386>>>                Object oEGRESOS_LIQUIDAR is a cDbCJGridColumn
80388>>>                    Entry_Item EGRESOS.LIQUIDAR
80389>>>                    Set piWidth to 96
80390>>>                    Set psCaption to "Liquidar"
80391>>>                    Set pbCheckbox to True
80392>>>                End_Object
80393>>>
80393>>>                Object oEGRESOS_LIQUIDADO is a cDbCJGridColumn
80395>>>                    Entry_Item EGRESOS.LIQUIDADO
80396>>>                    Set piWidth to 84
80397>>>                    Set psCaption to "Liquidado"
80398>>>                    Set pbCheckbox to True
80399>>>                End_Object
80400>>>            End_Object
80401>>>        End_Object
80402>>>    End_Object
80403>>>
80403>>>Cd_End_Object
80405>>>>
80405>
80405>        Procedure Activate_About
80408>            Send DoAbout "" "" "" "" ""
80409>        End_Procedure
80410>        
80410>        // VARIABLES GLOBALES / PROPERTIES
80410>        
80410>        Property String psFiltro ''
80412>        Property String psOpcionPago ''
80414>        Property Integer piOpcionVista 0
80416>
80416>    End_Object
80417>
80417>End_Object
80418>
80418>
80418>Send Activate_Egresos to (oClientArea(oMain(Current_object)))
80419>
80419>Start_UI
80420>
Summary
Memory Available: 39239680
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 45148
Total Resources: 0
Total Commands : 80419
Total Windows  : 1
Total Pages    : 1
Static Data    : 489833
Message area   : 561419
Total Blocks   : 28733
