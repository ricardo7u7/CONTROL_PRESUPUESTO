Compiling Program: C:\DataFlex Projects\PRESUPUESTO18\AppSrc\Registros.src
Memory Available: 2147483647
1>Use DFAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 18.2\Pkg\dfallent.pkd)
75339>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardCommandBarSystem.pkg)
75339>>>// these are all the packages used in a standard MDI menubar/toolbar system
75339>>>
75339>>>Use cCJCommandBarSystem.pkg
75339>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJStandardMenuItemClasses.pkg)
75339>>>>>Use Dfpanel.pkg
75339>>>>>Use cCJCommandBarSystem.pkg
75339>>>>>Use LanguageText.pkg
75339>>>>>
75339>>>>>
75339>>>>>Class cCJUndoMenuItem is a cCJMenuItem
75340>>>>>    
75340>>>>>    Procedure Construct_Object
75342>>>>>        Forward Send Construct_Object
75344>>>>>        Set psCaption   to C_$CaptionUndo
75345>>>>>        Set psToolTip to C_$ToolTipUndo
75346>>>>>        Set psDescription to C_$DescUndo
75347>>>>>        Set psImage to "ActionUndo.ico"
75348>>>>>        Set pbActiveUpdate to True
75349>>>>>        Set psCategory to C_$CategoryEdit
75350>>>>>        Set psShortcut to C_$Key_Ctrl_Z
75351>>>>>    End_Procedure
75352>>>>>
75352>>>>>    Procedure OnExecute Variant vCommandBarControl
75354>>>>>        Send Undo of (focus(Self))
75355>>>>>    End_Procedure
75356>>>>>    
75356>>>>>    Function IsEnabled Returns Boolean
75358>>>>>        Boolean bEnabled
75358>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
75359>>>>>        Function_Return bEnabled
75360>>>>>    End_Function
75361>>>>>         
75361>>>>>End_Class
75362>>>>>
75362>>>>>
75362>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
75363>>>>>    
75363>>>>>    Procedure Construct_Object
75365>>>>>        Forward Send Construct_Object
75367>>>>>        Set psCaption   to C_$CaptionDelete
75368>>>>>        Set psToolTip to C_$ToolTipDelete
75369>>>>>        Set psDescription to C_$DescDelete
75370>>>>>        Set psImage to "actionDelete.ico"
75371>>>>>        Set psShortcut to C_$Key_Delete
75372>>>>>        Set pbActiveUpdate to True
75373>>>>>        Set psCategory to C_$CategoryEdit
75374>>>>>    End_Procedure
75375>>>>>
75375>>>>>
75375>>>>>    Procedure OnExecute Variant vCommandBarControl
75377>>>>>        Send Delete of (focus(Self))
75378>>>>>    End_Procedure
75379>>>>>    
75379>>>>>    Function IsEnabled Returns Boolean
75381>>>>>        Boolean bEnabled
75381>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
75382>>>>>        Function_Return bEnabled
75383>>>>>    End_Function
75384>>>>>         
75384>>>>>End_Class
75385>>>>>
75385>>>>>
75385>>>>>Class cCJCutMenuItem is a cCJMenuItem
75386>>>>>    
75386>>>>>    Procedure Construct_Object
75388>>>>>        Forward Send Construct_Object
75390>>>>>        Set psCaption   to C_$CaptionCut
75391>>>>>        Set psToolTip to C_$TooltipCut
75392>>>>>        Set psDescription to C_$DescCut
75393>>>>>        Set psImage to "actionCut.ico"
75394>>>>>        Set psShortcut to C_$Key_Ctrl_X
75395>>>>>        Set pbActiveUpdate to True
75396>>>>>        Set psCategory to C_$CategoryEdit
75397>>>>>    End_Procedure
75398>>>>>
75398>>>>>
75398>>>>>    Procedure OnExecute Variant vCommandBarControl
75400>>>>>        Send Cut of (focus(Self))
75401>>>>>    End_Procedure
75402>>>>>    
75402>>>>>    Function IsEnabled Returns Boolean
75404>>>>>        Boolean bEnabled
75404>>>>>        Get CanCut of (Focus(Self)) to bEnabled
75405>>>>>        Function_Return bEnabled
75406>>>>>    End_Function
75407>>>>>         
75407>>>>>End_Class
75408>>>>>
75408>>>>>
75408>>>>>Class cCJCopyMenuItem is a cCJMenuItem
75409>>>>>    
75409>>>>>    Procedure Construct_Object
75411>>>>>        Forward Send Construct_Object
75413>>>>>        Set psCaption   to C_$CaptionCopy
75414>>>>>        Set psToolTip to C_$ToolTipCopy
75415>>>>>        Set psDescription to C_$DescCopy
75416>>>>>        Set psImage to "actionCopy.ico"
75417>>>>>        Set psShortcut to C_$Key_Ctrl_C
75418>>>>>        Set pbActiveUpdate to True
75419>>>>>        Set psCategory to C_$CategoryEdit
75420>>>>>    End_Procedure
75421>>>>>
75421>>>>>
75421>>>>>    Procedure OnExecute Variant vCommandBarControl
75423>>>>>        Send Copy of (focus(Self))
75424>>>>>    End_Procedure
75425>>>>>    
75425>>>>>    Function IsEnabled Returns Boolean
75427>>>>>        Boolean bEnabled
75427>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
75428>>>>>        Function_Return bEnabled
75429>>>>>    End_Function
75430>>>>>         
75430>>>>>End_Class
75431>>>>>
75431>>>>>
75431>>>>>Class cCJPasteMenuItem is a cCJMenuItem
75432>>>>>    
75432>>>>>    Procedure Construct_Object
75434>>>>>        Forward Send Construct_Object
75436>>>>>        Set psCaption   to C_$CaptionPaste
75437>>>>>        Set psToolTip to C_$ToolTipPaste
75438>>>>>        Set psDescription to C_$DescPaste
75439>>>>>        Set psImage to "actionPaste.ico"
75440>>>>>        Set pbActiveUpdate to True
75441>>>>>        Set psShortcut to C_$Key_Ctrl_V
75442>>>>>        Set psCategory to C_$CategoryEdit
75443>>>>>    End_Procedure
75444>>>>>
75444>>>>>
75444>>>>>    Procedure OnExecute Variant vCommandBarControl
75446>>>>>        Send Paste of (focus(Self))
75447>>>>>    End_Procedure
75448>>>>>    
75448>>>>>    Function IsEnabled Returns Boolean
75450>>>>>        Boolean bEnabled
75450>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
75451>>>>>        Function_Return bEnabled
75452>>>>>    End_Function
75453>>>>>         
75453>>>>>End_Class
75454>>>>>
75454>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
75455>>>>>    
75455>>>>>    Procedure Construct_Object
75457>>>>>        Forward Send Construct_Object
75459>>>>>        Set psCaption   to C_$CaptionSelectAll
75460>>>>>        Set psToolTip to C_$ToolTipSelectAll
75461>>>>>        Set psDescription to C_$DescSelectAll
75462>>>>>        Set pbActiveUpdate to True
75463>>>>>        Set psShortcut to C_$Key_Ctrl_A
75464>>>>>        Set psCategory to C_$CategoryEdit
75465>>>>>    End_Procedure
75466>>>>>
75466>>>>>
75466>>>>>    Procedure OnExecute Variant vCommandBarControl
75468>>>>>        Send Select_All of (focus(Self))
75469>>>>>    End_Procedure
75470>>>>>    
75470>>>>>    Function IsEnabled Returns Boolean
75472>>>>>        Boolean bEnabled
75472>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
75473>>>>>        Function_Return bEnabled
75474>>>>>    End_Function
75475>>>>>         
75475>>>>>End_Class
75476>>>>>
75476>>>>> 
75476>>>>>Class cCJExitMenuItem is a cCJMenuItem
75477>>>>>
75477>>>>>    Procedure Construct_Object
75479>>>>>        Forward Send Construct_Object
75481>>>>>        Set psCaption to C_$CaptionExit
75482>>>>>        Set psToolTip to C_$ToolTipExit
75483>>>>>        Set psDescription to C_$ToolTipExit
75484>>>>>        Set psShortcut to C_$Key_Alt_F4
75485>>>>>        Set psCategory to C_$CategoryFile
75486>>>>>    End_Procedure
75487>>>>>
75487>>>>>    Procedure OnExecute Variant vCommandBarControl
75489>>>>>        Send Exit_Application of Desktop
75490>>>>>    End_Procedure
75491>>>>>
75491>>>>>End_Class           
75492>>>>>
75492>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
75493>>>>>
75493>>>>>    Procedure Construct_Object
75495>>>>>        Forward Send Construct_Object
75497>>>>>        Set psCaption to C_$CaptionHelp
75498>>>>>        Set psDescription to C_$ToolTipHelp
75499>>>>>        Set psToolTip to C_$DescHelp
75500>>>>>        Set psImage to "ActionHelp.ico"
75501>>>>>        Set psShortcut to "F1"
75502>>>>>        Set psCategory to C_$CategoryHelp
75503>>>>>    End_Procedure
75504>>>>>    
75504>>>>>    Procedure OnExecute Variant vCommandBarControl
75506>>>>>        Send Help of (Focus(Self))
75507>>>>>    End_Procedure
75508>>>>>
75508>>>>>End_Class
75509>>>>>
75509>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
75510>>>>>
75510>>>>>    Procedure Construct_Object
75512>>>>>        Forward Send Construct_Object
75514>>>>>        Set psCaption to C_$CaptionAddStatusbar
75515>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
75516>>>>>        Set psDescription to  C_$DescAddStatusbar
75517>>>>>        Set psCategory to C_$CategoryWindow
75518>>>>>    End_Procedure
75519>>>>>
75519>>>>>    Procedure OnExecute Variant vCommandBarControl
75521>>>>>        Handle hoCommandBars hoClientArea
75521>>>>>        Get CommandBarSystemObject to hoCommandBars
75522>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75523>>>>>        If hoClientArea Begin
75525>>>>>            // the clientarea's parent panel has message
75525>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
75526>>>>>        End
75526>>>>>>
75526>>>>>    End_Procedure
75527>>>>>
75527>>>>>     Function IsChecked Returns Boolean
75529>>>>>        Boolean bOn
75529>>>>>        Handle hoCommandBars hoClientArea
75529>>>>>        Get CommandBarSystemObject to hoCommandBars
75530>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75531>>>>>        If hoClientArea Begin
75533>>>>>            // the clientarea's parent panel has message
75533>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
75534>>>>>        End
75534>>>>>>
75534>>>>>        Function_Return bOn
75535>>>>>     End_Function
75536>>>>>End_Class
75537>>>>>
75537>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
75538>>>>>
75538>>>>>    Procedure Construct_Object
75540>>>>>        Forward Send Construct_Object
75542>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
75543>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
75544>>>>>        Set psDescription to C_$DescAutoArrangeIcons
75545>>>>>        Set psCategory to C_$CategoryWindow
75546>>>>>    End_Procedure
75547>>>>>
75547>>>>>    Procedure OnExecute Variant vCommandBarControl
75549>>>>>        Handle hoCommandBars hoClientArea
75549>>>>>        Get CommandBarSystemObject to hoCommandBars
75550>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75551>>>>>        If hoClientArea Begin
75553>>>>>            // the clientarea's parent panel has message
75553>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
75554>>>>>        End
75554>>>>>>
75554>>>>>    End_Procedure
75555>>>>>    
75555>>>>>     Function IsChecked Returns Boolean
75557>>>>>        Boolean bOn
75557>>>>>        Handle hoCommandBars hoClientArea
75557>>>>>        Get CommandBarSystemObject to hoCommandBars
75558>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75559>>>>>        If hoClientArea Begin
75561>>>>>            // the clientarea's parent panel has message
75561>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
75562>>>>>        End
75562>>>>>>
75562>>>>>        Function_Return bOn
75563>>>>>     End_Function
75564>>>>>End_Class
75565>>>>>
75565>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
75566>>>>>
75566>>>>>    Procedure Construct_Object
75568>>>>>        Forward Send Construct_Object
75570>>>>>        Set psCaption to C_$CaptionRestoreMenus
75571>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
75572>>>>>        Set psDescription to C_$DescRestoreMenus
75573>>>>>        Set psCategory to C_$CategoryWindow
75574>>>>>    End_Procedure
75575>>>>>
75575>>>>>    Procedure OnExecute Variant vCommandBarControl
75577>>>>>        Handle hoCommandBars
75577>>>>>        Get CommandBarSystemObject to hoCommandBars
75578>>>>>        Send RestoreLayout of hoCommandBars
75579>>>>>    End_Procedure
75580>>>>>    
75580>>>>>End_Class
75581>>>>>
75581>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
75582>>>>>
75582>>>>>    Procedure Construct_Object
75584>>>>>        Forward Send Construct_Object
75586>>>>>        Set psCaption to C_$CaptionCascade
75587>>>>>        Set psToolTip to C_$ToolTipCascade
75588>>>>>        Set psDescription to  C_$DescCascade
75589>>>>>        Set psImage to "ActionCascade.ico"
75590>>>>>        Set psCategory to C_$CategoryWindow
75591>>>>>    End_Procedure
75592>>>>>    
75592>>>>>    Procedure OnExecute Variant vCommandBarControl
75594>>>>>        Handle hoCommandBars hoClientArea
75594>>>>>        Get CommandBarSystemObject to hoCommandBars
75595>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75596>>>>>        If hoClientArea Begin
75598>>>>>            Send Cascade_Windows of hoClientArea
75599>>>>>        End
75599>>>>>>
75599>>>>>    End_Procedure
75600>>>>>End_Class
75601>>>>>
75601>>>>>Class cCJTileHorizontally is a cCJMenuItem
75602>>>>>
75602>>>>>    Procedure Construct_Object
75604>>>>>        Forward Send Construct_Object
75606>>>>>        Set psCaption to C_$CaptionTileHorizontally 
75607>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
75608>>>>>        Set psDescription to  C_$DescTileHorizontally
75609>>>>>        Set psImage to "ActionTileHorizontally.ico"
75610>>>>>        Set psCategory to C_$CategoryWindow
75611>>>>>    End_Procedure
75612>>>>>
75612>>>>>    Procedure OnExecute Variant vCommandBarControl
75614>>>>>        Handle hoCommandBars hoClientArea
75614>>>>>        Get CommandBarSystemObject to hoCommandBars
75615>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75616>>>>>        If hoClientArea Begin
75618>>>>>            Send Tile_Windows_Horizontal of hoClientArea
75619>>>>>        End
75619>>>>>>
75619>>>>>    End_Procedure
75620>>>>>End_Class
75621>>>>>
75621>>>>>Class cCJTileVertically is a cCJMenuItem
75622>>>>>
75622>>>>>    Procedure Construct_Object
75624>>>>>        Forward Send Construct_Object
75626>>>>>        Set psCaption to C_$CaptionTileVertically  
75627>>>>>        Set psToolTip to C_$ToolTipTileVertically
75628>>>>>        Set psDescription to  C_$DescTileVertically
75629>>>>>        Set psImage to "ActionTileVertically.ico"
75630>>>>>        Set psCategory to C_$CategoryWindow
75631>>>>>    End_Procedure
75632>>>>>
75632>>>>>    Procedure OnExecute Variant vCommandBarControl
75634>>>>>        Handle hoCommandBars hoClientArea
75634>>>>>        Get CommandBarSystemObject to hoCommandBars
75635>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75636>>>>>        If hoClientArea Begin
75638>>>>>            Send Tile_Windows_Vertical of hoClientArea
75639>>>>>        End
75639>>>>>>
75639>>>>>    End_Procedure
75640>>>>>End_Class
75641>>>>>
75641>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
75642>>>>>
75642>>>>>    Procedure Construct_Object
75644>>>>>        Forward Send Construct_Object
75646>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
75647>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
75648>>>>>        Set psDescription to  C_$DescMinimizeWindows
75649>>>>>        Set psCategory to C_$CategoryWindow
75650>>>>>    End_Procedure
75651>>>>>
75651>>>>>    Procedure OnExecute Variant vCommandBarControl
75653>>>>>        Handle hoCommandBars hoClientArea
75653>>>>>        Get CommandBarSystemObject to hoCommandBars
75654>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75655>>>>>        If hoClientArea Begin
75657>>>>>            // the clientarea's parent panel has message
75657>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
75658>>>>>        End
75658>>>>>>
75658>>>>>    End_Procedure
75659>>>>>End_Class
75660>>>>>
75660>>>>>
75660>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
75661>>>>>
75661>>>>>    Procedure Construct_Object
75663>>>>>        Forward Send Construct_Object
75665>>>>>        Set psCaption to C_$CaptionRestoreWindows
75666>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
75667>>>>>        Set psDescription to  C_$DescRestoreWindows
75668>>>>>        Set psCategory to C_$CategoryWindow
75669>>>>>    End_Procedure
75670>>>>>
75670>>>>>    Procedure OnExecute Variant vCommandBarControl
75672>>>>>        Handle hoCommandBars hoClientArea
75672>>>>>        Get CommandBarSystemObject to hoCommandBars
75673>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75674>>>>>        If hoClientArea Begin
75676>>>>>            // the clientarea's parent panel has message
75676>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
75677>>>>>        End
75677>>>>>>
75677>>>>>    End_Procedure
75678>>>>>End_Class
75679>>>>>
75679>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
75680>>>>>
75680>>>>>    Procedure Construct_Object
75682>>>>>        Forward Send Construct_Object
75684>>>>>        Set psCaption to C_$CaptionArrangeIcons  
75685>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
75686>>>>>        Set psDescription to  C_$DescArrangeIcons
75687>>>>>        Set psCategory to C_$CategoryWindow
75688>>>>>    End_Procedure
75689>>>>>
75689>>>>>    Procedure OnExecute Variant vCommandBarControl
75691>>>>>        Handle hoCommandBars hoClientArea
75691>>>>>        Get CommandBarSystemObject to hoCommandBars
75692>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75693>>>>>        If hoClientArea Begin
75695>>>>>            Send Arrange_Icons of hoClientArea
75696>>>>>        End
75696>>>>>>
75696>>>>>    End_Procedure
75697>>>>>
75697>>>>>End_Class
75698>>>>>    
75698>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJAboutMenuItem.pkg)
75698>>>>>Use cCJCommandBarSystem.pkg
75698>>>>>Use LanguageText.pkg
75698>>>>>
75698>>>>>// It is expected that if you use this class that you provide an about object that is
75698>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
75698>>>>>// because you may wish to create your own custom about package.
75698>>>>>
75698>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
75699>>>>>
75699>>>>>    Procedure Construct_Object
75701>>>>>        Forward Send Construct_Object
75703>>>>>        Set psCaption to C_$CaptionAbout
75704>>>>>        Set psDescription to C_$ToolTipAbout
75705>>>>>        Set psToolTip to C_$DescAbout
75706>>>>>        Set psImage to "ActionAbout.ico"
75707>>>>>        Set psCategory to C_$CategoryHelp
75708>>>>>    End_Procedure
75709>>>>>    
75709>>>>>    Procedure OnExecute Variant vCommandBarControl
75711>>>>>        Handle hoCommandBars hoClientArea
75711>>>>>        Get CommandBarSystemObject to hoCommandBars
75712>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75713>>>>>        If hoClientArea Begin
75715>>>>>            Send Activate_About of hoClientArea
75716>>>>>        End
75716>>>>>>
75716>>>>>    End_Procedure
75717>>>>>
75717>>>>>End_Class
75718>>>>>
75718>>>>>
75718>>>Use cCJDeoMenuItemClasses.pkg
75718>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cCJMDIWindowsMenuItem.pkg)
75718>>>>>Use cCJCommandBarSystem.pkg
75718>>>>>
75718>>>>>Register_Function Client_ID Returns Integer
75718>>>>>
75718>>>>>// only used by cCJMDIWIndowsMenuItem
75718>>>>>Class cCJMDIWindowItem is a cCJMenuItem
75719>>>>>
75719>>>>>    Procedure Construct_Object
75721>>>>>        Forward Send Construct_Object
75723>>>>>        Property Handle phWindow 0 // object id of view
75724>>>>>        Set pbControlFlagNoMovable to True
75725>>>>>        Set pbActiveUpdate to True
75726>>>>>    End_Procedure
75727>>>>>    
75727>>>>>    Procedure OnExecute Variant vCommandBarControl
75729>>>>>        Handle hWindow
75729>>>>>        Get phWindow to hWindow
75730>>>>>        Send Activate_View of hWindow
75731>>>>>    End_Procedure
75732>>>>>    
75732>>>>>End_Class                
75733>>>>>
75733>>>>>
75733>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
75734>>>>>    
75734>>>>>    Procedure Construct_Object
75736>>>>>        Forward Send Construct_Object
75738>>>>>        Property Handle[] phArrayOfWindows
75739>>>>>        Set peControlType to xtpControlPopup
75740>>>>>        Set psCategory to C_$CategoryWindow
75741>>>>>    End_Procedure
75742>>>>>    
75742>>>>>     // This adds MDI windows to the existing menu items.
75742>>>>>     // This removes any existing windows menus and always adds a new set to the end
75742>>>>>
75742>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
75744>>>>>        Handle  hClientArea hView
75744>>>>>        String  sLabel
75744>>>>>        Integer i iWindows
75744>>>>>        Handle[] hArrayOfWindows
75745>>>>>        Variant vItem
75745>>>>>        
75745>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
75745>>>>>        // also assume that destroying an action removes all menu instances of that action
75745>>>>>        Get phArrayOfWindows to hArrayOfWindows
75746>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
75747>>>>>        For i from 0 to (iWindows-1)
75753>>>>>>
75753>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
75754>>>>>        Loop
75755>>>>>>
75755>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
75756>>>>>
75756>>>>>        // Add all views to this menu. Create the action and add the item
75756>>>>>        Move 0 to i
75757>>>>>        Get Client_Id to hClientArea // object id of client area
75758>>>>>        If (hClientArea > 0) Begin
75760>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
75761>>>>>            While (hView <> 0)
75765>>>>>                If (Active_State(hView)) Begin
75767>>>>>                    // create the action
75767>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
75768>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
75769>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
75770>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
75771>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
75773>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
75774>>>>>                    End
75774>>>>>>
75774>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
75775>>>>>                    If (i=0) Begin
75777>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
75778>>>>>                    End
75778>>>>>>
75778>>>>>                    // Create a menu item for this action
75778>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
75779>>>>>                    Increment i
75780>>>>>                End
75780>>>>>>
75780>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
75781>>>>>            Loop
75782>>>>>>
75782>>>>>        End
75782>>>>>>
75782>>>>>
75782>>>>>        Set phArrayOfWindows to hArrayOfWindows
75783>>>>>
75783>>>>>     End_Procedure
75784>>>>>     
75784>>>>>End_Class
75785>>>>>
75785>
75785>Object oHtmlHelp is a cHtmlHelp
75787>End_Object
75788>
75788>Object oApplication is a cApplication
75790>    Set peHelpType to htHtmlHelp
75791>End_Object
75792>
75792>Object oToolTipController is a cToolTipController
75794>    Move Self to ghoToolTipController
75795>End_Object
75796>
75796>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oEditContextMenu.pkg)
75796>>>Use cCJStandardMenuItemClasses.pkg
75796>>>
75796>>>Object oEditContextMenu is a cCJContextMenu
75798>>>    
75798>>>    Move Self to Default_Form_Floating_Menu_ID
75799>>>    
75799>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75801>>>    End_Object
75802>>>    
75802>>>    Object oCutMenuItem is a cCJCutMenuItem
75804>>>        Set pbControlBeginGroup to True
75805>>>    End_Object
75806>>>    
75806>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75808>>>    End_Object
75809>>>
75809>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75811>>>    End_Object
75812>>>
75812>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75814>>>    End_Object
75815>>>
75815>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75817>>>        Set pbControlBeginGroup to True
75818>>>    End_Object
75819>>>
75819>>>End_Object
75820>>>
75820>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\oDEOEditContextMenu17.pkg)
75820>>>Use Windows.pkg
75820>>>Use cCJStandardMenuItemClasses.pkg
75820>>>Use cCJDeoMenuItemClasses.pkg
75820>>>
75820>>>
75820>>>Object oDEOEditContextMenu17 is a cCJContextMenu
75822>>>    
75822>>>    Move Self to Default_dbFloating_Menu_ID
75823>>>    
75823>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75825>>>    End_Object
75826>>>    
75826>>>    Object oCutMenuItem is a cCJCutMenuItem
75828>>>        Set pbControlBeginGroup to True
75829>>>    End_Object
75830>>>    
75830>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75832>>>    End_Object
75833>>>
75833>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75835>>>    End_Object
75836>>>
75836>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75838>>>    End_Object
75839>>>
75839>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75841>>>        Set pbControlBeginGroup to True
75842>>>    End_Object
75843>>>
75843>>>    Object oPromptMenuItem is a cCJPromptMenuItem
75845>>>        Set pbControlBeginGroup to True
75846>>>    End_Object
75847>>>
75847>>>    Object oFindNextMenu is a cCJFindNextMenuItem
75849>>>        Set pbControlBeginGroup to True
75850>>>    End_Object
75851>>>
75851>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75853>>>    End_Object
75854>>>
75854>>>    Object oClearMenuItem is a cCJClearMenuItem
75856>>>        Set pbControlBeginGroup to True
75857>>>    End_Object
75858>>>
75858>>>    Object oClearAllMenu is a cCJClearAllMenuItem
75860>>>    End_Object
75861>>>
75861>>>    Object oSaveMenu is a cCJSaveMenuItem
75863>>>    End_Object
75864>>>    
75864>>>    Object oDeleteMenu is a cCJDeleteMenuItem
75866>>>    End_Object
75867>>>
75867>>>    Object oRememberitem is a cCJRememberFieldMenuItem
75869>>>        Set pbControlBeginGroup to True
75870>>>    End_Object
75871>>>
75871>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
75873>>>    End_Object
75874>>>
75874>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
75876>>>    End_Object
75877>>>
75877>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
75879>>>    End_Object
75880>>>
75880>>>End_Object
75881>
75881>Object oMain is a Panel
75883>    Set Label to "CUBE Systems"
75884>    Set Location to 4 3
75885>    Set Size to 300 450
75886>       
75886>//FUNCIONES GLOBALES
75886>Function fSQL_date Global Date d_Fecha Returns String
75888>    Local String  s_Fecha
75888>    Local Integer i_Formato
75888>
75888>    Get_date_format to i_formato
75889>
75889>    Move "'" to s_Fecha
75890>    //Move "" to s_Fecha
75890>
75890>    If i_Formato eq 0 Begin  // Fecha formato USA mes/dia/año
75892>        Append s_Fecha (Mid(d_Fecha,4,7))
75893>        Append s_Fecha (Mid(d_Fecha,2,1))
75894>        Append s_Fecha (Mid(d_Fecha,2,4))
75895>    End
75895>    If i_formato eq 1 Begin  // Fecha formato europeo dia/mes/año
75897>        Append s_Fecha (Mid(d_Fecha,4,7))
75898>        Append s_Fecha (Mid(d_Fecha,2,4))
75899>        Append s_Fecha (Mid(d_Fecha,2,1))
75900>    End
75900>    If i_formato eq 2 Begin  // Fecha formato militar año/mes/dia
75902>        Append s_Fecha (Mid(d_Fecha,4,1))
75903>        Append s_Fecha (Mid(d_Fecha,2,6))
75904>        Append s_Fecha (Mid(d_Fecha,2,9))
75905>    End
75905>
75905>    Append s_Fecha "'"
75906>    Function_Return s_Fecha
75907>End_Function
75908>
75908>
75908>
75908>    DFCreate_Menu Main_Menu
75911>    //        #INCLUDE File_PM_Espanol.inc
75911>    
75911>        DFCreate_Menu "&Opciones" ViewPopupMenu is a ViewPopupMenu
75915>            On_Item "Catalogo Egresos"                   Send Activate_TIPO_GASTO
75916>            On_Item "Catalogo Tarjetas de Cr‚dito"       Send Activate_TARJETA
75917>            On_Item "TARJETA" Send Activate_TARJETA
75918>            On_Item "movimientos" Send Activate_movimientos
75919>        End_Pull_Down
75921>            
75921>        DFCreate_Menu "&Opciones" ViewPopupMenu1 is a ViewPopupMenu
75925>            On_Item "Control Ahorros"                    Send Activate_AHORRO
75926>            On_Item "Control Egresos"                    Send Activate_Egresos
75927>            On_Item "Control Deudas"                     Send Activate_Deudas
75928>        End_Pull_Down
75930>        
75930>        DFCreate_Menu "&Reportes" ViewPopupMenu2 is a ViewPopupMenu
75934>            On_Item "Grafica de Gastos"                  Send Activate_GASTOS_01
75935>            On_Item "Listado de Gastos"                  Send Activate_GASTOS_02
75936>        End_Pull_Down
75938>        
75938>        Set Status_Help to "Available Views"
75939>    End_Menu
75941>    
75941>    Use DltToolbar.pkg
Including file: DltToolbar.pkg    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\DltToolbar.pkg)
75941>>>Use cToolbar.pkg
75941>>>
75941>>>// A toolbar for the Contacts sample.
75941>>>// shows:
75941>>>//    Buttons with text underneath (toolbar's pbShowLabels property set to True, and each button's psLabel property to the text)
75941>>>//    Multiline tooltips (embed "\n" in the psTooltip property to force a newline)
75941>>>//    "Hot" images, using a second imagelist (set the phoImageListHot property)
75941>>>
75941>>>Object oToolBar is a cToolBar
75943>>>    Set pbShowLabels To True // display the psLabel property on th button
75944>>>    Object oImages is a cImageList
75946>>>        Set piMaxImages To 12
75947>>>        Procedure OnCreate
75950>>>            Integer iVoid
75950>>>            Get AddTransparentImage "bgn.bmp"      clLtGray  To iVoid // 0
75951>>>            Get AddTransparentImage "prev.bmp"     clLtGray  To iVoid // 1
75952>>>            Get AddTransparentImage "equal.bmp"    clLtGray  To iVoid // 2
75953>>>            Get AddTransparentImage "next.bmp"     clLtGray  To iVoid // 3
75954>>>            Get AddTransparentImage "end.bmp"      clLtGray  To iVoid // 4
75955>>>            Get AddTransparentImage "Prompt16.bmp" clFuchsia To iVoid // 5
75956>>>            Get AddTransparentImage "clr.bmp"      clLtGray  To iVoid // 6
75957>>>            Get AddTransparentImage "clra.bmp"     clLtGray  To iVoid // 7
75958>>>            Get AddTransparentImage "Save16.bmp"   clFuchsia To iVoid // 8
75959>>>            Get AddTransparentImage "Delete16.bmp" clFuchsia To iVoid // 9
75960>>>            Get AddTransparentImage "Cut16.bmp"    clFuchsia To iVoid // 10
75961>>>            Get AddTransparentImage "Copy16.bmp"   clFuchsia To iVoid // 11
75962>>>            Get AddTransparentImage "Paste16.bmp"  clFuchsia To iVoid // 12
75963>>>        End_Procedure
75964>>>    End_Object
75965>>>    
75965>>>    Object oImagesHot is a cImageList
75967>>>        // These images are shown when the mouse cursor hovers over the button
75967>>>        // There must be a matching number of images in all imagelists.
75967>>>        Set piMaxImages To 12
75968>>>        Procedure OnCreate
75971>>>            Integer iVoid
75971>>>            Get AddTransparentImage "BgnHot.bmp"   clLtGray  To iVoid // 0
75972>>>            Get AddTransparentImage "PrevHot.bmp"  clLtGray  To iVoid // 1
75973>>>            Get AddTransparentImage "EqualHot.bmp" clLtGray  To iVoid // 2
75974>>>            Get AddTransparentImage "NextHot.bmp"  clLtGray  To iVoid // 3
75975>>>            Get AddTransparentImage "EndHot.bmp"   clLtGray  To iVoid // 4
75976>>>            Get AddTransparentImage "Prompt16.bmp" clFuchsia To iVoid // 5
75977>>>            Get AddTransparentImage "clr.bmp"      clLtGray  To iVoid // 6
75978>>>            Get AddTransparentImage "clra.bmp"     clLtGray  To iVoid // 7
75979>>>            Get AddTransparentImage "Save16.bmp"   clFuchsia To iVoid // 8
75980>>>            Get AddTransparentImage "Delete16.bmp" clFuchsia To iVoid // 9
75981>>>            Get AddTransparentImage "Cut16.bmp"    clFuchsia To iVoid // 10
75982>>>            Get AddTransparentImage "Copy16.bmp"   clFuchsia To iVoid // 11
75983>>>            Get AddTransparentImage "Paste16.bmp"  clFuchsia To iVoid // 12
75984>>>        End_Procedure
75985>>>    End_Object
75986>>>
75986>>>    Set phoImageList    To (oImages(self))
75987>>>    Set phoImageListHot To (oImagesHot(self))
75988>>>    
75988>>>    Object oFirst is a cToolbarButton
75990>>>        Set psLabel to "Primero"
75991>>>        Set psTooltip to 'Encontrar Primero (Ctrl+Home)'
75992>>>        Set psStatusHelp To 'Find the First record (Ctrl+Home)'
75993>>>        Set piImage To 0
75994>>>        Procedure OnClick
75997>>>            Send DoSendToDeoFocus msg_Find_First
75998>>>        End_Procedure
75999>>>    End_Object
76000>>>
76000>>>    Object oPrevious is a cToolbarButton
76002>>>        Set psLabel to "Anterior"
76003>>>        Set psTooltip to 'Encontrar Anterior (F7)'
76004>>>        Set psStatusHelp To 'Find the Previous record (F7)'
76005>>>        Set piImage To 1
76006>>>        Procedure OnClick
76009>>>            Send DoSendToDeoFocus msg_find_previous
76010>>>        End_Procedure
76011>>>    End_Object
76012>>>
76012>>>    Object oGreaterEqual is a cToolbarButton
76014>>>        Set psLabel to "Igual"
76015>>>        Set psTooltip to 'Encontrar Mayor/Igual (F9)'
76016>>>        Set psStatusHelp To 'Find a record (F9)'
76017>>>        Set piImage To 2
76018>>>        Procedure OnClick
76021>>>            Send DoSendToDeoFocus msg_find_ge
76022>>>        End_Procedure
76023>>>    End_Object
76024>>>
76024>>>    Object oNext is a cToolbarButton
76026>>>        Set psLabel to "Siguiente"
76027>>>        Set psTooltip to 'Encontrar Siguiente (F8)'
76028>>>        Set psStatusHelp To 'Find the Next record (F8)'
76029>>>        Set piImage To 3
76030>>>        Procedure OnClick
76033>>>            Send DoSendToDeoFocus msg_find_next
76034>>>        End_Procedure
76035>>>    End_Object
76036>>>
76036>>>    Object oLast is a cToolbarButton
76038>>>        Set psLabel to "éltimo"
76039>>>        Set psTooltip to 'Encontrar éltimo (Ctrl+End)'
76040>>>        Set psStatusHelp To 'Find the Last record (Ctrl+End)'
76041>>>        Set piImage To 4
76042>>>        Procedure OnClick
76045>>>            Send DoSendToDeoFocus msg_end_of_data
76046>>>        End_Procedure
76047>>>    End_Object
76048>>>
76048>>>    Object oSeparator is a cToolbarButton
76050>>>        Set peStyle To bsSeparator
76051>>>    End_Object
76052>>>
76052>>>    Object oPrompt is a cToolbarButton
76054>>>        Set psLabel to "Buscar"
76055>>>        Set psTooltip to 'Buscar (F4)'
76056>>>        Set psStatusHelp To 'Show available selections (F4)'
76057>>>        Set piImage To 5
76058>>>        Procedure OnClick
76061>>>            Send DoSendToDeoFocus msg_prompt
76062>>>        End_Procedure
76063>>>    End_Object
76064>>>
76064>>>    Object oClear is a cToolbarButton
76066>>>        Set psLabel to "Limpiar"
76067>>>        Set psTooltip to 'Limpiar (F5)'
76068>>>        Set psStatusHelp To 'Clear current record / Add a new record (F5)'
76069>>>        Set piImage To 6
76070>>>        Procedure OnClick
76073>>>            Send DoSendToDeoFocus msg_request_clear
76074>>>        End_Procedure
76075>>>    End_Object
76076>>>
76076>>>    Object oClearAll is a cToolbarButton
76078>>>        Set psLabel to "Limpiar Todo"
76079>>>        Set psTooltip to 'Limpiar Todo (Ctrl+F5)'
76080>>>        Set psStatusHelp To 'Clear all data from view (Ctrl+F5)'
76081>>>        Set piImage To 7
76082>>>        Procedure OnClick
76085>>>            Send DoSendToDeoFocus msg_request_clear_all
76086>>>        End_Procedure
76087>>>    End_Object
76088>>>
76088>>>    Object oSeparator is a cToolbarButton
76090>>>        Set peStyle To bsSeparator
76091>>>    End_Object
76092>>>
76092>>>    Object oSave is a cToolbarButton
76094>>>        Set psLabel to "Grabar"
76095>>>        Set psTooltip to 'Grabar (F2)'
76096>>>        Set psStatusHelp To 'Save the current record (F2)'
76097>>>        Set piImage To 8
76098>>>        Procedure OnClick
76101>>>            Send DoSendToDeoFocus msg_request_save
76102>>>        End_Procedure
76103>>>    End_Object
76104>>>
76104>>>    Object oDelete is a cToolbarButton
76106>>>        Set psLabel to "Eliminar"
76107>>>        Set psTooltip to 'Eliminar (Shift+F2)'
76108>>>        Set psStatusHelp To 'Delete the current record (Shift+F2)'
76109>>>        Set piImage To 9
76110>>>        Procedure OnClick
76113>>>            Send DoSendToDeoFocus msg_request_delete
76114>>>        End_Procedure
76115>>>    End_Object
76116>>>
76116>>>    Object oSeparator is a cToolbarButton
76118>>>        Set peStyle To bsSeparator
76119>>>    End_Object
76120>>>
76120>>>    Object oCut is a cToolbarButton
76122>>>        Set psLabel to "Cortar"
76123>>>        Set psTooltip to 'Cortar (Ctrl+X)'
76124>>>        Set psStatusHelp To 'Cuts the selection and puts it on the Clipboard (Ctrl+X)'
76125>>>        Set piImage To 10
76126>>>        Procedure OnClick
76129>>>            Send DoSendToDeoFocus msg_cut
76130>>>        End_Procedure
76131>>>    End_Object
76132>>>
76132>>>    Object oCopy is a cToolbarButton
76134>>>        Set psLabel to "Copiar"
76135>>>        Set psTooltip to 'Copiar (Ctrl+C)'
76136>>>        Set psStatusHelp To 'Copies the selection and puts it on the Clipboard (Ctrl+C)'
76137>>>        Set piImage To 11
76138>>>        Procedure OnClick
76141>>>            Send DoSendToDeoFocus msg_copy
76142>>>        End_Procedure
76143>>>    End_Object
76144>>>
76144>>>    Object oPaste is a cToolbarButton
76146>>>        Set psLabel to "Pegar"
76147>>>        Set psTooltip to 'Pegar (Ctrl+V)'
76148>>>        Set psStatusHelp To 'Inserts Clipboard contents (Ctrl+V)'
76149>>>        Set piImage To 12
76150>>>        Procedure OnClick
76153>>>            Send DoSendToDeoFocus msg_paste
76154>>>        End_Procedure
76155>>>    End_Object
76156>>>
76156>>>End_Object // oMainToolbar
76157>>>
76157>
76157>    Object oClientArea is a AppClientArea
76159>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\StdAbout.pkg)
76159>>>//************************************************************************
76159>>>// Confidential Trade Secret.
76159>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76159>>>// as an unpublished work.  All rights reserved.
76159>>>// DataFlex is a registered trademark of Data Access Corporation.
76159>>>//
76159>>>//************************************************************************
76159>>>//************************************************************************
76159>>>//
76159>>>// $File name  : StdAbout.pkg
76159>>>// $File title : Standard about object package for VDF
76159>>>// Notice      :
76159>>>// $Author(s)  : John Tuohy
76159>>>//
76159>>>// $Rev History
76159>>>//
76159>>>// JT 06/27/97   File created
76159>>>//************************************************************************
76159>>>
76159>>>// This provides a quick and simple way to create an about package for a program.
76159>>>// You need to create a message inside you client area called Activate_About.
76159>>>// Within this message you should send the message DoAbout passing needed
76159>>>// string information.
76159>>>//
76159>>>//       Procedure Activate_About
76159>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
76159>>>//       End_Procedure
76159>>>//    where: sTitle =     Name of application. If none provided, uses caption
76159>>>//                        bar title
76159>>>//           sVersion   = Version Line. If none provided, will be blank
76159>>>//           sCopyRight = Copyright Line. If none provided, will be blank
76159>>>//           sAuthor    = Author name, blank if none provided
76159>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
76159>>>//                        is used.
76159>>>// It is expected that you will place this in your own object package. For
76159>>>// example an order about package may look like this:
76159>>>//
76159>>>//   // OrderAbout.pkg
76159>>>//   Use StdAbout.pkg
76159>>>//   Procedure Activate_About
76159>>>//      String sTitle sCopyright sVersion sAuthor
76159>>>//      Move "My Order Entry System" to sTitle
76159>>>//      Move "Version 2.1" to sVersion
76159>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
76159>>>//      Move "John Smith"  to sAuthor
76159>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
76159>>>//   end_procedure
76159>>>//   // end of file.
76159>>>
76159>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\Dfabout.pkg)
76159>>>>>//************************************************************************
76159>>>>>// Confidential Trade Secret.
76159>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
76159>>>>>// as an unpublished work.  All rights reserved.
76159>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
76159>>>>>//
76159>>>>>//************************************************************************
76159>>>>>//************************************************************************
76159>>>>>//
76159>>>>>// $File name  : DfAbout.pkg
76159>>>>>// $File title : About class support
76159>>>>>// Notice      :
76159>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
76159>>>>>//
76159>>>>>// $Rev History
76159>>>>>//
76159>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
76159>>>>>//                Windows for the size first. 
76159>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
76159>>>>>//                with anchor technique. Removed unnessary property in the
76159>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
76159>>>>>//                object To better look in Windows XP. Repositioned the close
76159>>>>>//                button in the sysinfo dialog To line up with the display area
76159>>>>>//                Replaced obsolete code and techniques. Removed dead code.
76159>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
76159>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
76159>>>>>//                the global Workspace object, if it is present
76159>>>>>// JJT 11/05/98   Added version information
76159>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
76159>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
76159>>>>>//                workspace package.
76159>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
76159>>>>>//                class can create this object.
76159>>>>>//                Cleaned up the interface (used correct classes and messages)
76159>>>>>//                Added workspace reporting support To sys-info.
76159>>>>>//                Turned off wrapping in the sys-info editor.
76159>>>>>// KR  ??/??/96   File created
76159>>>>>//************************************************************************
76159>>>>>Use LanguageText.pkg
76159>>>>>Use Windows.pkg
76159>>>>>Use DFbitmap.pkg
76159>>>>>Use GlobalFunctionsProcedures.pkg
76159>>>>>Use cTextEdit.pkg
76159>>>>>
76159>>>>>Use cli.pkg
Including file: cli.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\cli.pkg)
76159>>>>>>>//*****************************************************************************
76159>>>>>>>//*** CLI.PKG                                                               ***
76159>>>>>>>//***                                                                       ***
76159>>>>>>>//*** Author: Ben Weijers                                                   ***
76159>>>>>>>//***         Data Access Nederland                                         ***
76159>>>>>>>//***         10 September 1998                                             ***
76159>>>>>>>//***                                                                       ***
76159>>>>>>>//*** Purpose:                                                              ***
76159>>>>>>>//***   CLI specific functionality. There are several connectivity kits     ***
76159>>>>>>>//***   based on  SQL/92 CLI. Those are:                                    ***
76159>>>>>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
76159>>>>>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
76159>>>>>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
76159>>>>>>>//***                                                                       ***
76159>>>>>>>//***   This package defines the common functionality for all CLI based     ***
76159>>>>>>>//***   drivers.                                                            ***
76159>>>>>>>//***                                                                       ***
76159>>>>>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
76159>>>>>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
76159>>>>>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
76159>>>>>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
76159>>>>>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
76159>>>>>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
76159>>>>>>>//***             Added SQLSERVER2012CLIENT return value for                ***
76159>>>>>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
76159>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
76159>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
76159>>>>>>>//***             mssqldrv.pkg                                              ***
76159>>>>>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
76159>>>>>>>//***             Added type mappings attributes                            ***
76159>>>>>>>//***   Updated:  october 11, 2013 (Current CK build: 6.0.0.18)             ***
76159>>>>>>>//***             Added DF_FILE_SQL_FILTER_EQ attribute                     ***
76159>>>>>>>//*****************************************************************************
76159>>>>>>>
76159>>>>>>>//*** We are not using ifndef below because that is not supported in Character Mode
76159>>>>>>>//*** Driver attributes
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>//------------------------------------------------------------
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>//-------------------------------------
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>//*** Replacement for logical column number that indicates all columns
76159>>>>>>>
76159>>>>>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
76159>>>>>>>
76159>>>>>>>//*** Possible DF_FIELD_READ_ONLY values
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
76159>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
76159>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>// Moved to Mssqldrv.pkg
76159>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
76159>>>>>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
76159>>>>>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
76159>>>>>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
76159>>>>>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
76159>>>>>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
76159>>>>>>>
76159>>>>>>>//*** Possible SQL Column type values
76159>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
76159>>>>>>>Define SQL_CHAR           For    1
76159>>>>>>>Define SQL_NUMERIC        For    2
76159>>>>>>>Define SQL_DECIMAL        For    3
76159>>>>>>>Define SQL_INTEGER        For    4
76159>>>>>>>Define SQL_SMALLINT       For    5
76159>>>>>>>Define SQL_FLOAT          For    6
76159>>>>>>>Define SQL_REAL           For    7
76159>>>>>>>Define SQL_DOUBLE         For    8
76159>>>>>>>Define SQL_DATETIME       For    9
76159>>>>>>>Define SQL_VARCHAR        For   12
76159>>>>>>>Define SQL_TYPE_DATE      For   91
76159>>>>>>>Define SQL_TYPE_TIME      For   92
76159>>>>>>>Define SQL_TYPE_TIMESTAMP for   93
76159>>>>>>>// Moved to mssqldrv.pkg
76159>>>>>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>Define SQL_DATE           For    9
76159>>>>>>>Define SQL_INTERVAL       For   10
76159>>>>>>>Define SQL_TIME           For   10
76159>>>>>>>Define SQL_TIMESTAMP      For   11
76159>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
76159>>>>>>>Define SQL_BINARY         For  (-2)
76159>>>>>>>Define SQL_VARBINARY      For  (-3)
76159>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
76159>>>>>>>Define SQL_BIGINT         For  (-5)
76159>>>>>>>Define SQL_TINYINT        For  (-6)
76159>>>>>>>Define SQL_BIT            For  (-7)
76159>>>>>>>Define SQL_WCHAR          For  (-8)
76159>>>>>>>Define SQL_WVARCHAR       For  (-9)
76159>>>>>>>Define SQL_WLONGVARCHAR   For (-10)
76159>>>>>>>Define SQL_GUID           For (-11)
76159>>>>>>>
76159>>>>>>>//*** Driver level attributes
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>//*** Error number constants
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>//*** Call driver function identifiers
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>//*** Init data source types
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>//*** Dummy strings used in the commands
76159>>>>>>>    String  CLI$StrDummy 255
76159>>>>>>>    Integer CLI$IntDummy
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>//*****************************************************************************
76159>>>>>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
76159>>>>>>>//***                                                                       ***
76159>>>>>>>//***   Setup a constraint for a file.                                      ***
76159>>>>>>>//*****************************************************************************
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>//*****************************************************************************
76159>>>>>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
76159>>>>>>>//***                                                                       ***
76159>>>>>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
76159>>>>>>>//*** will be set for the remainder of the session or until set again. To   ***
76159>>>>>>>//*** permanently set driver level attributes change the driver             ***
76159>>>>>>>//*** configuration file.                                                   ***
76159>>>>>>>//*****************************************************************************
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>
76159>>>>>>>//*****************************************************************************
76159>>>>>>>//*** Class  : cCLIHandler                                                  ***
76159>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76159>>>>>>>//***          call several CLI releated methods.                           ***
76159>>>>>>>//*****************************************************************************
76159>>>>>>>
76159>>>>>>>Class cCLIHandler Is An Array
76160>>>>>>>
76160>>>>>>>    Procedure Construct_Object Integer iImage
76162>>>>>>>        Forward Send Construct_object iImage
76164>>>>>>>
76164>>>>>>>        Property String  psDriverID       Public ""
76165>>>>>>>    End_Procedure // Construct_Object
76166>>>>>>>
76166>>>>>>>
76166>>>>>>>
76166>>>>>>>    //***
76166>>>>>>>    //*** Fucntion: CKRevsion
76166>>>>>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
76166>>>>>>>    //***
76166>>>>>>>
76166>>>>>>>    Function CKRevision Returns String
76168>>>>>>>        Local String  sDriverID
76168>>>>>>>        Local String  sRevision
76168>>>>>>>        Local String  sVoid
76168>>>>>>>        Local Integer iRetval
76168>>>>>>>
76168>>>>>>>        Get psDriverID To sDriverID
76169>>>>>>>        If (sDRiverID <> "") Begin
76171>>>>>>>            Move (Repeat(" ", 255)) To sRevision
76172>>>>>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76177>>>>>>>        End
76177>>>>>>>>
76177>>>>>>>
76177>>>>>>>        Function_Return sRevision
76178>>>>>>>    End_Function // CKRevision
76179>>>>>>>
76179>>>>>>>
76179>>>>>>>
76179>>>>>>>    //***
76179>>>>>>>    //*** Function: ExtractPartFromRevision
76179>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76179>>>>>>>    //***
76179>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76179>>>>>>>    //***
76179>>>>>>>
76179>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76181>>>>>>>        Local Integer iPartRev
76181>>>>>>>        Local Integer iCurrentPart
76181>>>>>>>        Local Integer iSeparatorPos
76181>>>>>>>
76181>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76184>>>>>>>
76184>>>>>>>        Move 0 To iCurrentPart
76185>>>>>>>        Repeat
76185>>>>>>>>
76185>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76186>>>>>>>            If (iSeparatorPos > 0) Begin
76188>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76189>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76190>>>>>>>                Increment iCurrentPart
76191>>>>>>>            End
76191>>>>>>>>
76191>>>>>>>            Else If (sRevision <> "") Begin
76194>>>>>>>                Move sRevision To iPartRev
76195>>>>>>>                Move "" To sRevision
76196>>>>>>>                Increment iCurrentPart
76197>>>>>>>            End
76197>>>>>>>>
76197>>>>>>>            Else ;                Move -1 To iPartRev
76199>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76201>>>>>>>
76201>>>>>>>        Function_Return iPartRev
76202>>>>>>>    End_Function // EcxtractPartFromRevision
76203>>>>>>>
76203>>>>>>>
76203>>>>>>>
76203>>>>>>>    //***
76203>>>>>>>    //*** Function: CKMajorRevision
76203>>>>>>>    //*** Purpose : Returns the major revision of the CK
76203>>>>>>>    //***
76203>>>>>>>
76203>>>>>>>    Function CKMajorRevision Returns Integer
76205>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76206>>>>>>>    End_Function // CKMajorRevision
76207>>>>>>>
76207>>>>>>>
76207>>>>>>>
76207>>>>>>>    //***
76207>>>>>>>    //*** Function: CKMinorRevision
76207>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76207>>>>>>>    //***
76207>>>>>>>
76207>>>>>>>    Function CKMinorRevision Returns Integer
76209>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76210>>>>>>>    End_Function // CKMinorRevision
76211>>>>>>>
76211>>>>>>>
76211>>>>>>>
76211>>>>>>>    //***
76211>>>>>>>    //*** Function: CKReleaseRevision
76211>>>>>>>    //*** Purpose : Returns the release revision of the CK
76211>>>>>>>    //***
76211>>>>>>>
76211>>>>>>>    Function CKReleaseRevision Returns Integer
76213>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76214>>>>>>>    End_Function // CKReleaseRevision
76215>>>>>>>
76215>>>>>>>
76215>>>>>>>
76215>>>>>>>    //***
76215>>>>>>>    //*** Function: CKBuildRevision
76215>>>>>>>    //*** Purpose : Returns the major revision of the CK
76215>>>>>>>    //***
76215>>>>>>>
76215>>>>>>>    Function CKBuildRevision Returns Integer
76217>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76218>>>>>>>    End_Function // CKBuildRevision
76219>>>>>>>
76219>>>>>>>
76219>>>>>>>
76219>>>>>>>    //***
76219>>>>>>>    //*** Function: IsMinimalRevision
76219>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76219>>>>>>>    //***
76219>>>>>>>
76219>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76221>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76224>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76227>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76230>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76233>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76236>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76240>>>>>>>            End
76240>>>>>>>>
76240>>>>>>>        End
76240>>>>>>>>
76240>>>>>>>
76240>>>>>>>        Function_Return (FALSE)
76241>>>>>>>    End_Function // IsMinimalRevision
76242>>>>>>>
76242>>>>>>>
76242>>>>>>>
76242>>>>>>>    //***
76242>>>>>>>    //*** Function: RegistrationName
76242>>>>>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
76242>>>>>>>    //***
76242>>>>>>>
76242>>>>>>>    Function RegistrationName Returns String
76244>>>>>>>        Local String  sRegistration
76244>>>>>>>        Local String  sDRiverId
76244>>>>>>>        Local String  sVoid
76244>>>>>>>        Local Integer iRetval
76244>>>>>>>
76244>>>>>>>        Get psDriverID To sDriverID
76245>>>>>>>        If (sDRiverID <> "") Begin
76247>>>>>>>            Move (Repeat(" ", 255)) To sRegistration
76248>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
76253>>>>>>>        End
76253>>>>>>>>
76253>>>>>>>
76253>>>>>>>        Function_Return sRegistration
76254>>>>>>>    End_Function // RegistrationName
76255>>>>>>>
76255>>>>>>>
76255>>>>>>>
76255>>>>>>>    //***
76255>>>>>>>    //*** Function: SerialNumber
76255>>>>>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
76255>>>>>>>    //***
76255>>>>>>>
76255>>>>>>>    Function SerialNumber Returns Integer
76257>>>>>>>        Local String  sDRiverId
76257>>>>>>>        Local String  sVoid
76257>>>>>>>        Local Integer iRetval
76257>>>>>>>
76257>>>>>>>        Get psDriverID To sDriverID
76258>>>>>>>        If (sDRiverID <> "") Begin
76260>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
76265>>>>>>>        End
76265>>>>>>>>
76265>>>>>>>
76265>>>>>>>        Function_Return iRetval
76266>>>>>>>    End_Function // SerialNumber
76267>>>>>>>
76267>>>>>>>
76267>>>>>>>
76267>>>>>>>    //***
76267>>>>>>>    //*** Function: MaxUsers
76267>>>>>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
76267>>>>>>>    //***
76267>>>>>>>
76267>>>>>>>    Function MaxUsers Returns Integer
76269>>>>>>>        Local String  sDRiverId
76269>>>>>>>        Local String  sVoid
76269>>>>>>>        Local Integer iRetval
76269>>>>>>>
76269>>>>>>>        Get psDriverID To sDriverID
76270>>>>>>>        If (sDRiverID <> "") Begin
76272>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
76277>>>>>>>        End
76277>>>>>>>>
76277>>>>>>>
76277>>>>>>>        Function_Return iRetval
76278>>>>>>>    End_Function // MaxUsers
76279>>>>>>>
76279>>>>>>>
76279>>>>>>>
76279>>>>>>>    //***
76279>>>>>>>    //*** Procedure: DumpStatus
76279>>>>>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
76279>>>>>>>    //***
76279>>>>>>>
76279>>>>>>>    Procedure DumpStatus String sFileName
76281>>>>>>>        Local String  sVoid
76281>>>>>>>        Local String  sDriverID
76281>>>>>>>        Local Integer iVoid
76281>>>>>>>
76281>>>>>>>        Get psDriverID To sDriverID
76282>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
76289>>>>>>>    End_Procedure // DumpStatus
76290>>>>>>>
76290>>>>>>>
76290>>>>>>>
76290>>>>>>>    //***
76290>>>>>>>    //*** Procedure: ReadConfiguration
76290>>>>>>>    //*** Purpose  : Reset all driver level configurable attributes to the
76290>>>>>>>    //***            default value and then reread the configuration.
76290>>>>>>>    //***
76290>>>>>>>
76290>>>>>>>    Procedure ReadConfiguration
76292>>>>>>>        Local String  sVoid
76292>>>>>>>        Local String  sDriverID
76292>>>>>>>        Local Integer iVoid
76292>>>>>>>
76292>>>>>>>        Get psDriverID To sDriverID
76293>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
76300>>>>>>>    End_Procedure // ReadConfiguration
76301>>>>>>>
76301>>>>>>>
76301>>>>>>>
76301>>>>>>>    //***
76301>>>>>>>    //*** Function: TextToRIMValue
76301>>>>>>>    //*** Purpose : Convert a text to the corresponding
76301>>>>>>>    //***           Generate_Record_ID_Method attribute value
76301>>>>>>>    //***
76301>>>>>>>
76301>>>>>>>    Function TextToRIMValue String sText Returns Integer
76303>>>>>>>        If (sText = "None") ;            Function_return RIM_NONE
76306>>>>>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
76310>>>>>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
76314>>>>>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
76318>>>>>>>    End_Function // TextToRIMValue
76319>>>>>>>
76319>>>>>>>
76319>>>>>>>
76319>>>>>>>    //***
76319>>>>>>>    //*** Function: RIMValueTotext
76319>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76319>>>>>>>    //***           corresponding text.
76319>>>>>>>    //***
76319>>>>>>>
76319>>>>>>>    Function RIMValueToText Integer iAttrValue Returns String
76321>>>>>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
76324>>>>>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
76328>>>>>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
76332>>>>>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
76336>>>>>>>    End_Function // RIMValueToText
76337>>>>>>>
76337>>>>>>>
76337>>>>>>>
76337>>>>>>>    //***
76337>>>>>>>    //*** Function: TextToROValue
76337>>>>>>>    //*** Purpose : Convert a text to the corresponding
76337>>>>>>>    //***           Generate_Record_ID_Method attribute value
76337>>>>>>>    //***
76337>>>>>>>
76337>>>>>>>    Function TextToROValue String sText Returns Integer
76339>>>>>>>        If (sText = "No") ;            Function_return RO_NO
76342>>>>>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
76346>>>>>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
76350>>>>>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
76354>>>>>>>    End_Function // TextToRIMValue
76355>>>>>>>
76355>>>>>>>
76355>>>>>>>
76355>>>>>>>    //***
76355>>>>>>>    //*** Function: ROValueTotext
76355>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76355>>>>>>>    //***           corresponding text.
76355>>>>>>>    //***
76355>>>>>>>
76355>>>>>>>    Function ROValueToText Integer iAttrValue Returns String
76357>>>>>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
76360>>>>>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
76364>>>>>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
76368>>>>>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
76372>>>>>>>    End_Function // RIMValueToText
76373>>>>>>>
76373>>>>>>>
76373>>>>>>>
76373>>>>>>>    //***
76373>>>>>>>    //*** Function: LastDriverError
76373>>>>>>>    //*** Purpose : Return the text f the last error geneated by the driver.
76373>>>>>>>    //***
76373>>>>>>>
76373>>>>>>>    Function LastDriverError Returns String
76375>>>>>>>        Local String  sDriverID
76375>>>>>>>        Local String  sLastError
76375>>>>>>>        Local String  sLastErrorLength
76375>>>>>>>        Local Integer iLastErrorLength
76375>>>>>>>        Local Integer iVoid
76375>>>>>>>
76375>>>>>>>        //*** Initialize
76375>>>>>>>        Move "" To sLastError
76376>>>>>>>
76376>>>>>>>        Get psDriverID To sDriverID
76377>>>>>>>        If (sDriverID <> "") Begin
76379>>>>>>>            //*** Get the text of the last error
76379>>>>>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
76380>>>>>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
76385>>>>>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
76386>>>>>>>
76386>>>>>>>            If (iLastErrorLength > 0) Begin
76388>>>>>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
76389>>>>>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
76394>>>>>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
76395>>>>>>>            End
76395>>>>>>>>
76395>>>>>>>        End
76395>>>>>>>>
76395>>>>>>>
76395>>>>>>>        Function_Return sLastError
76396>>>>>>>    End_Function // LastDriverError
76397>>>>>>>
76397>>>>>>>
76397>>>>>>>
76397>>>>>>>    //***
76397>>>>>>>    //*** Function: EnumerateTables
76397>>>>>>>    //*** Purpose : Enumerate the tables in a database
76397>>>>>>>    //***
76397>>>>>>>
76397>>>>>>>    Function EnumerateTables String sLogin Returns Integer
76399>>>>>>>        Local String  sDriver
76399>>>>>>>        Local String  sVoid
76399>>>>>>>        Local Integer iNumTables
76399>>>>>>>        Local Integer iVoid
76399>>>>>>>
76399>>>>>>>        Get psDriverID To sDriver
76400>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
76407>>>>>>>
76407>>>>>>>        Function_Return iNumTables
76408>>>>>>>    End_Function // EnumerateTables
76409>>>>>>>
76409>>>>>>>
76409>>>>>>>
76409>>>>>>>    //***
76409>>>>>>>    //*** Function: TableName
76409>>>>>>>    //*** Purpose : Returns the name of the table enumerated at the given position
76409>>>>>>>    //***
76409>>>>>>>
76409>>>>>>>    Function TableName Integer iIndex Returns String
76411>>>>>>>        Local String  sDriver
76411>>>>>>>        Local String  sTableName
76411>>>>>>>        Local String  sVoid
76411>>>>>>>        Local Integer iVoid
76411>>>>>>>
76411>>>>>>>        Get psDriverID To sDriver
76412>>>>>>>        If (sDriver <> "") Begin
76414>>>>>>>            Move (Repeat(" ", 255)) To sTableName
76415>>>>>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
76420>>>>>>>        End
76420>>>>>>>>
76420>>>>>>>
76420>>>>>>>        Function_Return sTableName
76421>>>>>>>    End_Function // TableName
76422>>>>>>>
76422>>>>>>>
76422>>>>>>>
76422>>>>>>>    //***
76422>>>>>>>    //*** Function: SchemaName
76422>>>>>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
76422>>>>>>>    //***
76422>>>>>>>
76422>>>>>>>    Function SchemaName Integer iIndex Returns String
76424>>>>>>>        Local String  sDriver
76424>>>>>>>        Local String  sSchemaName
76424>>>>>>>        Local String  sVoid
76424>>>>>>>        Local Integer iVoid
76424>>>>>>>
76424>>>>>>>        Get psDriverID To sDriver
76425>>>>>>>        If (sDriver <> "") Begin
76427>>>>>>>            Move (Repeat(" ", 255)) To sSchemaName
76428>>>>>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
76433>>>>>>>        End
76433>>>>>>>>
76433>>>>>>>
76433>>>>>>>        Function_Return sSchemaName
76434>>>>>>>    End_Function // SchemaName
76435>>>>>>>
76435>>>>>>>
76435>>>>>>>
76435>>>>>>>    //***
76435>>>>>>>    //*** Function: TableType
76435>>>>>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
76435>>>>>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
76435>>>>>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
76435>>>>>>>    //***
76435>>>>>>>
76435>>>>>>>    Function TableType Integer iIndex Returns String
76437>>>>>>>        Local String  sDriver
76437>>>>>>>        Local String  sTableType
76437>>>>>>>        Local String  sVoid
76437>>>>>>>        Local Integer iVoid
76437>>>>>>>
76437>>>>>>>        Get psDriverID To sDriver
76438>>>>>>>        If (sDriver <> "") Begin
76440>>>>>>>            Move (Repeat(" ", 25)) To sTableType
76441>>>>>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
76446>>>>>>>        End
76446>>>>>>>>
76446>>>>>>>
76446>>>>>>>        Function_Return sTableType
76447>>>>>>>    End_Function // TableType
76448>>>>>>>
76448>>>>>>>
76448>>>>>>>
76448>>>>>>>    //***
76448>>>>>>>    //*** Function: TableComment
76448>>>>>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
76448>>>>>>>    //***
76448>>>>>>>
76448>>>>>>>    Function TableComment Integer iIndex Returns String
76450>>>>>>>        Local String  sDriver
76450>>>>>>>        Local String  sTableComment
76450>>>>>>>        Local String  sVoid
76450>>>>>>>        Local Integer iVoid
76450>>>>>>>
76450>>>>>>>        Get psDriverID To sDriver
76451>>>>>>>        If (sDriver <> "") Begin
76453>>>>>>>            Move (Repeat(" ", 255)) To sTableComment
76454>>>>>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
76459>>>>>>>        End
76459>>>>>>>>
76459>>>>>>>
76459>>>>>>>        Function_Return sTableComment
76460>>>>>>>    End_Function // TableComment
76461>>>>>>>
76461>>>>>>>
76461>>>>>>>
76461>>>>>>>    //***
76461>>>>>>>    //*** Function: EnumerateColumns
76461>>>>>>>    //*** Purpose : Enumerate the columns in a table
76461>>>>>>>    //***
76461>>>>>>>
76461>>>>>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
76463>>>>>>>        Local String  sDriver
76463>>>>>>>        Local Integer iNumColumns
76463>>>>>>>        Local Integer iVoid
76463>>>>>>>
76463>>>>>>>        Get psDriverID To sDriver
76464>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
76471>>>>>>>
76471>>>>>>>        Function_Return iNumColumns
76472>>>>>>>    End_Function // EnumerateColumns
76473>>>>>>>
76473>>>>>>>
76473>>>>>>>
76473>>>>>>>    //***
76473>>>>>>>    //*** Function: ColumnName
76473>>>>>>>    //*** Purpose : Returns the name of the column enumerated at the given position
76473>>>>>>>    //***
76473>>>>>>>
76473>>>>>>>    Function ColumnName Integer iIndex Returns String
76475>>>>>>>        Local String  sDriver
76475>>>>>>>        Local String  sColumnName
76475>>>>>>>        Local String  sVoid
76475>>>>>>>        Local Integer iVoid
76475>>>>>>>
76475>>>>>>>        Get psDriverID To sDriver
76476>>>>>>>        If (sDriver <> "") Begin
76478>>>>>>>            Move (Repeat(" ", 255)) To sColumnName
76479>>>>>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
76484>>>>>>>        End
76484>>>>>>>>
76484>>>>>>>
76484>>>>>>>        Function_Return sColumnName
76485>>>>>>>    End_Function // ColumnName
76486>>>>>>>
76486>>>>>>>
76486>>>>>>>
76486>>>>>>>    //***
76486>>>>>>>    //*** Function: CLIDFDateToSQLDate
76486>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
76486>>>>>>>    //***
76486>>>>>>>
76486>>>>>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
76488>>>>>>>        Local String sSQLDate
76488>>>>>>>        Local Integer iOrgDateFmt
76488>>>>>>>        Local Integer iOrgDateSep
76488>>>>>>>
76488>>>>>>>        //*** Change date format to military, SQL dates are military dates
76488>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76491>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76494>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76497>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76500>>>>>>>
76500>>>>>>>        //*** We only need to convert if the date is 0
76500>>>>>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
76509>>>>>>>        Else ;            Move dDFDate To sSQLDate
76511>>>>>>>
76511>>>>>>>        //*** Change date format back to original
76511>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76514>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76517>>>>>>>
76517>>>>>>>        Function_Return sSQLDate
76518>>>>>>>    End_Function // CLIDFDateToSQLDate
76519>>>>>>>
76519>>>>>>>
76519>>>>>>>
76519>>>>>>>    //***
76519>>>>>>>    //*** Function: CLISQLDateToDFDate
76519>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
76519>>>>>>>    //***
76519>>>>>>>
76519>>>>>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
76521>>>>>>>        Local Date dDFDate
76521>>>>>>>        Local String sDummyDateValue
76521>>>>>>>        Local Integer iOrgDateFmt
76521>>>>>>>        Local Integer iOrgDateSep
76521>>>>>>>
76521>>>>>>>        //*** Change date format to military, SQL dates are military dates
76521>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76524>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76527>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76530>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76533>>>>>>>
76533>>>>>>>        //*** We only need to convert if the date is the dummy zero date value
76533>>>>>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
76540>>>>>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
76543>>>>>>>        Else ;            Move sSQLDate To dDFDate
76545>>>>>>>
76545>>>>>>>        //*** Change date format back to original
76545>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76548>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76551>>>>>>>
76551>>>>>>>        Function_Return dDFDate
76552>>>>>>>    End_Function // CLISQLDateToDFDate
76553>>>>>>>
76553>>>>>>>
76553>>>>>>>
76553>>>>>>>    //***
76553>>>>>>>    //*** Function: RedirectConnection
76553>>>>>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
76553>>>>>>>    //***           will point to another database but all tables will stay
76553>>>>>>>    //***           open!
76553>>>>>>>    //***
76553>>>>>>>
76553>>>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
76555>>>>>>>        Local String  sDriver
76555>>>>>>>        Local String  sVoid
76555>>>>>>>        Local Integer iResult
76555>>>>>>>        Local Integer iVoid
76555>>>>>>>
76555>>>>>>>        Get psDriverID To sDriver
76556>>>>>>>        If (sDriver <> "") Begin
76558>>>>>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
76563>>>>>>>        End
76563>>>>>>>>
76563>>>>>>>        Function_Return iResult
76564>>>>>>>    End_Function // RedirectConnect
76565>>>>>>>
76565>>>>>>>
76565>>>>>>>
76565>>>>>>>    //***
76565>>>>>>>    //*** Function: CreateConnectionID
76565>>>>>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
76565>>>>>>>    //***
76565>>>>>>>
76565>>>>>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
76567>>>>>>>        Local String  sDriver
76567>>>>>>>        Local Integer iResult
76567>>>>>>>        Local Integer iOptions
76567>>>>>>>
76567>>>>>>>        Get psDriverID to sDriver
76568>>>>>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
76571>>>>>>>        Else ;            Move iOpt to iOptions
76573>>>>>>>        If (sDriver <> "") Begin
76575>>>>>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
76580>>>>>>>        End
76580>>>>>>>>
76580>>>>>>>        Function_Return iResult
76581>>>>>>>    End_Function // CreateConnectionID
76582>>>>>>>
76582>>>>>>>
76582>>>>>>>
76582>>>>>>>    //***
76582>>>>>>>    //*** Function: DeleteConnectionID
76582>>>>>>>    //*** Purpose : Delete a DataFlex side connection id.
76582>>>>>>>    //***
76582>>>>>>>
76582>>>>>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
76584>>>>>>>        Local String  sDriver
76584>>>>>>>        Local Integer iResult
76584>>>>>>>        Local String sVoid
76584>>>>>>>
76584>>>>>>>        Get psDriverID To sDriver
76585>>>>>>>        If (sDriver <> "") Begin
76587>>>>>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
76592>>>>>>>        End
76592>>>>>>>>
76592>>>>>>>        Function_Return iResult
76593>>>>>>>    End_Function // DeleteConnectionID
76594>>>>>>>
76594>>>>>>>End_Class // cCLIHandler
76595>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 18.2\Pkg\DFBTRDRV.PKG)
76595>>>>>>>//****************************************************************************
76595>>>>>>>//
76595>>>>>>>// $File name  : DFBTRDRV.PKG
76595>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
76595>>>>>>>// Notice      : This package contains constants and commands, used to call
76595>>>>>>>//               specific functions in the DFBTRDRV.
76595>>>>>>>// $Author(s)  : Eddy Kleinjan
76595>>>>>>>//
76595>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
76595>>>>>>>// Created     : 01-07-97 @ 12:00:00
76595>>>>>>>//
76595>>>>>>>// Changed     : 04-04-2001.
76595>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
76595>>>>>>>//
76595>>>>>>>// Changed     : June 6, 2001
76595>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
76595>>>>>>>//
76595>>>>>>>//               Added DFBTR_DDF_OWNER command.
76595>>>>>>>//
76595>>>>>>>// Changed     : June 12, 2001
76595>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
76595>>>>>>>//
76595>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
76595>>>>>>>//
76595>>>>>>>// Changed     : August 4, 2004
76595>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
76595>>>>>>>//
76595>>>>>>>//               Added cDfbtrdrvHandler class.
76595>>>>>>>//               New functions in this class:
76595>>>>>>>//                  Function CKRevision Returns String
76595>>>>>>>//                  Function CkUsesUri Returns Integer
76595>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76595>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76595>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76595>>>>>>>//
76595>>>>>>>// Changed     : September 30, 2005
76595>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
76595>>>>>>>//
76595>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
76595>>>>>>>//****************************************************************************
76595>>>>>>>Use Ui
76595>>>>>>>//
76595>>>>>>>// Driver Indentification
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>//*** Driver attributes
76595>>>>>>>//
76595>>>>>>>// Call_Driver functions ID's
76595>>>>>>>//
76595>>>>>>>//
76595>>>>>>>// DFBTRFN_CONVERT_FILE options
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// DFBTRFN_SET_OWNER options
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to create all vars which may be needed
76595>>>>>>>// in other commands.
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to set the owner of a Btrieve file.
76595>>>>>>>// File must have been opened.
76595>>>>>>>// Filenumber needs to be passed.
76595>>>>>>>// To clear set the owner to "".
76595>>>>>>>// Examples:
76595>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
76595>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
76595>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
76595>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
76595>>>>>>>// To clear:
76595>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to parse DFBTR_SET_OWNVER
76595>>>>>>>// options.
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to parse for Callback
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to clear the owner of a Btrieve file.
76595>>>>>>>// File must have been opened.
76595>>>>>>>// Filenumber needs to be passed.
76595>>>>>>>// Examples:
76595>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to add a owner name to the internal list of ownernames
76595>>>>>>>// which will be tries when opening files.
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to remove all owners from the internal list of ownernames
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to set the owner name to be used when opening the DDF files.
76595>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
76595>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
76595>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to change the transaction type.
76595>>>>>>>// Valid types are:
76595>>>>>>>//     DFBTRTT_NONE
76595>>>>>>>//     DFBTRTT_EXCLUSIVE
76595>>>>>>>//     DFBTRTT_CONCURRENT
76595>>>>>>>//
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to get the current transaction type.
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to set explicit_locking
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to get explicit locking
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>//
76595>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
76595>>>>>>>//
76595>>>>>>>
76595>>>>>>>//*****************************************************************************
76595>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
76595>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
76595>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
76595>>>>>>>//*****************************************************************************
76595>>>>>>>
76595>>>>>>>Class cDFBtrDrvHandler Is An Array
76596>>>>>>>
76596>>>>>>>    Procedure Construct_Object Integer iImage
76598>>>>>>>        Forward Send Construct_object iImage
76600>>>>>>>
76600>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
76601>>>>>>>    End_Procedure // Construct_Object
76602>>>>>>>
76602>>>>>>>
76602>>>>>>>
76602>>>>>>>    //***
76602>>>>>>>    //*** Function: CKRevsion
76602>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
76602>>>>>>>    //***
76602>>>>>>>
76602>>>>>>>    Function CKRevision Returns String
76604>>>>>>>        Local String  sDriverID
76604>>>>>>>        Local String  sRevision
76604>>>>>>>        Local String  sVoid
76604>>>>>>>        Local Integer iRetval
76604>>>>>>>
76604>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76604>>>>>>>        // This error would otherwise be raised when we have an older
76604>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76604>>>>>>>        Send Ignore_error To Error_object_Id 20491
76605>>>>>>>        Get psDriverID To sDriverID
76606>>>>>>>        Move (Repeat(" ", 255)) To sRevision
76607>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
76612>>>>>>>        Send Trap_Error To Error_object_Id 20491
76613>>>>>>>        If (Trim(sRevision) = "") Begin
76615>>>>>>>            // Unable to get the revision. return all zeroes.
76615>>>>>>>            Move "0.0.0.0" To sRevision
76616>>>>>>>        End
76616>>>>>>>>
76616>>>>>>>        Function_Return sRevision
76617>>>>>>>    End_Function // CKRevision
76618>>>>>>>
76618>>>>>>>    Function CkUsesUri Returns Integer
76620>>>>>>>        Local String  sDriverID
76620>>>>>>>        Local String  sVoid1
76620>>>>>>>        Local String  sVoid2
76620>>>>>>>        Local Integer iRetval
76620>>>>>>>
76620>>>>>>>        Get psDriverID To sDriverID
76621>>>>>>>
76621>>>>>>>        Move 0 To iRetval
76622>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76622>>>>>>>        // This error would otherwise be raised when we have an older
76622>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
76622>>>>>>>        Send Ignore_error To Error_object_Id 20491
76623>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
76628>>>>>>>        Send Trap_Error To Error_object_Id 20491
76629>>>>>>>
76629>>>>>>>        Function_Return iRetval
76630>>>>>>>    End_Function // CKUsesUri
76631>>>>>>>
76631>>>>>>>
76631>>>>>>>
76631>>>>>>>    //***
76631>>>>>>>    //*** Function: ExtractPartFromRevsion
76631>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
76631>>>>>>>    //***
76631>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
76631>>>>>>>    //***
76631>>>>>>>
76631>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
76633>>>>>>>        Local Integer iPartRev
76633>>>>>>>        Local Integer iCurrentPart
76633>>>>>>>        Local Integer iSeparatorPos
76633>>>>>>>
76633>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
76636>>>>>>>
76636>>>>>>>        Move 0 To iCurrentPart
76637>>>>>>>        Repeat
76637>>>>>>>>
76637>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
76638>>>>>>>            If (iSeparatorPos > 0) Begin
76640>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
76641>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
76642>>>>>>>                Increment iCurrentPart
76643>>>>>>>            End
76643>>>>>>>>
76643>>>>>>>            Else If (sRevision <> "") Begin
76646>>>>>>>                Move sRevision To iPartRev
76647>>>>>>>                Move "" To sRevision
76648>>>>>>>                Increment iCurrentPart
76649>>>>>>>            End
76649>>>>>>>>
76649>>>>>>>            Else ;                Move -1 To iPartRev
76651>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
76653>>>>>>>
76653>>>>>>>        Function_Return iPartRev
76654>>>>>>>    End_Function // EcxtractPartFromRevision
76655>>>>>>>
76655>>>>>>>
76655>>>>>>>
76655>>>>>>>    //***
76655>>>>>>>    //*** Function: CKMajorRevision
76655>>>>>>>    //*** Purpose : Returns the major revision of the CK
76655>>>>>>>    //***
76655>>>>>>>
76655>>>>>>>    Function CKMajorRevision Returns Integer
76657>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
76658>>>>>>>    End_Function // CKMajorRevision
76659>>>>>>>
76659>>>>>>>
76659>>>>>>>
76659>>>>>>>    //***
76659>>>>>>>    //*** Function: CKMinorRevision
76659>>>>>>>    //*** Purpose : Returns the minor revision of the CK
76659>>>>>>>    //***
76659>>>>>>>
76659>>>>>>>    Function CKMinorRevision Returns Integer
76661>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
76662>>>>>>>    End_Function // CKMinorRevision
76663>>>>>>>
76663>>>>>>>
76663>>>>>>>
76663>>>>>>>    //***
76663>>>>>>>    //*** Function: CKReleaseRevision
76663>>>>>>>    //*** Purpose : Returns the release revision of the CK
76663>>>>>>>    //***
76663>>>>>>>
76663>>>>>>>    Function CKReleaseRevision Returns Integer
76665>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
76666>>>>>>>    End_Function // CKReleaseRevision
76667>>>>>>>
76667>>>>>>>
76667>>>>>>>
76667>>>>>>>    //***
76667>>>>>>>    //*** Function: CKBuildRevision
76667>>>>>>>    //*** Purpose : Returns the major revision of the CK
76667>>>>>>>    //***
76667>>>>>>>
76667>>>>>>>    Function CKBuildRevision Returns Integer
76669>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
76670>>>>>>>    End_Function // CKBuildRevision
76671>>>>>>>
76671>>>>>>>
76671>>>>>>>
76671>>>>>>>    //***
76671>>>>>>>    //*** Function: IsMinimalRevision
76671>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
76671>>>>>>>    //***
76671>>>>>>>
76671>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
76673>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
76676>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
76679>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
76682>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
76685>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
76688>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
76692>>>>>>>            End
76692>>>>>>>>
76692>>>>>>>        End
76692>>>>>>>>
76692>>>>>>>
76692>>>>>>>        Function_Return (FALSE)
76693>>>>>>>    End_Function // IsMinimalRevision
76694>>>>>>>
76694>>>>>>>    //   Functions to query the Pervasive.SQL version:
76694>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
76694>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
76694>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
76694>>>>>>>    //
76694>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
76694>>>>>>>    //   in the following format:
76694>>>>>>>    //       <version>.<revision>.<type>
76694>>>>>>>    //   possible values for <type>:
76694>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
76694>>>>>>>    //         server using Workgroup authentication mode
76694>>>>>>>    //       C for client cache engine
76694>>>>>>>    //       D for DOS workstation
76694>>>>>>>    //       N for client Requester
76694>>>>>>>    //       S for NetWare server
76694>>>>>>>    //       T for 32-bit Windows server engine
76694>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
76694>>>>>>>    //
76694>>>>>>>    //   example:
76694>>>>>>>    //       8.50.T
76694>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
76694>>>>>>>    //   32-bits Windows server.
76694>>>>>>>    //
76694>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
76694>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
76694>>>>>>>    //
76694>>>>>>>    //   If the version information is not available or can not be obtained
76694>>>>>>>    //   the functions will return "0.0.0"
76694>>>>>>>
76694>>>>>>>
76694>>>>>>>    //***
76694>>>>>>>    //*** Function: PSQLRequesterVersionInfo
76694>>>>>>>    //*** Purpose : Returns the version information of the
76694>>>>>>>    //***           Pervasive.SQL Client requester.
76694>>>>>>>
76694>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
76696>>>>>>>
76696>>>>>>>        Local String  sDriverID
76696>>>>>>>        Local String  sVersion
76696>>>>>>>        Local String  sVoid
76696>>>>>>>        Local Integer iRetval
76696>>>>>>>
76696>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76696>>>>>>>        // This error would otherwise be raised when we have an older
76696>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76696>>>>>>>        Send Ignore_error To Error_object_Id 20491
76697>>>>>>>        Get psDriverID To sDriverID
76698>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76699>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76704>>>>>>>        Send Trap_Error To Error_object_Id 20491
76705>>>>>>>        If (Trim(sVersion) = "") Begin
76707>>>>>>>            // Unable to get the revision. return all zeroes.
76707>>>>>>>            Move "0.0.0" To sVersion
76708>>>>>>>        End
76708>>>>>>>>
76708>>>>>>>        Function_Return sVersion
76709>>>>>>>    End_Function //  PSQLRequesterVersion
76710>>>>>>>
76710>>>>>>>    //***
76710>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
76710>>>>>>>    //*** Purpose : Returns the version information of the
76710>>>>>>>    //***           Pervasive.SQL Local Engine
76710>>>>>>>
76710>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
76712>>>>>>>
76712>>>>>>>        Local String  sDriverID
76712>>>>>>>        Local String  sVersion
76712>>>>>>>        Local String  sVoid
76712>>>>>>>        Local Integer iRetval
76712>>>>>>>
76712>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76712>>>>>>>        // This error would otherwise be raised when we have an older
76712>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76712>>>>>>>        Send Ignore_error To Error_object_Id 20491
76713>>>>>>>        Get psDriverID To sDriverID
76714>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76715>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76720>>>>>>>        Send Trap_Error To Error_object_Id 20491
76721>>>>>>>        If (Trim(sVersion) = "") Begin
76723>>>>>>>            // Unable to get the revision. return all zeroes.
76723>>>>>>>            Move "0.0.0" To sVersion
76724>>>>>>>        End
76724>>>>>>>>
76724>>>>>>>        Function_Return sVersion
76725>>>>>>>    End_Function //  PSQLLocalEngineVersion
76726>>>>>>>
76726>>>>>>>    //***
76726>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
76726>>>>>>>    //*** Purpose : Returns the version information of the
76726>>>>>>>    //***           Pervasive.SQL Server Engine
76726>>>>>>>
76726>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
76728>>>>>>>
76728>>>>>>>        Local String  sDriverID
76728>>>>>>>        Local String  sVersion
76728>>>>>>>        Local String  sVoid
76728>>>>>>>        Local Integer iRetval
76728>>>>>>>
76728>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
76728>>>>>>>        // This error would otherwise be raised when we have an older
76728>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
76728>>>>>>>        Send Ignore_error To Error_object_Id 20491
76729>>>>>>>        Get psDriverID To sDriverID
76730>>>>>>>        Move (Repeat(" ", 255)) To sVersion
76731>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
76736>>>>>>>        Send Trap_Error To Error_object_Id 20491
76737>>>>>>>        If (Trim(sVersion) = "") Begin
76739>>>>>>>            // Unable to get the revision. return all zeroes.
76739>>>>>>>            Move "0.0.0" To sVersion
76740>>>>>>>        End
76740>>>>>>>>
76740>>>>>>>        Function_Return sVersion
76741>>>>>>>    End_Function //  PSQLServerEngineVersion
76742>>>>>>>
76742>>>>>>>End_Class // cDfbtrdrvHandler
76743>>>>>>>
76743>>>>>
76743>>>>>
76743>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
76744>>>>>
76744>>>>>Register_Function phoWorkspace Returns Handle
76744>>>>>Register_Function Help_filename Returns String
76744>>>>>Register_Function GetHelpFile Returns String
76744>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
76744>>>>>
76744>>>>>//****************************************************************************
76744>>>>>// $Module type: FUNCTION
76744>>>>>// $Module name: Network_User_Name
76744>>>>>// $Author     : AK/VOO/KCR
76744>>>>>// Created     : 09-24-96 @ 19:17
76744>>>>>//
76744>>>>>// Description
76744>>>>>//    This function reads the current username Of windows and returns that
76744>>>>>//    name or an text unknown user
76744>>>>>//
76744>>>>>// $Rev History
76744>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
76744>>>>>//  07/25/2003  Replaced obsolete code
76744>>>>>//  09/24/1996  Module header created
76744>>>>>//****************************************************************************
76744>>>>>Function Network_User_Name for cDesktop Returns String
76746>>>>>    String sName
76746>>>>>    Integer iRetval iLength
76746>>>>>
76746>>>>>    Move 0 to iLength
76747>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
76748>>>>>    ZeroString iLength to sName
76749>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
76750>>>>>
76750>>>>>    If (iRetval = NO_ERROR) Begin
76752>>>>>        Function_Return (CString (sName))
76753>>>>>    End
76753>>>>>>
76753>>>>>    
76753>>>>>    Function_Return "User Unknown"
76754>>>>>End_Function
76755>>>>>
76755>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
76755>>>>>Type MEMORYSTATUS
76755>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
76755>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
76755>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
76755>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
76755>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
76755>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
76755>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
76755>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
76755>>>>>End_Type // MEMORYSTATUS
76755>>>>>
76755>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
76756>>>>>
76756>>>>>Struct tWinMemoryStatusEx
76756>>>>>    UInteger dwLength                
76756>>>>>    UInteger dwMemoryLoad          
76756>>>>>    UBigInt ullTotalPhys           
76756>>>>>    UBigInt ullAvailPhys           
76756>>>>>    UBigInt ullTotalPageFile       
76756>>>>>    UBigInt ullAvailPageFile       
76756>>>>>    UBigInt ullTotalVirtual        
76756>>>>>    UBigInt ullAvailVirtual        
76756>>>>>    UBigInt ullAvailExtendedVirtual
76756>>>>>End_Struct
76756>>>>>
76756>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
76757>>>>>
76757>>>>>Class SysinfoDisplay is a cTextEdit
76758>>>>>    Procedure Construct_Object
76760>>>>>        Forward Send Construct_Object
76762>>>>>
76762>>>>>        Set Location To 6 6
76763>>>>>        Set Size To 110 255
76764>>>>>        Set Read_Only_State To True
76765>>>>>        Set pbWrap to False
76766>>>>>    End_Procedure
76767>>>>>
76767>>>>>    //****************************************************************************
76767>>>>>    // $Module type: PROCEDURE
76767>>>>>    // $Module name: Show_Current_Directory
76767>>>>>    // $Author     : VOO
76767>>>>>    // Created     : 06-10-96 @ 15:24
76767>>>>>    //
76767>>>>>    // Description
76767>>>>>    //    This method will show the name Of the current directory in the system
76767>>>>>    //    information box
76767>>>>>    //
76767>>>>>    // $Rev History
76767>>>>>    //    06-10-96  Module header created
76767>>>>>    //****************************************************************************
76767>>>>>    Procedure Show_Current_Directory
76769>>>>>        String sDir
76769>>>>>
76769>>>>>        Get_Current_Directory To sDir
76770>>>>>
76770>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
76771>>>>>    End_Procedure
76772>>>>>
76772>>>>>    Procedure Show_Windows_Directory
76774>>>>>        String sWindir
76774>>>>>
76774>>>>>        Get_Windows_Directory To sWindir
76775>>>>>
76775>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
76776>>>>>    End_Procedure
76777>>>>>
76777>>>>>    Procedure Show_Current_User
76779>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
76780>>>>>    End_Procedure
76781>>>>>
76781>>>>>    Procedure Show_Number_Format
76783>>>>>        Integer iFormat
76783>>>>>        String sFormatText
76783>>>>>
76783>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
76786>>>>>        Move (Character (iFormat)) To sFormatText
76787>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
76788>>>>>
76788>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
76791>>>>>        Move (Character (iFormat)) to sFormatText
76792>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
76793>>>>>    End_Procedure
76794>>>>>
76794>>>>>    Procedure Show_Filelist_Name
76796>>>>>        String sFilename
76796>>>>>
76796>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
76799>>>>>
76799>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
76800>>>>>        Send AppendTextLn ""
76801>>>>>    End_Procedure
76802>>>>>
76802>>>>>    Procedure Show_Lock_Delay
76804>>>>>        Integer iLockdelay
76804>>>>>
76804>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
76807>>>>>
76807>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
76808>>>>>    End_Procedure
76809>>>>>
76809>>>>>    Procedure Show_Lock_Timeout
76811>>>>>        Integer iLockTimeout
76811>>>>>
76811>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
76814>>>>>
76814>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
76815>>>>>    End_Procedure
76816>>>>>
76816>>>>>    Procedure Show_Screen_Size
76818>>>>>        Integer iYscreensize iXscreensize
76818>>>>>
76818>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
76819>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
76820>>>>>
76820>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
76821>>>>>    End_Procedure
76822>>>>>
76822>>>>>    Procedure Show_Page_Size
76824>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
76825>>>>>    End_procedure
76826>>>>>
76826>>>>>    Procedure Show_Date
76828>>>>>        Date dToday
76828>>>>>
76828>>>>>        Sysdate dToday
76829>>>>>
76829>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
76830>>>>>    End_procedure
76831>>>>>
76831>>>>>    Procedure Show_Date_Format
76833>>>>>        Integer iDateFormat
76833>>>>>        String sDateFormat
76833>>>>>
76833>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
76836>>>>>        Case Begin
76836>>>>>            Case (iDateFormat = DF_DATE_USA)
76838>>>>>                Move C_$USA To sDateFormat
76839>>>>>                Case Break
76840>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
76843>>>>>                Move C_$European To sDateFormat
76844>>>>>                Case Break
76845>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
76848>>>>>                Move C_$Military To sDateFormat
76849>>>>>                Case Break
76850>>>>>            Case Else
76850>>>>>                Move C_$UnknownDateType To sDateFormat
76851>>>>>                Case Break
76852>>>>>        Case End
76852>>>>>
76852>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
76853>>>>>    End_Procedure
76854>>>>>
76854>>>>>    Procedure Show_Systemresources
76856>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76856>>>>>        tWinMemoryStatusEx MemoryStatusInfo
76856>>>>>        Integer iRetval
76856>>>>>
76856>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
76857>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
76858>>>>>        If (iRetval = 0) Begin
76860>>>>>            Move (ShowLastError ()) to iRetval
76861>>>>>        End
76861>>>>>>
76861>>>>>
76861>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
76862>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
76863>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
76864>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
76865>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
76866>>>>>    End_Procedure
76867>>>>>
76867>>>>>    Procedure Show_Registration
76869>>>>>        String sRegName
76869>>>>>        Integer iSN iMaxUsers
76869>>>>>
76869>>>>>        Registration sRegName iSN
76870>>>>>>
76870>>>>>        
76870>>>>>        Get_Licensed_Max_Users to iMaxUsers
76871>>>>>
76871>>>>>        Send AppendTextLn ""
76872>>>>>        Send AppendTextLn (SFormat (C_$Serial, iSN))
76873>>>>>        Send AppendTextLn (SFormat (C_$RegName, sRegName))
76874>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
76875>>>>>    End_Procedure
76876>>>>>
76876>>>>>    //****************************************************************************
76876>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
76876>>>>>    // To the workspace object passing the an object and message To send back
76876>>>>>    // To this object. It is expected that the workspace object will send this
76876>>>>>    // message for every line Of information it wants displayed (passing the
76876>>>>>    // information To be displayed
76876>>>>>    //****************************************************************************
76876>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
76876>>>>>
76876>>>>>    Procedure Show_ServicePack
76878>>>>>        String sKey sVersionDescription sVersion 
76878>>>>>        Handle hoRegistry
76878>>>>>        Boolean bExists bOpened
76878>>>>>        
76878>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
76879>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
76880>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
76881>>>>>
76881>>>>>        Move C_DFVersionRegistryRoot to sKey
76882>>>>>        Get KeyExists of hoRegistry sKey to bExists
76883>>>>>        If (bExists) Begin
76885>>>>>            Get OpenKey of hoRegistry sKey to bOpened
76886>>>>>            If (bOpened) Begin
76888>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
76889>>>>>                If (bExists) Begin
76891>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
76892>>>>>                End
76892>>>>>>
76892>>>>>                
76892>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
76893>>>>>                If (bExists) Begin
76895>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
76896>>>>>                End                
76896>>>>>>
76896>>>>>                Send CloseKey of hoRegistry
76897>>>>>            End
76897>>>>>>
76897>>>>>        End
76897>>>>>>
76897>>>>>        Send Destroy of hoRegistry
76898>>>>>
76898>>>>>        If (sVersionDescription <> "") Begin
76900>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
76901>>>>>           Send AppendTextLn ""
76902>>>>>        End
76902>>>>>>
76902>>>>>    End_Procedure
76903>>>>>    
76903>>>>>
76903>>>>>    Procedure Show_WorkspaceInformation
76905>>>>>        Integer hoWorkspace
76905>>>>>
76905>>>>>        If (ghoApplication <> 0) Begin
76907>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
76908>>>>>            If (hoWorkspace <> 0) Begin
76910>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
76911>>>>>                Send AppendTextLn ""
76912>>>>>            End
76912>>>>>>
76912>>>>>        End
76912>>>>>>
76912>>>>>    End_Procedure
76913>>>>>
76913>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
76915>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
76916>>>>>    End_Function
76917>>>>>
76917>>>>>    Procedure Show_Versions
76919>>>>>        Integer iVersion iRevision iBuild
76919>>>>>
76919>>>>>        Version_Information iVersion iRevision iBuild
76921>>>>>
76921>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
76922>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
76923>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
76924>>>>>    End_Procedure
76925>>>>>    
76925>>>>>    Function CKRevisionNumber String sDriverID Returns String
76927>>>>>        Handle hoCLIHandler
76927>>>>>        Handle hoDFBtrDrvHandler
76927>>>>>        String sCKRevision
76927>>>>>
76927>>>>>
76927>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
76929>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
76930>>>>>            Set psDriverID of hoCLIHandler to sDriverID
76931>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
76932>>>>>            Send Destroy of hoCLIHandler
76933>>>>>        End
76933>>>>>>
76933>>>>>        Else Begin
76934>>>>>            If (sDriverID = "DFBTRDRV") Begin
76936>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
76937>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
76938>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
76939>>>>>                Send Destroy of hoDFBtrDrvHandler
76940>>>>>            End
76940>>>>>>
76940>>>>>        End
76940>>>>>>
76940>>>>>        
76940>>>>>        Function_Return sCKRevision
76941>>>>>    End_Function
76942>>>>>    
76942>>>>>    
76942>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
76944>>>>>        
76944>>>>>        If (sDriverID = "DATAFLEX") Begin
76946>>>>>            Function_Return False
76947>>>>>        End
76947>>>>>>
76947>>>>>    
76947>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
76948>>>>>    End_Function    
76949>>>>>
76949>>>>>
76949>>>>>    //***
76949>>>>>    //*** BW
76949>>>>>    //*** Procedure: Show_Drivers
76949>>>>>    //*** Purpose  : Show loaded database drivers
76949>>>>>    //***
76949>>>>>
76949>>>>>    Procedure Show_Drivers
76951>>>>>        String sCurrentDriver sRevNumber
76951>>>>>        String sLoadedDrivers
76951>>>>>        Integer iNumberOfDrivers iCount
76951>>>>>        Boolean bOK
76951>>>>>
76951>>>>>        Move "" To sLoadedDrivers
76952>>>>>        Get_Attribute DF_NUMBER_DRIVERS To iNumberOfDrivers
76955>>>>>        For iCount From 1 To iNumberOfDrivers
76961>>>>>>
76961>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
76964>>>>>            If (sLoadedDrivers <> "") Begin
76966>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
76967>>>>>            End
76967>>>>>>
76967>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
76968>>>>>            If (bOK) Begin
76970>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
76971>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
76972>>>>>            End
76972>>>>>>
76972>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) To sLoadedDrivers
76973>>>>>        Loop
76974>>>>>>
76974>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
76975>>>>>    End_Procedure
76976>>>>>
76976>>>>>    Procedure Show_HelpFile
76978>>>>>        String sHelpFile
76978>>>>>        Integer eHelpType
76978>>>>>
76978>>>>>        If (ghoApplication <> 0) Begin
76980>>>>>            Get peHelpType Of ghoApplication To eHelpType
76981>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
76983>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
76984>>>>>            End
76984>>>>>>
76984>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
76987>>>>>                Get Help_filename Of Help_object_id To sHelpFile
76988>>>>>            End
76988>>>>>>
76988>>>>>            Else Begin
76989>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
76990>>>>>            End
76990>>>>>>
76990>>>>>
76990>>>>>            Send AppendTextLn ""
76991>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
76992>>>>>        End
76992>>>>>>
76992>>>>>    End_Procedure
76993>>>>>
76993>>>>>    Procedure Show_EnterAsTab
76995>>>>>        Boolean bEnterKeyAsTabKey
76995>>>>>        String sText
76995>>>>>
76995>>>>>        If (ghoApplication <> 0) Begin
76997>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
76998>>>>>            If (bEnterKeyAsTabKey) Begin
77000>>>>>                Move "True" To sText
77001>>>>>            End
77001>>>>>>
77001>>>>>            Else Begin
77002>>>>>                Move "False" To sText
77003>>>>>            End
77003>>>>>>
77003>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
77004>>>>>        End
77004>>>>>>
77004>>>>>    End_Procedure
77005>>>>>
77005>>>>>    //****************************************************************************
77005>>>>>    // $Module type: PROCEDURE
77005>>>>>    // $Module name: Add_Focus
77005>>>>>    // $Author     : VOO
77005>>>>>    // Created     : 24-09-96 @ 19:43
77005>>>>>    //
77005>>>>>    // Description
77005>>>>>    //    During activation we will remove the old information and add the newly
77005>>>>>    //    found systeminformation
77005>>>>>    //
77005>>>>>    // $Rev History
77005>>>>>    //    24-09-96  Module header created
77005>>>>>    //****************************************************************************
77005>>>>>    Procedure Add_Focus Integer hoRoot
77007>>>>>        Forward Send Add_Focus hoRoot
77009>>>>>
77009>>>>>        Send Delete_Data
77010>>>>>
77010>>>>>        Set Changed_State To False
77011>>>>>        Set Read_Only_State To True
77012>>>>>
77012>>>>>        Send Show_ServicePack
77013>>>>>        Send Show_Versions   
77014>>>>>        Send Show_Drivers         
77015>>>>>        Send Show_HelpFile
77016>>>>>        Send Show_Current_Directory
77017>>>>>        Send Show_Filelist_Name          
77018>>>>>        If (ghoApplication <> 0) Begin
77020>>>>>            Send Show_WorkSpaceInformation // added To show WS info
77021>>>>>        End
77021>>>>>>
77021>>>>>        Send Show_Current_User 
77022>>>>>        Send Show_Windows_Directory 
77023>>>>>        Send Show_Screen_Size
77024>>>>>        Send Show_Page_Size
77025>>>>>        Send Show_EnterAsTab        
77026>>>>>        Send Show_Number_Format
77027>>>>>        Send Show_Date_Format
77028>>>>>        Send Show_Lock_Delay
77029>>>>>        Send Show_Lock_Timeout
77030>>>>>        Send Show_Date
77031>>>>>        Send Show_Systemresources
77032>>>>>        Send Show_Registration
77033>>>>>        Send Beginning_of_Data
77034>>>>>
77034>>>>>        Set Icon to 'default.ico'
77035>>>>>    End_Procedure
77036>>>>>End_Class
77037>>>>>
77037>>>>>//****************************************************************************
77037>>>>>// $Module type: OBJECT
77037>>>>>// $Module name: Sysinfo_Dialog
77037>>>>>// $Author     : VOO
77037>>>>>// Created     : 24-09-96 @ 18:47
77037>>>>>//
77037>>>>>// Description
77037>>>>>//    This object shows the systeminformation on the screen
77037>>>>>//
77037>>>>>// $Rev History
77037>>>>>//    24-09-96  Module header created
77037>>>>>//****************************************************************************
77037>>>>>Class SysInfoDialog Is A ModalPanel
77038>>>>>    Procedure Construct_Object
77040>>>>>        Forward Send Construct_Object
77042>>>>>
77042>>>>>        Set Label to C_$SystemInformation
77043>>>>>        Set Size to 140 267
77044>>>>>        Set piMinSize to 140 267
77045>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77046>>>>>        Set Border_Style to Border_Thick
77047>>>>>
77047>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
77049>>>>>            Set peAnchors to anAll
77050>>>>>        End_Object
77051>>>>>
77051>>>>>        Object oCloseButton Is A Button
77053>>>>>            Set Label To C_$Close
77054>>>>>            Set Location To 120 210
77055>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
77056>>>>>            Set Default_State To True
77057>>>>>            Set peAnchors to anBottomRight
77058>>>>>        End_Object
77059>>>>>
77059>>>>>        On_Key kCancel Send Close_Panel
77060>>>>>    End_Procedure
77061>>>>>End_Class
77062>>>>>
77062>>>>>// Purpose:
77062>>>>>//
77062>>>>>// Ken Ross 12/17/96 5:16PM
77062>>>>>//
77062>>>>>Class AboutDialog Is A ModalPanel
77063>>>>>    Procedure Construct_Object
77065>>>>>        String sVdfRootDir
77065>>>>>
77065>>>>>        Forward Send Construct_Object
77067>>>>>
77067>>>>>        Set Label To C_$About
77068>>>>>        Set Size to 89 212
77069>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
77070>>>>>
77070>>>>>        Object oSysInfoDialog Is A SysInfoDialog
77072>>>>>        End_Object
77073>>>>>
77073>>>>>        Object oBox Is A Container3d
77075>>>>>            Set Border_Style To Border_StaticEdge
77076>>>>>            Set Size to 63 202
77077>>>>>            Set Location To 4 5
77078>>>>>
77078>>>>>            Object oAboutGraphic Is A BitmapContainer
77080>>>>>                Set Border_Style To Border_None
77081>>>>>                Set Bitmap_Style To Bitmap_Center
77082>>>>>                Set Size To 48 48
77083>>>>>                Set Location To 7 2
77084>>>>>            End_Object
77085>>>>>
77085>>>>>            Object oProductName Is A TextBox
77087>>>>>                Set Label To C_$ProductName
77088>>>>>                Set Size To 10 45
77089>>>>>                Set Location To 8 53
77090>>>>>            End_Object
77091>>>>>
77091>>>>>            Object oVersion Is A TextBox
77093>>>>>                Set Label To C_$Version
77094>>>>>                Set Size To 10 25
77095>>>>>                Set Location To 21 53
77096>>>>>            End_Object
77097>>>>>
77097>>>>>            Object oCopyright Is A TextBox
77099>>>>>                Set Label To C_$Copyright
77100>>>>>                Set Size To 10 31
77101>>>>>                Set Location To 34 53
77102>>>>>            End_Object
77103>>>>>
77103>>>>>            Object oAuthor Is A TextBox
77105>>>>>                Set Label To C_$Author
77106>>>>>                Set Size To 10 22
77107>>>>>                Set Location To 46 53
77108>>>>>            End_Object
77109>>>>>        End_Object
77110>>>>>
77110>>>>>        Object oOKButton Is A Button
77112>>>>>            On_Item C_$OK Send Close_Panel
77113>>>>>            Set Size To 14 50
77114>>>>>            Set Location To 71 157
77115>>>>>        End_Object
77116>>>>>
77116>>>>>        Object oSysInfoButton Is A Button
77118>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
77119>>>>>            Set Size To 14 50
77120>>>>>            Set Location To 71 101
77121>>>>>        End_Object
77122>>>>>
77122>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
77123>>>>>
77123>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
77124>>>>>    End_Procedure
77125>>>>>
77125>>>>>    Procedure Set ProductName String sProductName
77127>>>>>        Set Label Of oProductName To sProductName
77128>>>>>    End_Procedure
77129>>>>>
77129>>>>>    Procedure Set Version String sVersion
77131>>>>>        Set Label Of oVersion To sVersion
77132>>>>>    End_Procedure
77133>>>>>
77133>>>>>    Procedure Set Copyright string sCopyright
77135>>>>>        Set Label Of oCopyright To sCopyright
77136>>>>>    End_Procedure
77137>>>>>
77137>>>>>    Procedure Set Author String sAuthor
77139>>>>>        Set Label Of oAuthor To sAuthor
77140>>>>>    End_Procedure
77141>>>>>
77141>>>>>    Procedure Set Logo string sLogo
77143>>>>>        // square bitmaps Of 42x42 work best
77143>>>>>        Set Bitmap Of oAboutGraphic To sLogo
77144>>>>>    End_Procedure
77145>>>>>
77145>>>>>    Procedure Show_Sysinfo
77147>>>>>        Send Popup_Modal Of oSysinfoDialog
77148>>>>>    End_Procedure
77149>>>>>
77149>>>>>    Procedure End_Construct_Object
77151>>>>>        Handle hoVersionInfo
77151>>>>>        Boolean bIncluded
77151>>>>>        Integer iMajor iMinor iRelease iBuild
77151>>>>>        String sLabel
77151>>>>>
77151>>>>>        Get Label Of oVersion To sLabel
77152>>>>>        If (sLabel = C_$VERSION) Begin
77154>>>>>            // set it To the version info Of the program, if available
77154>>>>>            If (ghoApplication <> 0) Begin
77156>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
77157>>>>>                If (hoVersionInfo <> 0) Begin
77159>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
77160>>>>>                    If (bIncluded) Begin
77162>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
77163>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
77164>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
77165>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
77166>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
77167>>>>>                        Set Version to sLabel
77168>>>>>                    End
77168>>>>>>
77168>>>>>                End
77168>>>>>>
77168>>>>>            End
77168>>>>>>
77168>>>>>        End
77168>>>>>>
77168>>>>>
77168>>>>>        Forward Send End_Construct_Object
77170>>>>>    End_Procedure
77171>>>>>End_Class
77172>>>
77172>>>// *************************************************************************
77172>>>//  Public message. This is the default message. It is expected that you will
77172>>>//   create your own message to override this
77172>>>// *************************************************************************
77172>>>
77172>>>Procedure Activate_About
77175>>>   Send DoAbout "" "" "" "" ""
77176>>>End_Procedure
77177>>>
77177>>>// *************************************************************************
77177>>>//  Public message. It is expected that you will send this message (most
77177>>>//  likely from Activate_About. This creates an about object, activates it
77177>>>//  and destroys it when done. It is not exepected that you will augment this.
77177>>>// *************************************************************************
77177>>>
77177>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
77180>>>        integer hoObj hoMain
77180>>>
77180>>>        // create object
77180>>>        Object About is an AboutDialog
77182>>>            // if no title passed use the label of the main panel
77182>>>            // (if a main panel exists).
77182>>>            if sTitle     eq '' Begin
77184>>>                Get Main_Window of desktop to hoMain
77185>>>                if hoMain Get Label of hoMain to sTitle
77188>>>            end
77188>>>>
77188>>>            set productname to sTitle
77189>>>            set version     to sVersion
77190>>>            set copyright   to sCopyRight
77191>>>            set author      to sAuthor
77192>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
77195>>>            Move self to hoObj // object Id
77196>>>        End_Object
77197>>>        Send Popup   of hoObj    // popup the about object
77198>>>        Send Destroy of hoObj // when done, it will be destroyed
77199>>>End_procedure
77200>        Use Egresos.vw
Including file: Egresos.vw    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\Egresos.vw)
77200>>>Use Windows.pkg
77200>>>Use DFClient.pkg
77200>>>Use DFEntry.pkg
77200>>>Use cDbCJGrid.pkg
77200>>>Use cdbCJGridColumn.pkg
77200>>>Use sql.pkg
Including file: sql.pkg    (C:\Program Files (x86)\DataFlex 18.2\Pkg\sql.pkg)
77200>>>>>//*****************************************************************************
77200>>>>>//*** SQL.pkg                                                               ***
77200>>>>>//***                                                                       ***
77200>>>>>//*** Author: Ben Weijers                                                   ***
77200>>>>>//***         Data Access Wordwide                                          ***
77200>>>>>//***         14 February 2000                                              ***
77200>>>>>//***                                                                       ***
77200>>>>>//*** Purpose:                                                              ***
77200>>>>>//***   Embedded SQL manager.                                               ***
77200>>>>>//***                                                                       ***
77200>>>>>//*** Changes:                                                              ***
77200>>>>>//***                                                                       ***
77200>>>>>//***   March 14, 2001. CLI Connectivity Kits 2.0.0.13                      ***
77200>>>>>//***       Allocate memory before call_driver command with spaces instead  ***
77200>>>>>//***       of binary zeroes.                                               ***
77200>>>>>//***                                                                       ***
77200>>>>>//*****************************************************************************
77200>>>>>
77200>>>>>Use UI
77200>>>>>Use CLI
77200>>>>>Use Case.mac
77200>>>>>
77200>>>>>//Doc/ Ignore=True
77200>>>>>//*** Global object handle for the manager
77200>>>>>Integer _embsqlghoSQLHandleMngr
77200>>>>>
77200>>>>>//*** Global stroage for results
77200>>>>>Integer SQLResult
77200>>>>>
77200>>>>>//*** Embedded SQL function constants
77200>>>>>Define FUNC_SQLCONNECT             For 1000000
77200>>>>>Define FUNC_SQLFILECONNECT         For 1000001
77200>>>>>Define FUNC_SQLDISCONNECT          For 1000002
77200>>>>>Define FUNC_SQLOPEN                For 1000003
77200>>>>>Define FUNC_SQLCLOSE               For 1000004
77200>>>>>Define FUNC_SQLPREPARE             For 1000005
77200>>>>>Define FUNC_SQLEXECUTE             For 1000006
77200>>>>>Define FUNC_SQLEXECDIRECT          For 1000007
77200>>>>>Define FUNC_SQLFETCH               For 1000008
77200>>>>>Define FUNC_SQLCOLUMNINFO          For 1000009
77200>>>>>Define FUNC_SQLCOLUMNVALUE         For 1000010
77200>>>>>Define FUNC_SQLBINDFILE            For 1000011
77200>>>>>Define FUNC_SQLGETDATA             For 1000012
77200>>>>>Define FUNC_SQLCOLSTRINGATTRIBLEN  For 1000013
77200>>>>>Define FUNC_SQLCOLSTRINGATTRIB     For 1000014
77200>>>>>Define FUNC_SQLCOLINTATTRIB        For 1000015
77200>>>>>Define FUNC_SQLSTMTINTATTRIB       For 1000016
77200>>>>>Define FUNC_SQLSETPROCNAME         For 1000017
77200>>>>>DEfine FUNC_SQLSETPROCARG          For 1000018
77200>>>>>Define FUNC_SQLCALL                For 1000019
77200>>>>>Define FUNC_SQLGETPROCARGLEN       For 1000020
77200>>>>>Define FUNC_SQLGETPROCARG          For 1000021
77200>>>>>Define FUNC_SQLGETPROCRETVALLEN    For 1000022
77200>>>>>Define FUNC_SQLGETPROCRETVAL       For 1000023
77200>>>>>Define FUNC_SQLNEXTRESULTSET       For 1000024
77200>>>>>Define FUNC_SQLBUFFERSTATUS        For 1000025
77200>>>>>
77200>>>>>//*** Embedded SQL statement attribute constants
77200>>>>>Define SQLSTMTATTRIB_COLUMNCOUNT    For 1
77200>>>>>Define SQLSTMTATTRIB_ROWCOUNT       For 2
77200>>>>>Define SQLSTMTATTRIB_ROWCOUNT_TYPE  For 3
77200>>>>>
77200>>>>>//*** Embedded SQL column attribute constants
77200>>>>>Define SQLCOLATTRIB_SIZE           For 1
77200>>>>>Define SQLCOLATTRIB_LENGTH         For 1
77200>>>>>Define SQLCOLATTRIB_PRECISION      For 2
77200>>>>>Define SQLCOLATTRIB_LABEL          For 3
77200>>>>>Define SQLCOLATTRIB_BASECOLUMNNAME For 4
77200>>>>>Define SQLCOLATTRIB_BASETABLENAME  For 5
77200>>>>>Define SQLCOLATTRIB_SQLTYPE        For 6
77200>>>>>Define SQLCOLATTRIB_NULLABLE       For 7
77200>>>>>Define SQLCOLATTRIB_DFTYPE         For 8
77200>>>>>
77200>>>>>//*** Possible SQL Column type values
77200>>>>>Define SQL_UNKNOWN_TYPE   For    0
77200>>>>>Define SQL_CHAR           For    1
77200>>>>>Define SQL_NUMERIC        For    2
77200>>>>>Define SQL_DECIMAL        For    3
77200>>>>>Define SQL_INTEGER        For    4
77200>>>>>Define SQL_SMALLINT       For    5
77200>>>>>Define SQL_FLOAT          For    6
77200>>>>>Define SQL_REAL           For    7
77200>>>>>Define SQL_DOUBLE         For    8
77200>>>>>Define SQL_DATETIME       For    9
77200>>>>>Define SQL_VARCHAR        For   12
77200>>>>>Define SQL_TYPE_DATE      For   91
77200>>>>>Define SQL_TYPE_TIME      For   92
77200>>>>>Define SQL_TYPE_TIMESTAMP For   93
77200>>>>>
77200>>>>>Define SQL_DATE           For    9
77200>>>>>Define SQL_INTERVAL       For   10
77200>>>>>Define SQL_TIME           For   10
77200>>>>>Define SQL_TIMESTAMP      For   11
77200>>>>>Define SQL_LONGVARCHAR    For  (-1)
77200>>>>>Define SQL_BINARY         For  (-2)
77200>>>>>Define SQL_VARBINARY      For  (-3)
77200>>>>>Define SQL_LONGVARBINARY  For  (-4)
77200>>>>>Define SQL_BIGINT         For  (-5)
77200>>>>>Define SQL_TINYINT        For  (-6)
77200>>>>>Define SQL_BIT            For  (-7)
77200>>>>>Define SQL_GUID           For (-11)
77200>>>>>
77200>>>>>
77200>>>>>
77200>>>>>//*****************************************************************************
77200>>>>>//*** Class  : cSQLStatement                                                ***
77200>>>>>//*** Purpose: Statement object for embedded sql                            ***
77200>>>>>//***                                                                       ***
77200>>>>>//*** Description:                                                          ***
77200>>>>>//***   An object is created for each statement. These will be children     ***
77200>>>>>//***   of cSQLConnection objects which manage the create and destruction   ***
77200>>>>>//***   of these.                                                           ***
77200>>>>>//*****************************************************************************
77200>>>>>
77200>>>>>Class cSQLStatement is an Array
77201>>>>>
77201>>>>>    Procedure Construct_object Integer Image
77203>>>>>        Forward Send Construct_object Image
77205>>>>>
77205>>>>>        Property Integer phCLIHandle      public 0
77206>>>>>        Property String  psDriverID       Public ""
77207>>>>>        Property Integer phStmtConnection Public 0
77208>>>>>        Property Integer piLastColumn     Public 0
77209>>>>>        Property Integer piLastArgument   Public 0
77210>>>>>        Property Integer piBindFile       Public 0
77211>>>>>
77211>>>>>        Set Delegation_mode To NO_Delegation
77212>>>>>    End_procedure // Construct_object
77213>>>>>
77213>>>>>
77213>>>>>
77213>>>>>    //***
77213>>>>>    //*** Procedure: StoreHandleInfo
77213>>>>>    //*** Purpose  : Store basic information about the statement handle.
77213>>>>>    //***
77213>>>>>
77213>>>>>    Procedure StoreHandleInfo Integer iCLIHandle String sDrvrId Integer iParentHandle
77215>>>>>        Set phCLIHandle      To iCLIHandle
77216>>>>>        Set psDriverID       To sDrvrId
77217>>>>>        Set phStmtConnection To iParentHandle
77218>>>>>    End_Procedure // StoreHandleInfo
77219>>>>>
77219>>>>>
77219>>>>>
77219>>>>>    //***
77219>>>>>    //*** Procedure: FreeHandle
77219>>>>>    //*** Purpose  : Free a handle. Since a handle is stored in an
77219>>>>>    //***            cSQLStatement object, we destroy the object.
77219>>>>>    //***
77219>>>>>
77219>>>>>    Procedure FreeHandle
77221>>>>>        Send Destroy_Object
77222>>>>>    End_Procedure // FreeHandle
77223>>>>>
77223>>>>>
77223>>>>>
77223>>>>>    //***
77223>>>>>    //*** Procedure: HandleError
77223>>>>>    //*** Puprose  : Handle an error that has occured while checking properties.
77223>>>>>    //***
77223>>>>>
77223>>>>>    Procedure HandleError Integer ihstmt Integer ihdbc String sDrvrId String sOriginMsg
77225>>>>>        Local Integer iErrHandle
77225>>>>>        Local Integer iErrNum
77225>>>>>        Local String  sLocationInfo
77225>>>>>
77225>>>>>        //*** Get the DataFlex statement identifier
77225>>>>>        Move Current_object To iErrHandle
77226>>>>>
77226>>>>>        //*** Determine error number
77226>>>>>        If (ihstmt = 0) ;            Move CLIERR_SQLINVALID_CLI_STMT_HANDLE To iErrNum
77229>>>>>        Else If (ihdbc = 0) ;            Move CLIERR_SQLINVALID_CLI_CONN_HANDLE To iErrNum
77233>>>>>        Else If (sDrvrId = "") ;            Move CLIERR_SQLINVALID_DRIVER_ID To iErrNum
77237>>>>>        Else ;            Move CLIERR_SQL_ERROR To iErrNum
77239>>>>>
77239>>>>>        //*** Create location ifnormation
77239>>>>>        Move "[" To sLocationInfo
77240>>>>>        If (sOriginMsg <> "") Begin
77242>>>>>            Move (Append(sLocationInfo, sOriginMsg)) To sLocationInfo
77243>>>>>            Move (Append(sLocationInfo, ", "))       To sLocationInfo
77244>>>>>        End
77244>>>>>>
77244>>>>>        Move (Append(sLocationInfo, "DataFlex hstmt = ")) To sLocationInfo
77245>>>>>        Move (Append(sLocationInfo, iErrHandle))          To sLocationInfo
77246>>>>>        Move (Append(sLocationInfo, "]"))                 To sLocationInfo
77247>>>>>
77247>>>>>        //*** Generate the error
77247>>>>>        Error iErrNum sLocationInfo
77248>>>>>>
77248>>>>>    End_Procedure // HandleError
77249>>>>>
77249>>>>>
77249>>>>>
77249>>>>>    //***
77249>>>>>    //*** Procedure: StmtError
77249>>>>>    //*** Purpose  : Handle general error not related to the properties
77249>>>>>    //***
77249>>>>>
77249>>>>>    Procedure StmtError Integer iErrNum String sErrText String sOriginMsg
77251>>>>>        Local Integer iErrHandle
77251>>>>>        Local String  sLocationInfo
77251>>>>>
77251>>>>>        //*** Get the DataFlex statement identifier
77251>>>>>        Move Current_object To iErrHandle
77252>>>>>
77252>>>>>
77252>>>>>        //*** Create location information
77252>>>>>        Move "[" To sLocationInfo
77253>>>>>        If (sOriginMsg <> "") Begin
77255>>>>>            Move (Append(sLocationInfo, sOriginMsg)) To sLocationInfo
77256>>>>>            Move (Append(sLocationInfo, ", "))       To sLocationInfo
77257>>>>>        End
77257>>>>>>
77257>>>>>        If (sErrtext <> "") Begin
77259>>>>>            Move (Append(sLocationInfo, sErrtext)) To sLocationInfo
77260>>>>>            Move (Append(sLocationInfo, ", "))     To sLocationInfo
77261>>>>>        End
77261>>>>>>
77261>>>>>        Move (Append(sLocationInfo, "DataFlex hstmt = ")) To sLocationInfo
77262>>>>>        Move (Append(sLocationInfo, iErrHandle))          To sLocationInfo
77263>>>>>        Move (Append(sLocationInfo, "]"))                 To sLocationInfo
77264>>>>>
77264>>>>>        //*** Generate the error
77264>>>>>        Error iErrNum sLocationInfo
77265>>>>>>
77265>>>>>    End_Procedure // StmtError
77266>>>>>
77266>>>>>
77266>>>>>
77266>>>>>    //***
77266>>>>>    //*** Procedure: SQLIllegalAttribute
77266>>>>>    //*** Purpose  : Handle an illegal attribute error
77266>>>>>    //***
77266>>>>>
77266>>>>>    Procedure SQLIllegalAttribute String sErrText String sOriginMsg
77268>>>>>        Local Integer bReport
77268>>>>>
77268>>>>>        Get_attribute DF_REPORT_UNSUPPORTED_ATTRIBUTES To bReport
77271>>>>>        If (bReport) ;            Send StmtError CLIERR_SQLINVALID_ATTRIBUTE sErrtext sOriginMsg
77274>>>>>    End_Procedure // SQLIllegalAttribute
77275>>>>>
77275>>>>>
77275>>>>>
77275>>>>>    //***
77275>>>>>    //*** Function: SQLPrivateColumnIsLegal
77275>>>>>    //*** Purpose : Check if a column number is legal
77275>>>>>    //***
77275>>>>>
77275>>>>>    Function SQLPrivateColumnIsLegal Integer ihdbc String sDrvrId Integer ihstmt Integer iCol Returns Integer
77277>>>>>        Local Integer bLegal
77277>>>>>        Local Integer iNumColumns
77277>>>>>
77277>>>>>        Get SQLPrivateStmtAttribute SQLSTMTATTRIB_COLUMNCOUNT ihdbc sDrvrId ihstmt To iNumColumns
77278>>>>>        If (iCol > 0 And iCol <= iNumColumns) ;            Move DFTRUE To bLegal
77281>>>>>        Else ;            Move DFFALSE To bLegal
77283>>>>>
77283>>>>>        Function_Return bLegal
77284>>>>>    End_Function // SQLPrivateColumnIsLegal
77285>>>>>
77285>>>>>
77285>>>>>
77285>>>>>    //***
77285>>>>>    //*** Procedure: SQLClose
77285>>>>>    //*** Purpose  : Close a statement and free all alllocated resources
77285>>>>>    //***
77285>>>>>
77285>>>>>    Procedure SQLClose
77287>>>>>        Local Integer ihdbc
77287>>>>>        Local Integer ihstmt
77287>>>>>        Local Integer iVoid
77287>>>>>        Local String  sDrvrId
77287>>>>>        Local String  sEmpty
77287>>>>>
77287>>>>>        //*** Initialize
77287>>>>>        Move "" To sEmpty
77288>>>>>
77288>>>>>        //*** Get the cli handle to the connection
77288>>>>>        Get phCLIHandle        To ihstmt
77289>>>>>        Get psDriverId         To sDrvrId
77290>>>>>        Get phStmtConnection   To ihdbc
77291>>>>>
77291>>>>>        //*** Free the CLI handle
77291>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77293>>>>>            //*** Call the driver function to close
77293>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCLOSE ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
77298>>>>>
77298>>>>>            //*** Free the DataFlex handle
77298>>>>>            Send FreeHandle
77299>>>>>        End
77299>>>>>>
77299>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLClose"
77301>>>>>    End_procedure // SQLClose
77302>>>>>
77302>>>>>
77302>>>>>
77302>>>>>    //***
77302>>>>>    //*** Procedure: SQLPrepare
77302>>>>>    //*** Purpose  : Prepare a statement for execution
77302>>>>>    //***
77302>>>>>
77302>>>>>    Procedure SQLPrepare String sStatement
77304>>>>>        Local Integer ihdbc
77304>>>>>        Local Integer ihstmt
77304>>>>>        Local Integer iVoid
77304>>>>>        Local String  sDrvrId
77304>>>>>
77304>>>>>        //*** Get the cli handle to the connection
77304>>>>>        Get phCLIHandle       To ihstmt
77305>>>>>        Get psDriverId        To sDrvrId
77306>>>>>        Get phStmtConnection  To ihdbc
77307>>>>>
77307>>>>>        //*** Prepare
77307>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77309>>>>>            //*** Call the driver function to prepare
77309>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLPREPARE ;                        Callback Current_Object ;                        Passing ihdbc sStatement ihstmt ;                        Result iVoid
77314>>>>>        End
77314>>>>>>
77314>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrepare"
77316>>>>>    End_procedure // SQLPrepare
77317>>>>>
77317>>>>>
77317>>>>>
77317>>>>>    //***
77317>>>>>    //*** Procedure: SQLExecute
77317>>>>>    //*** Purpose  : Execute a prepared statement
77317>>>>>    //***
77317>>>>>
77317>>>>>    Procedure SQLExecute
77319>>>>>        Local Integer ihdbc
77319>>>>>        Local Integer ihstmt
77319>>>>>        Local Integer iVoid
77319>>>>>        Local String  sDrvrId
77319>>>>>        Local String  sEmpty
77319>>>>>
77319>>>>>        //*** Initialize
77319>>>>>        Move "" To sEmpty
77320>>>>>
77320>>>>>        //*** Get the cli handle to the connection
77320>>>>>        Get phCLIHandle       To ihstmt
77321>>>>>        Get psDriverId        To sDrvrId
77322>>>>>        Get phStmtConnection  To ihdbc
77323>>>>>
77323>>>>>        //*** Execute
77323>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77325>>>>>            //*** Call the driver function to execute
77325>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLEXECUTE ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
77330>>>>>        End
77330>>>>>>
77330>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLExecute"
77332>>>>>    End_Procedure // SQLExecute
77333>>>>>
77333>>>>>
77333>>>>>
77333>>>>>    //***
77333>>>>>    //*** Procedure: SQLExecDirect
77333>>>>>    //*** Purpose  : Prepare and execute a statement
77333>>>>>    //***
77333>>>>>
77333>>>>>    Procedure SQLExecDirect String sStatement
77335>>>>>        Local Integer ihdbc
77335>>>>>        Local Integer ihstmt
77335>>>>>        Local Integer iVoid
77335>>>>>        Local String  sDrvrId
77335>>>>>
77335>>>>>        //*** Get the cli handle to the connection
77335>>>>>        Get phCLIHandle        To ihstmt
77336>>>>>        Get psDriverId         To sDrvrId
77337>>>>>        Get phStmtConnection   To ihdbc
77338>>>>>
77338>>>>>        //*** ExecDirect
77338>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77340>>>>>            //*** Call the driver function to execdirect
77340>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLEXECDIRECT ;                        Callback Current_Object ;                        Passing ihdbc sStatement ihstmt ;                        Result iVoid
77345>>>>>        End
77345>>>>>>
77345>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLExecDirect"
77347>>>>>    End_procedure // SQLExecDirect
77348>>>>>
77348>>>>>
77348>>>>>
77348>>>>>    //***
77348>>>>>    //*** Procedure: SQLFetch
77348>>>>>    //*** Purpose  : Fetch the next row
77348>>>>>    //*** Returns  : 0   = No more data
77348>>>>>    //***            <>0 = Success
77348>>>>>    //***
77348>>>>>
77348>>>>>    Function SQLFetch Returns Integer
77350>>>>>        Local Integer ihdbc
77350>>>>>        Local Integer ihstmt
77350>>>>>        Local Integer iResult
77350>>>>>        Local String  sDrvrId
77350>>>>>        Local String  sEmpty
77350>>>>>
77350>>>>>        //*** Initialize
77350>>>>>        Move "" To sEmpty
77351>>>>>        Move 0  To iResult
77352>>>>>
77352>>>>>        //*** Get the cli handle to the connection
77352>>>>>        Get phCLIHandle        To ihstmt
77353>>>>>        Get psDriverId         To sDrvrId
77354>>>>>        Get phStmtConnection   To ihdbc
77355>>>>>
77355>>>>>        //*** Fetch
77355>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77357>>>>>            Indicate Err False
77358>>>>>
77358>>>>>            //*** Call the driver function to fetch
77358>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLFETCH ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt ;                        Result iResult
77363>>>>>
77363>>>>>            //*** If something went wrong, adjust the result
77363>>>>>            If (Err) ;                Move 0 To iResult
77366>>>>>
77366>>>>>            Set piLastcolumn To 0
77367>>>>>        End
77367>>>>>>
77367>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLFetch"
77369>>>>>
77369>>>>>        Function_return iResult
77370>>>>>    End_Function // SQLFetch
77371>>>>>
77371>>>>>
77371>>>>>
77371>>>>>    //***
77371>>>>>    //*** Function: SQLNextColumn
77371>>>>>    //*** Purpose : Get the next column
77371>>>>>    //***
77371>>>>>
77371>>>>>    Function SQLNextColumn Returns String
77373>>>>>        Local Integer iCol
77373>>>>>        Local String  sResult
77373>>>>>
77373>>>>>        Get piLastColumn To iCol
77374>>>>>        Increment iCol
77375>>>>>        Get SQLColumnValue iCol To sResult
77376>>>>>        Set piLastColumn To iCol
77377>>>>>
77377>>>>>        Function_return sResult
77378>>>>>    End_Function // SQLNextColumn
77379>>>>>
77379>>>>>
77379>>>>>
77379>>>>>    //***
77379>>>>>    //*** Function: SQLColumnValue
77379>>>>>    //*** Purpose : Return the value of a column in a fetched row of a given
77379>>>>>    //***           statement.
77379>>>>>    //***
77379>>>>>
77379>>>>>    Function SQLColumnValue Integer iCol Returns String
77381>>>>>        Local Integer ihdbc
77381>>>>>        Local Integer ihstmt
77381>>>>>        Local String  sDrvrId
77381>>>>>        Local String  sResult
77381>>>>>
77381>>>>>        //*** Initialize
77381>>>>>        Move "" To sResult
77382>>>>>
77382>>>>>        //*** Get the cli handle to the connection
77382>>>>>        Get phCLIHandle       To ihstmt
77383>>>>>        Get psDriverId        To sDrvrId
77384>>>>>        Get phStmtConnection  To ihdbc
77385>>>>>
77385>>>>>        //*** Get the value
77385>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateColumnValue iCol ihdbc sDRvrId ihstmt To sResult
77388>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLColumnValue"
77390>>>>>
77390>>>>>        Function_return sResult
77391>>>>>    End_Function // SQLColumnValue
77392>>>>>
77392>>>>>    Function SQLPrivateColumnValue Integer iCol Integer ihdbc String sDrvrId Integer ihstmt Returns String
77394>>>>>        Local Integer iVoid
77394>>>>>        Local Integer iColSize
77394>>>>>        Local String  sResult
77394>>>>>        Local String  sEmpty
77394>>>>>        Local Integer bLegalColumn
77394>>>>>
77394>>>>>        //*** Initialize
77394>>>>>        Move "" To sEmpty
77395>>>>>
77395>>>>>        //*** Get the value
77395>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77397>>>>>            //*** Check if the column exists
77397>>>>>            Get SQLPrivateColumnIsLegal ihdbc sDrvrId ihstmt iCol To bLegalColumn
77398>>>>>            If (bLegalColumn) Begin
77400>>>>>                //*** Determine the column size
77400>>>>>                Get SQLPrivateColAttribute iCol SQLCOLATTRIB_SIZE ihdbc sDrvrId ihstmt To iColSize
77401>>>>>                If (iColSize > 0) Begin
77403>>>>>                    //*** Setup function arguments
77403>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                Callback Current_Object ;                                Passing ihdbc iCol ihstmt ;                                Result iVoid
77408>>>>>
77408>>>>>                    //*** Allocate
77408>>>>>                    Move (Repeat(' ', iColSize)) To sResult
77409>>>>>
77409>>>>>                    //*** Call the driver function to get the value
77409>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNVALUE ;                                Callback Current_Object ;                                Passing sResult sEmpty 0 ;                                Result iVoid
77414>>>>>                End
77414>>>>>>
77414>>>>>            End
77414>>>>>>
77414>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLPrivateColumnValue"
77416>>>>>        End
77416>>>>>>
77416>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateColumnValue"
77418>>>>>
77418>>>>>        Function_return sResult
77419>>>>>    End_Function // SQLColumnValue
77420>>>>>
77420>>>>>
77420>>>>>
77420>>>>>    //***
77420>>>>>    //*** Procedure: SQLBindFile
77420>>>>>    //*** Purpose  : Add a file to the files used to place the statement result in.
77420>>>>>    //***
77420>>>>>
77420>>>>>    Procedure SQLBindFile Integer iFileNum
77422>>>>>        Local Integer ihdbc
77422>>>>>        Local Integer ihstmt
77422>>>>>        Local Integer iVoid
77422>>>>>        Local String  sDrvrId
77422>>>>>        Local String  sFileType
77422>>>>>        Local Integer bIsOpen
77422>>>>>
77422>>>>>        //*** Get the cli handle to the connection
77422>>>>>        Get phCLIHandle       To ihstmt
77423>>>>>        Get psDriverId        To sDrvrId
77424>>>>>        Get phStmtConnection  To ihdbc
77425>>>>>
77425>>>>>        //*** If a file number is not passed see if we can use the statement's
77425>>>>>        //*** default file number which is usually set with SetFileConnection
77425>>>>>        If (iFileNum = 0) Begin
77427>>>>>            Get piBindFile To iFileNum
77428>>>>>            If (iFileNum = 0) Begin
77430>>>>>                //*** Logic error, if 0 is passed as filenumber, piBindFile should be set.
77430>>>>>                Send StmtError CLIERR_SQLINVALID_BIND_FILE "piBindFile should be set" "SQLBindFile"
77431>>>>>
77431>>>>>                Move 0 to SQLResult
77432>>>>>                Procedure_Return
77433>>>>>            End
77433>>>>>>
77433>>>>>        End
77433>>>>>>
77433>>>>>
77433>>>>>        //*** Bind the file
77433>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77435>>>>>            //*** Chek if the file is open
77435>>>>>            Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
77438>>>>>            If (bIsOpen) Begin
77440>>>>>                //*** Check if the file has the correct type
77440>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sFileType
77443>>>>>                If (sFileType = sDrvrId) Begin
77445>>>>>                    //*** Call the driver function to add a file to a statement
77445>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLBINDFILE ;                                Callback Current_Object ;                                Passing ihdbc iFileNum ihstmt ;                                Result iVoid
77450>>>>>                End
77450>>>>>>
77450>>>>>                Else ;                    Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File" * String(iFileNum) * "type incompatible with statement ("  + sFileType + ")") "SQLBindFile"
77452>>>>>            End
77452>>>>>>
77452>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File not open (number =" * String(iFileNum) + ")") "SQLBindFile"
77454>>>>>        End
77454>>>>>>
77454>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLBindFile"
77456>>>>>    End_Procedure // SQLBindFile
77457>>>>>
77457>>>>>
77457>>>>>
77457>>>>>    //*************************************************************************
77457>>>>>    //*** Function: SQLGetData                                              ***
77457>>>>>    //*** Purpose : Get data of a column.                                   ***
77457>>>>>    //*************************************************************************
77457>>>>>
77457>>>>>    Function SQLGetData Integer iCol Integer iLen Returns String
77459>>>>>        Local Integer ihdbc
77459>>>>>        Local Integer ihstmt
77459>>>>>        Local Integer iVoid
77459>>>>>        Local Integer iColSize
77459>>>>>        Local Integer iResult
77459>>>>>        Local String  sDrvrId
77459>>>>>        Local String  sResult
77459>>>>>        Local String  sEmpty
77459>>>>>        Local Integer bLegalColumn
77459>>>>>
77459>>>>>        //*** Initialize
77459>>>>>        Move "" To sEmpty
77460>>>>>        Move 0 To iResult
77461>>>>>
77461>>>>>        //*** Get the cli handle to the connection
77461>>>>>        Get phCLIHandle       To ihstmt
77462>>>>>        Get psDriverId        To sDrvrId
77463>>>>>        Get phStmtConnection  To ihdbc
77464>>>>>
77464>>>>>        //*** Get the data
77464>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77466>>>>>            //*** Check if the column exists
77466>>>>>            Get SQLPrivateColumnIsLegal ihdbc sDrvrId ihstmt iCol To bLegalColumn
77467>>>>>            If (bLegalColumn) Begin
77469>>>>>                If (iLen = 0) ;                    Get SQLPrivateColumnValue iCol ihdbc sDrvrId ihstmt To sResult
77472>>>>>                Else Begin
77473>>>>>                    //*** Setup function arguments
77473>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                Callback Current_Object ;                                Passing ihdbc iCol ihstmt ;                                Result iVoid
77478>>>>>
77478>>>>>                    //*** Allocate
77478>>>>>                    Move (Repeat(' ', iLen)) To sResult
77479>>>>>
77479>>>>>                    Indicate Err False
77480>>>>>
77480>>>>>                    //*** Call the driver function to get the data
77480>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLGETDATA ;                                Callback Current_Object ;                                Passing sResult sEmpty iLen ;                                Result iResult
77485>>>>>
77485>>>>>                    //*** If something went wrong, adjust the result
77485>>>>>                    If (Err) ;                        Move 0 To iResult
77488>>>>>                End
77488>>>>>>
77488>>>>>            End
77488>>>>>>
77488>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLGetData"
77490>>>>>        End
77490>>>>>>
77490>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLGetData"
77492>>>>>
77492>>>>>        //*** Fill global result
77492>>>>>        Move iResult To SQLResult
77493>>>>>
77493>>>>>        Function_Return sResult
77494>>>>>    End_Function // SQLGetData
77495>>>>>
77495>>>>>
77495>>>>>
77495>>>>>    //***
77495>>>>>    //*** Function: SQLColumnMap
77495>>>>>    //*** Purpose : Map a column name to a number, if the name id not found no
77495>>>>>    //***           error is generated the returned number will be 0 (zero) in
77495>>>>>    //***           that case
77495>>>>>    //***
77495>>>>>
77495>>>>>    Function SQLColumnMap String sColname Returns Integer
77497>>>>>        Local Integer ihdbc
77497>>>>>        Local Integer ihstmt
77497>>>>>        Local Integer iNumColumns
77497>>>>>        Local Integer iColCount
77497>>>>>        Local Integer iColNum
77497>>>>>        Local String  sDrvrId
77497>>>>>        Local String  sCurColName
77497>>>>>
77497>>>>>        //*** Get the cli handle to the connection
77497>>>>>        Get phCLIHandle       To ihstmt
77498>>>>>        Get psDriverId        To sDrvrId
77499>>>>>        Get phStmtConnection  To ihdbc
77500>>>>>
77500>>>>>        //*** Get the number by looping through the column names
77500>>>>>        Move 0 To iColNum
77501>>>>>        Get SQLPrivateStmtAttribute SQLSTMTATTRIB_COLUMNCOUNT ihdbc sDrvrId ihstmt To iNumColumns
77502>>>>>        For iColCount From 1 To iNumColumns
77508>>>>>>
77508>>>>>            Get SQLPrivateColAttribute iColCount SQLCOLATTRIB_LABEL ihdbc sDrvrId ihstmt To sCurColName
77509>>>>>            If (Uppercase(Trim(sColName)) = Uppercase(Trim(sCurColName))) ;                Move iColCount To iColNum
77512>>>>>
77512>>>>>            If (iColNum) ;                Break
77515>>>>>        Loop
77516>>>>>>
77516>>>>>
77516>>>>>        Function_return iColNum
77517>>>>>    End_Function // SQLColumnMap
77518>>>>>
77518>>>>>
77518>>>>>
77518>>>>>    //***
77518>>>>>    //*** Function: SQLStmtAttribute
77518>>>>>    //*** Purpose : Get a statement attribute
77518>>>>>    //***
77518>>>>>
77518>>>>>    Function SQLStmtAttribute Integer iAttribId Returns String
77520>>>>>        Local Integer ihdbc
77520>>>>>        Local Integer ihstmt
77520>>>>>        Local String  sResult
77520>>>>>        Local String  sDrvrId
77520>>>>>
77520>>>>>        //*** Initialize
77520>>>>>        Move "" To sResult
77521>>>>>
77521>>>>>        //*** Get the cli handle to the connection
77521>>>>>        Get phCLIHandle       To ihstmt
77522>>>>>        Get psDriverId        To sDrvrId
77523>>>>>        Get phStmtConnection  To ihdbc
77524>>>>>
77524>>>>>        //*** Get the attribute
77524>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateStmtAttribute iAttribId ihdbc sDrvrId ihstmt To sResult
77527>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLStmtAttribute"
77529>>>>>
77529>>>>>        Function_Return sResult
77530>>>>>    End_Function // SQLStmtAttibute
77531>>>>>
77531>>>>>    Function SQLPrivateStmtAttribute Integer iAttribId Integer ihdbc String sDrvrId Integer ihstmt Returns String
77533>>>>>        Local String  sResult
77533>>>>>        Local Integer iLen
77533>>>>>        Local Integer bLegalAttrib
77533>>>>>
77533>>>>>        //*** Initialize
77533>>>>>        Move ""     To sResult
77534>>>>>
77534>>>>>        //*** Get the attribute
77534>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77536>>>>>            Case Begin
77536>>>>>                Case (iAttribId = SQLSTMTATTRIB_COLUMNCOUNT)
77538>>>>>                Case (iAttribId = SQLSTMTATTRIB_ROWCOUNT)
77541>>>>>                Case (iAttribId = SQLSTMTATTRIB_ROWCOUNT_TYPE)
77544>>>>>                    Move DFTRUE To bLegalAttrib
77545>>>>>                    Break
77546>>>>>
77546>>>>>                Case Else
77546>>>>>                    Move DFFALSE To bLegalAttrib
77547>>>>>                    Send SQLIllegalAttribute ("Attribute is = " + String(iAttribId) + ")") "SQLPrivateStmtAttribute"
77548>>>>>            Case End
77548>>>>>
77548>>>>>            If (bLegalAttrib) Begin
77550>>>>>                //*** Setup function arguments
77550>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLSTMTINTATTRIB ;                            Callback Current_Object ;                            Passing ihdbc iAttribId ihstmt ;                            Result sResult
77555>>>>>            End
77555>>>>>>
77555>>>>>        End
77555>>>>>>
77555>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateStmtAttribute"
77557>>>>>
77557>>>>>        Function_Return sResult
77558>>>>>    End_Function // SQLPrivateStmtAttribute
77559>>>>>
77559>>>>>
77559>>>>>
77559>>>>>    //***
77559>>>>>    //*** Function: SQLColAttribute
77559>>>>>    //*** Purpose : Get a column's attribute
77559>>>>>    //***
77559>>>>>
77559>>>>>    Function SQLColAttribute Integer iCol Integer iAttribId Returns String
77561>>>>>        Local Integer ihdbc
77561>>>>>        Local Integer ihstmt
77561>>>>>        Local String  sResult
77561>>>>>        Local String  sDrvrId
77561>>>>>
77561>>>>>        //*** Initialize
77561>>>>>        Move "" To sResult
77562>>>>>
77562>>>>>        //*** Get the cli handle to the connection
77562>>>>>        Get phCLIHandle       To ihstmt
77563>>>>>        Get psDriverId        To sDrvrId
77564>>>>>        Get phStmtConnection  To ihdbc
77565>>>>>
77565>>>>>        //*** Get the attribute
77565>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateColAttribute iCol iAttribId ihdbc sDrvrId ihstmt To sResult
77568>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLColAttribute"
77570>>>>>
77570>>>>>        Function_Return sResult
77571>>>>>    End_Function // SQLColAttribute
77572>>>>>
77572>>>>>    Function SQLPrivateColAttribute Integer iCol Integer iAttribId Integer ihdbc String sDrvrId Integer ihstmt Returns String
77574>>>>>        Local String  sResult
77574>>>>>        Local String  sEmpty
77574>>>>>        Local Integer bIsStringAttribute
77574>>>>>        Local Integer iLen
77574>>>>>        Local Integer iVoid
77574>>>>>        Local Integer bLegalAttrib
77574>>>>>        Local Integer bLegalColumn
77574>>>>>
77574>>>>>        //*** Initialize
77574>>>>>        Move "" To sResult
77575>>>>>        Move "" To sEmpty
77576>>>>>        MOve 0  To iLen
77577>>>>>
77577>>>>>        //*** Get the attribute
77577>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77579>>>>>            Get SQLPrivateColumnIsLegal ihdbc sDrvrId ihstmt iCol To bLegalColumn
77580>>>>>            If (bLegalColumn) Begin
77582>>>>>                //*** Determine the atributes type
77582>>>>>                Case Begin
77582>>>>>                    Case (iAttribId = SQLCOLATTRIB_SIZE)
77584>>>>>                    Case (iAttribId = SQLCOLATTRIB_LENGTH)
77587>>>>>                    Case (iAttribId = SQLCOLATTRIB_PRECISION)
77590>>>>>                    Case (iAttribId = SQLCOLATTRIB_SQLTYPE)
77593>>>>>                    Case (iAttribId = SQLCOLATTRIB_NULLABLE)
77596>>>>>                    Case (iAttribId = SQLCOLATTRIB_DFTYPE)
77599>>>>>                        Move DFFALSE To bIsStringAttribute
77600>>>>>                        Move DFTRUE To bLegalAttrib
77601>>>>>                        Break
77602>>>>>
77602>>>>>                    Case (iAttribId = SQLCOLATTRIB_LABEL)
77605>>>>>                    Case (iAttribId = SQLCOLATTRIB_BASECOLUMNNAME)
77608>>>>>                    Case (iAttribId = SQLCOLATTRIB_BASETABLENAME)
77611>>>>>                        Move DFTRUE To bIsStringAttribute
77612>>>>>                        Move DFTRUE To bLegalAttrib
77613>>>>>                        Break
77614>>>>>
77614>>>>>                    Case Else
77614>>>>>                        Move DFFALSE To bLegalAttrib
77615>>>>>                        Send SQLIllegalAttribute ("Attribute is = " + String(iAttribId) + ")") "SQLPrivateColAttribute"
77616>>>>>                Case End
77616>>>>>
77616>>>>>                If (bLegalAttrib) Begin
77618>>>>>                    //*** Setup function arguments
77618>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                Callback Current_Object ;                                Passing ihdbc iCol ihstmt ;                                Result iVoid
77623>>>>>
77623>>>>>                    If (bIsStringAttribute) Begin
77625>>>>>                        //*** Call the driver function to get the data length
77625>>>>>                        Call_driver 0 sDrvrId Function FUNC_SQLCOLSTRINGATTRIBLEN ;                                    Callback Current_Object ;                                    Passing sEmpty sEmpty iAttribId ;                                    Result iLen
77630>>>>>
77630>>>>>                        If (iLen) Begin
77632>>>>>                            //*** Allocate
77632>>>>>                            Move (Repeat(' ', iLen)) To sResult
77633>>>>>
77633>>>>>                            //*** Call the driver function to get the name
77633>>>>>                            Call_driver 0 sDrvrId Function FUNC_SQLCOLSTRINGATTRIB ;                                        Callback Current_Object ;                                        Passing sResult sEmpty iAttribId ;                                        Result iVoid
77638>>>>>                        End
77638>>>>>>
77638>>>>>                    End
77638>>>>>>
77638>>>>>                    Else Begin
77639>>>>>                        //*** get the attribute
77639>>>>>                        Call_driver 0 sDrvrId Function FUNC_SQLCOLINTATTRIB ;                                    Callback Current_Object ;                                    Passing sEmpty sEmpty iAttribId ;                                    Result sResult
77644>>>>>                    End
77644>>>>>>
77644>>>>>                End
77644>>>>>>
77644>>>>>            End
77644>>>>>>
77644>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLPrivateColAttribute"
77646>>>>>        End
77646>>>>>>
77646>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateColAttribute"
77648>>>>>
77648>>>>>        Function_Return sResult
77649>>>>>    End_Function // SQLPrivateColAttribute
77650>>>>>
77650>>>>>
77650>>>>>
77650>>>>>    //***
77650>>>>>    //*** Procedure: SQLSetProcedureName
77650>>>>>    //*** Purpsoe  : Preapre for calling a stored procedure, pass the procedure name.
77650>>>>>    //***
77650>>>>>
77650>>>>>    Procedure SQLSetProcedureName String sProcName
77652>>>>>        Local Integer ihdbc
77652>>>>>        Local Integer ihstmt
77652>>>>>        Local String  sDrvrId
77652>>>>>        Local Integer iVoid
77652>>>>>        Local String  sEmpty
77652>>>>>
77652>>>>>        //*** Initialize
77652>>>>>        Move "" To sEmpty
77653>>>>>
77653>>>>>        //*** Get the cli handle to the connection
77653>>>>>        Get phCLIHandle       To ihstmt
77654>>>>>        Get psDriverId        To sDrvrId
77655>>>>>        Get phStmtConnection  To ihdbc
77656>>>>>
77656>>>>>        //*** Call the procedure
77656>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77658>>>>>            //*** Call the procedure
77658>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLSETPROCNAME ;                        Callback Current_Object ;                        Passing ihdbc sProcName ihstmt ;                        Result iVoid
77663>>>>>
77663>>>>>            Set piLastArgument To 0
77664>>>>>        End
77664>>>>>>
77664>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLSetProcedurename"
77666>>>>>    End_Procedure // SQLSetProcedureName
77667>>>>>
77667>>>>>
77667>>>>>
77667>>>>>    //***
77667>>>>>    //*** Function: SQLSetNextArgument
77667>>>>>    //*** Purpose : Pass the next argument
77667>>>>>    //***
77667>>>>>
77667>>>>>    Procedure SQLSetNextArgument String sArgument
77669>>>>>        Local Integer iArgnum
77669>>>>>
77669>>>>>        Get piLastArgument To iArgnum
77670>>>>>        Increment iArgnum
77671>>>>>        Send SQLSetArgument iArgnum sArgument
77672>>>>>        Set piLastArgument To iArgnum
77673>>>>>    End_Procedure // SQLSetNextArgument
77674>>>>>
77674>>>>>
77674>>>>>
77674>>>>>    //***
77674>>>>>    //*** Procedure: SQLSetArgument
77674>>>>>    //*** Purpose  : Set the next argument
77674>>>>>    //***
77674>>>>>
77674>>>>>    Procedure SQLSetArgument Integer iArgnum String sArgument
77676>>>>>        Local Integer ihdbc
77676>>>>>        Local Integer ihstmt
77676>>>>>        Local String  sDrvrId
77676>>>>>        Local Integer iVoid
77676>>>>>        Local String  sEmpty
77676>>>>>
77676>>>>>        //*** Initialize
77676>>>>>        Move "" To sEmpty
77677>>>>>
77677>>>>>        //*** Get the cli handle to the connection
77677>>>>>        Get phCLIHandle       To ihstmt
77678>>>>>        Get psDriverId        To sDrvrId
77679>>>>>        Get phStmtConnection  To ihdbc
77680>>>>>
77680>>>>>        //*** Call the procedure
77680>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77682>>>>>            //*** Pass the information
77682>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback Current_Object ;                        Passing ihdbc iArgnum ihstmt ;                        Result iVoid
77687>>>>>
77687>>>>>            //*** Pass the argument
77687>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLSETPROCARG ;                        Callback Current_Object ;                        Passing sArgument sEmpty 0 ;                        Result iVoid
77692>>>>>        End
77692>>>>>>
77692>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLSetArgument"
77694>>>>>    End_Procedure // SQLSetArgument
77695>>>>>
77695>>>>>
77695>>>>>
77695>>>>>    //***
77695>>>>>    //*** Procedure: SQLCall
77695>>>>>    //*** Purpose  : Call a stored procedure
77695>>>>>    //***
77695>>>>>
77695>>>>>    Procedure SQLCall
77697>>>>>        Local Integer ihdbc
77697>>>>>        Local Integer ihstmt
77697>>>>>        Local String  sDrvrId
77697>>>>>        Local Integer iVoid
77697>>>>>        Local String  sEmpty
77697>>>>>
77697>>>>>        //*** Initialize
77697>>>>>        Move "" To sEmpty
77698>>>>>
77698>>>>>        //*** Get the cli handle to the connection
77698>>>>>        Get phCLIHandle       To ihstmt
77699>>>>>        Get psDriverId        To sDrvrId
77700>>>>>        Get phStmtConnection  To ihdbc
77701>>>>>
77701>>>>>        //*** Call the procedure
77701>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77703>>>>>            //*** Call the procedure
77703>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCALL ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
77708>>>>>
77708>>>>>            Set piLastArgument To 0
77709>>>>>        End
77709>>>>>>
77709>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLCall"
77711>>>>>    End_Procedure // SQLCall
77712>>>>>
77712>>>>>
77712>>>>>
77712>>>>>    //***
77712>>>>>    //*** Function: SQLGetNextArgument
77712>>>>>    //*** Purpose : Get the next argument
77712>>>>>    //***
77712>>>>>
77712>>>>>    Function SQLGetNextArgument Returns String
77714>>>>>        Local Integer iArgnum
77714>>>>>        Local String  sResult
77714>>>>>
77714>>>>>        Get piLastArgument To iArgnum
77715>>>>>        Increment iArgnum
77716>>>>>        Get SQLGetArgument iArgnum To sResult
77717>>>>>        Set piLastArgument To iArgnum
77718>>>>>
77718>>>>>        Function_return sResult
77719>>>>>    End_Function // SQLGetNextArgument
77720>>>>>
77720>>>>>
77720>>>>>
77720>>>>>    //***
77720>>>>>    //*** Function: SQLGetArgument
77720>>>>>    //*** Purpose : Get the specified argument from a procedure
77720>>>>>    //***
77720>>>>>
77720>>>>>    Function SQLGetArgument Integer iArgnum Returns String
77722>>>>>        Local Integer ihdbc
77722>>>>>        Local Integer ihstmt
77722>>>>>        Local String  sDrvrId
77722>>>>>        Local Integer iVoid
77722>>>>>        Local String  sEmpty
77722>>>>>        Local String  sArgument
77722>>>>>        Local Integer iLen
77722>>>>>
77722>>>>>        //*** Initialize
77722>>>>>        Move "" To sEmpty
77723>>>>>        Move "" To sArgument
77724>>>>>
77724>>>>>        //*** Get the cli handle to the connection
77724>>>>>        Get phCLIHandle       To ihstmt
77725>>>>>        Get psDriverId        To sDrvrId
77726>>>>>        Get phStmtConnection  To ihdbc
77727>>>>>
77727>>>>>        //*** Call the procedure
77727>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77729>>>>>            //*** Pass the information
77729>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback Current_Object ;                        Passing ihdbc iArgnum ihstmt ;                        Result iVoid
77734>>>>>
77734>>>>>            //*** Get the length
77734>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLGETPROCARGLEN ;                        Callback Current_Object ;                        Passing sEmpty sEmpty 0 ;                        Result iLen
77739>>>>>
77739>>>>>            If (iLen) Begin
77741>>>>>                //*** Allocate
77741>>>>>                Move (Repeat(' ', iLen)) To sArgument
77742>>>>>
77742>>>>>                //*** Pass the argument
77742>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLGETPROCARG ;                            Callback Current_Object ;                            Passing sArgument sEmpty 0 ;                            Result iVoid
77747>>>>>            End
77747>>>>>>
77747>>>>>        End
77747>>>>>>
77747>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLGetArgument"
77749>>>>>
77749>>>>>        Function_Return sArgument
77750>>>>>    End_Function // SQLGetArgument
77751>>>>>
77751>>>>>
77751>>>>>
77751>>>>>    //***
77751>>>>>    //*** Function: SQLReturnValue
77751>>>>>    //*** Purpose : Get the reutn value of a stored function
77751>>>>>    //***
77751>>>>>
77751>>>>>    Function SQLReturnValue Returns String
77753>>>>>        Local Integer ihdbc
77753>>>>>        Local Integer ihstmt
77753>>>>>        Local String  sDrvrId
77753>>>>>        Local Integer iVoid
77753>>>>>        Local String  sEmpty
77753>>>>>        Local String  sRetval
77753>>>>>        Local Integer iLen
77753>>>>>
77753>>>>>        //*** Initialize
77753>>>>>        Move "" To sEmpty
77754>>>>>        Move "" To sRetval
77755>>>>>
77755>>>>>        //*** Get the cli handle to the connection
77755>>>>>        Get phCLIHandle       To ihstmt
77756>>>>>        Get psDriverId        To sDrvrId
77757>>>>>        Get phStmtConnection  To ihdbc
77758>>>>>
77758>>>>>        //*** Call the procedure
77758>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77760>>>>>            //*** Get the length
77760>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLGETPROCRETVALLEN ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt  ;                        Result iLen
77765>>>>>
77765>>>>>            If (iLen) Begin
77767>>>>>                //*** Allocate
77767>>>>>                Move (Repeat(' ', iLen)) To sRetval
77768>>>>>
77768>>>>>                //*** Pass the argument
77768>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLGETPROCRETVAL ;                            Callback Current_Object ;                            Passing ihdbc sRetval ihstmt ;                            Result iVoid
77773>>>>>            End
77773>>>>>>
77773>>>>>        End
77773>>>>>>
77773>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLReturnValue"
77775>>>>>
77775>>>>>        Function_Return sRetval
77776>>>>>    End_Function // SQLReturnValue
77777>>>>>
77777>>>>>
77777>>>>>
77777>>>>>    //***
77777>>>>>    //*** Function: SQLNextResultSet
77777>>>>>    //*** Purpose : Switch to the next set
77777>>>>>    //*** Returns : 0   = No more result sets
77777>>>>>    //***           <>0 = Switched to next set
77777>>>>>    //***
77777>>>>>
77777>>>>>    Function SQLNextResultSet Returns Integer
77779>>>>>        Local Integer ihdbc
77779>>>>>        Local Integer ihstmt
77779>>>>>        Local String  sDrvrId
77779>>>>>        Local String  sEmpty
77779>>>>>        Local Integer iResult
77779>>>>>
77779>>>>>        //*** Initialize
77779>>>>>        Move "" To sEmpty
77780>>>>>        Move 0  To iResult
77781>>>>>
77781>>>>>        //*** Get the cli handle to the connection
77781>>>>>        Get phCLIHandle       To ihstmt
77782>>>>>        Get psDriverId        To sDrvrId
77783>>>>>        Get phStmtConnection  To ihdbc
77784>>>>>
77784>>>>>        //*** Call the procedure
77784>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77786>>>>>            //*** Get the length
77786>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLNEXTRESULTSET ;                        Callback Current_Object ;                        Passing ihdbc sEmpty ihstmt  ;                        Result iResult
77791>>>>>
77791>>>>>            Set piLastArgument To 0
77792>>>>>        End
77792>>>>>>
77792>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLNextResultSet"
77794>>>>>
77794>>>>>        Function_Return iResult
77795>>>>>    End_Function // SQLNextResultSet
77796>>>>>
77796>>>>>
77796>>>>>
77796>>>>>    //***
77796>>>>>    //*** Procedure: SQLFetchActivatesBuffer
77796>>>>>    //*** Purpose  : Setup a file that will be acivated after a succesfull
77796>>>>>    //***            fetch on the statement
77796>>>>>    //***
77796>>>>>
77796>>>>>    Procedure SQLFetchActivatesBuffer Integer iFileNum Integer bState
77798>>>>>        Local Integer ihdbc
77798>>>>>        Local Integer ihstmt
77798>>>>>        Local String  sDrvrId
77798>>>>>        Local Integer iResult
77798>>>>>        Local Integer bIsOpen
77798>>>>>        Local Integer iVoid
77798>>>>>        Local String  sFileType
77798>>>>>
77798>>>>>        //*** Check if file is open
77798>>>>>        Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
77801>>>>>        If (bIsOpen) Begin
77803>>>>>            //*** Get the cli handle to the connection
77803>>>>>            Get phCLIHandle       To ihstmt
77804>>>>>            Get psDriverId        To sDrvrId
77805>>>>>            Get phStmtConnection  To ihdbc
77806>>>>>
77806>>>>>            //*** Call the procedure
77806>>>>>            If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77808>>>>>                //*** Check if the file has the correct type
77808>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sFileType
77811>>>>>                If (sFileType = sDrvrId) Begin
77813>>>>>                    //*** Setup the buffer
77813>>>>>                    Call_driver iFileNum sDrvrId Function FUNC_SQLBUFFERSTATUS ;                                Callback Current_Object ;                                Passing ihdbc bState ihstmt  ;                                Result iVoid
77818>>>>>                End
77818>>>>>>
77818>>>>>                Else ;                    Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File" * String(iFileNum) * "type incompatible with statement ("  + sFileType + ")") "SQLBindFile"
77820>>>>>            End
77820>>>>>>
77820>>>>>            Else ;                Send HandleError ihstmt ihdbc sDrvrId "SQLFetchActivatesBuffer"
77822>>>>>        End
77822>>>>>>
77822>>>>>        Else ;            Send StmtError CLIERR_SQLINVALID_BUFFER ("File not open (number =" * String(iFileNum) + ")") "SQLFetchActivatesBuffer"
77824>>>>>    End_Procedure // SQLFetchActivatesBuffer
77825>>>>>
77825>>>>>End_Class // cSQLStatement
77826>>>>>
77826>>>>>
77826>>>>>//*****************************************************************************
77826>>>>>//*** Class  : cSQLConnection                                               ***
77826>>>>>//*** Purpose: Connection object for embedded SQL                           ***
77826>>>>>//***                                                                       ***
77826>>>>>//*** Description:                                                          ***
77826>>>>>//***   This provides the ability to create a connection for a driver.      ***
77826>>>>>//***   It will contain child statement objects                             ***
77826>>>>>//*****************************************************************************
77826>>>>>
77826>>>>>Class cSQLConnection is an Array
77827>>>>>
77827>>>>>    Procedure Construct_object Integer Image
77829>>>>>        Forward Send Construct_object Image
77831>>>>>
77831>>>>>        Property Integer phCLIHandle      Public 0
77832>>>>>        Property String  psDriverID       Public ""
77833>>>>>        Property Integer piBindFile       Public 0
77834>>>>>
77834>>>>>        Set Delegation_mode to NO_Delegation
77835>>>>>    End_procedure // COnstruct_object
77836>>>>>
77836>>>>>
77836>>>>>
77836>>>>>    //***
77836>>>>>    //*** Procedure: StoreHandleInfo
77836>>>>>    //*** Purpose  : Store basic information about the statement handle.
77836>>>>>    //***
77836>>>>>
77836>>>>>    Procedure StoreHandleInfo Integer iCLIHandle String sDrvrId Integer iParentHandle
77838>>>>>        Set phCLIHandle      To iCLIHandle
77839>>>>>        Set psDriverID       To sDrvrId
77840>>>>>    End_Procedure // StoreHandleInfo
77841>>>>>
77841>>>>>
77841>>>>>
77841>>>>>    //***
77841>>>>>    //*** Procedure: FreeHandle
77841>>>>>    //*** Purpose : Destroys handle object and all child statement objects
77841>>>>>    //***
77841>>>>>    Procedure FreeHandle
77843>>>>>        Send Destroy_Object
77844>>>>>    End_Procedure // FreeHandle
77845>>>>>
77845>>>>>
77845>>>>>
77845>>>>>    //***
77845>>>>>    //*** Function: SQLConnect
77845>>>>>    //*** Purpose : Make a connectin to an embedded SQL server
77845>>>>>    //*** Returns : The DataFlex handle to the connection
77845>>>>>    //***
77845>>>>>
77845>>>>>    Function SQLConnect string sDrvrID String sConnect Returns Integer
77847>>>>>        Local Integer ihdbc
77847>>>>>        Local String  sEmpty
77847>>>>>
77847>>>>>        //*** Initialize
77847>>>>>        Move "" To sEmpty
77848>>>>>        Move 0  To ihdbc
77849>>>>>
77849>>>>>        Indicate Err False
77850>>>>>
77850>>>>>        //*** Call the driver function to connect
77850>>>>>        Call_driver 0 sDrvrId Function FUNC_SQLCONNECT ;                    Callback current_object ;                    Passing sConnect sEmpty 0 ;                    Result ihdbc
77855>>>>>
77855>>>>>        //*** If there was an error, make result invalid
77855>>>>>        If (Err) ;            Move 0 To ihdbc
77858>>>>>
77858>>>>>        //*** Check result and store it
77858>>>>>        If (ihdbc <> 0) ;            Send StoreHandleInfo ihdbc sDrvrId 0
77861>>>>>
77861>>>>>        //*** Return success status
77861>>>>>        Function_Return (ihdbc <> 0)
77862>>>>>    End_function // SQLConnect
77863>>>>>
77863>>>>>
77863>>>>>
77863>>>>>    //***
77863>>>>>    //*** Function: SQLFileConnect
77863>>>>>    //*** Purpose : Use a connection of an already open file
77863>>>>>    //***
77863>>>>>
77863>>>>>    Function SQLFileConnect Integer iFileNum Returns Integer
77865>>>>>        Local Integer ihdbc
77865>>>>>        Local Integer bIsOpen
77865>>>>>        Local String  sDrvrId
77865>>>>>        Local String  sEmpty
77865>>>>>
77865>>>>>        //*** Initialize
77865>>>>>        Move "" To sEmpty
77866>>>>>        Move 0  To ihdbc
77867>>>>>
77867>>>>>        //*** Check if file is open
77867>>>>>        Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
77870>>>>>        If (bIsOpen) Begin
77872>>>>>            //*** Fill the driver id, assume longest is 255 characters
77872>>>>>            Move (Repeat(' ', 255)) To sDrvrId
77873>>>>>            Get_attribute DF_FILE_DRIVER Of iFileNum To sDrvrId
77876>>>>>
77876>>>>>            Indicate Err False
77877>>>>>
77877>>>>>            //*** Call the driver function to connect
77877>>>>>            Call_driver iFileNum sDrvrId Function FUNC_SQLFILECONNECT ;                        Callback current_object ;                        Passing sEmpty sEmpty 0 ;                        Result ihdbc
77882>>>>>
77882>>>>>            //*** If there was an error, make result invalid
77882>>>>>            If (Err) ;                Move 0 To ihdbc
77885>>>>>
77885>>>>>            //*** Check result and store it
77885>>>>>            If (ihdbc <> 0) Begin
77887>>>>>                //*** Somehow Call_driver overwrites the sDrvrId variable, restore it here
77887>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sDrvrId
77890>>>>>                Send StoreHandleInfo ihdbc sDrvrId 0
77891>>>>>
77891>>>>>                //*** Set filenum so it can be used for fetching
77891>>>>>                Set piBindFile To iFileNum
77892>>>>>            End
77892>>>>>>
77892>>>>>        End
77892>>>>>>
77892>>>>>
77892>>>>>        //*** Return success status
77892>>>>>        Function_Return (ihdbc <> 0)
77893>>>>>    End_Function // SQLFileConnect
77894>>>>>
77894>>>>>
77894>>>>>
77894>>>>>    //***
77894>>>>>    //*** Procedure: SQLDisconnect
77894>>>>>    //*** Purpose  : Disconnect from an embedded SQL server and free allocated
77894>>>>>    //***            resources
77894>>>>>    //***
77894>>>>>
77894>>>>>    Procedure SQLDisconnect
77896>>>>>        Local Integer ihdbc
77896>>>>>        Local Integer iVoid
77896>>>>>        Local String  sDrvrId
77896>>>>>        Local String  sEmpty
77896>>>>>
77896>>>>>        //*** Initialize
77896>>>>>        Move "" To sEmpty
77897>>>>>
77897>>>>>        //*** Get the cli handle
77897>>>>>        Get phCLIHandle To ihdbc
77898>>>>>        Get psDriverId To sDrvrId
77899>>>>>
77899>>>>>        //*** Free the CLI handle
77899>>>>>        If (ihdbc <> 0) Begin
77901>>>>>            //*** Call the driver function to disconnect
77901>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLDISCONNECT ;                        Callback Current_object ;                        Passing sEmpty sEmpty ihdbc ;                        Result iVoid
77906>>>>>
77906>>>>>            //*** Free the DataFlex handle
77906>>>>>            Send FreeHandle
77907>>>>>        End
77907>>>>>>
77907>>>>>    End_Procedure // SQLDisconnect
77908>>>>>
77908>>>>>
77908>>>>>
77908>>>>>    //***
77908>>>>>    //*** Function: CreateHandle
77908>>>>>    //*** Purpose : Creates a child statement handle
77908>>>>>    //***
77908>>>>>
77908>>>>>    Function CreateHandle Returns Integer
77910>>>>>        Local Integer hSQL
77910>>>>>
77910>>>>>        Object oSQLStatement Is A cSQLStatement
77912>>>>>            Move current_object To hSQL
77913>>>>>        End_Object // oSQLStatement
77914>>>>>
77914>>>>>        //*** If the connection has a default Bind File, assign it to the
77914>>>>>        //*** statement object. The default is set when you open a file with a
77914>>>>>        //*** SetFileConnection command.
77914>>>>>        Set piBindFile Of hSQL To (piBindFile(Current_object))
77915>>>>>
77915>>>>>        Function_Return hSQL
77916>>>>>    End_Function // CreateHandle
77917>>>>>
77917>>>>>
77917>>>>>
77917>>>>>    //***
77917>>>>>    //*** Function: SQLOpen
77917>>>>>    //*** Prupose : Open a statement for use
77917>>>>>    //***
77917>>>>>
77917>>>>>    Function SQLOpen Returns Integer
77919>>>>>        Local Integer hDFHandle
77919>>>>>        Local Integer ihdbc
77919>>>>>        Local Integer ihstmt
77919>>>>>        Local Integer iVoid
77919>>>>>        Local String  sDrvrId
77919>>>>>        Local String  sEmpty
77919>>>>>
77919>>>>>        //*** Initialize
77919>>>>>        Move "" To sEmpty
77920>>>>>
77920>>>>>        //*** Get the cli handle to the connection
77920>>>>>        Get phCLIHandle To ihdbc
77921>>>>>        Get psDriverId  To sDrvrId
77922>>>>>
77922>>>>>        //*** Allocate a new handle and populate it
77922>>>>>        If (ihdbc <> 0) Begin
77924>>>>>            //**** Create a new DataFlex handle
77924>>>>>            Get CreateHandle To hDFHandle
77925>>>>>
77925>>>>>            //*** Call the driver function to allocate a statement handle
77925>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLOPEN ;                        Callback Current_object ;                        Passing hDFHandle sEmpty ihdbc ;                        Result ihstmt
77930>>>>>
77930>>>>>            //*** If unsuccessful destroy DF side info
77930>>>>>            If (ihstmt = 0) Begin
77932>>>>>                Send FreeHandle to hDFHandle
77933>>>>>                Move 0 to hDFHandle
77934>>>>>            End
77934>>>>>>
77934>>>>>            Else ;                Send StoreHandleInfo to hDFHandle ihstmt sDrvrId ihdbc
77936>>>>>        End
77936>>>>>>
77936>>>>>
77936>>>>>        Function_return hDFHandle
77937>>>>>    End_function // SQLOpen
77938>>>>>
77938>>>>>End_Class // cSQLConnection
77939>>>>>
77939>>>>>
77939>>>>>
77939>>>>>//*****************************************************************************
77939>>>>>//*** Class  : cSQLHandlemanager                                            ***
77939>>>>>//*** Purpose: Manager for embedded SQL handles.                            ***
77939>>>>>//***                                                                       ***
77939>>>>>//*** Description:                                                          ***
77939>>>>>//***   We want to be able to use multiple drivers and multiple             ***
77939>>>>>//***   connections within a driver and multiple statements within a        ***
77939>>>>>//***   connection. To allow this we have palced our own handle logic on    ***
77939>>>>>//***   top of the driver handle logic. This way we can handle the          ***
77939>>>>>//***   situation where two driver handles may be equal.                    ***
77939>>>>>//*****************************************************************************
77939>>>>>
77939>>>>>Class cSQLHandleManager Is A Array
77940>>>>>
77940>>>>>    Procedure Construct_object Integer Image
77942>>>>>        Forward Send Construct_object Image
77944>>>>>
77944>>>>>        Property String  psDefaultDriver     Public ""
77945>>>>>        Property String  psDefaultConnection Public ""
77946>>>>>
77946>>>>>        Set Delegation_mode to NO_Delegation
77947>>>>>    End_procedure // COnstruct_object
77948>>>>>
77948>>>>>
77948>>>>>
77948>>>>>    //***
77948>>>>>    //*** Function: CreateHandle
77948>>>>>    //*** Purpose : Allocate memory for the desired type of handle
77948>>>>>    //***
77948>>>>>
77948>>>>>    Function CreateHandle Returns Integer
77950>>>>>        Local Integer hSQL
77950>>>>>
77950>>>>>        //*** Create a connection object
77950>>>>>        Object oSQLConnection Is A cSQLConnection
77952>>>>>            Move current_object To hSQL
77953>>>>>        End_Object // oSQLConnection
77954>>>>>
77954>>>>>        Function_Return hSQL
77955>>>>>    End_Function // CreateHandle
77956>>>>>
77956>>>>>
77956>>>>>
77956>>>>>    //***
77956>>>>>    //*** Procedure: SQLSetConnect
77956>>>>>    //*** Purpose  : Store default connection information
77956>>>>>    //***
77956>>>>>
77956>>>>>    Procedure SQLSetConnect String sDriver String sConnect
77958>>>>>        Set psDefaultDriver      To sDriver
77959>>>>>        Set psDefaultConnection  To sConnect
77960>>>>>    End_Procedure // SQLSetConnect
77961>>>>>
77961>>>>>
77961>>>>>
77961>>>>>    //***
77961>>>>>    //*** Function: SQLConnect
77961>>>>>    //*** Purpose : Make a connectin to an embedded SQL server
77961>>>>>    //*** Returns : The DataFlex handle to the connection
77961>>>>>    //***
77961>>>>>
77961>>>>>    Function SQLConnect String sDrvrID String sConnect Returns integer
77963>>>>>        Local Integer hDFHandle
77963>>>>>        Local Integer bOK
77963>>>>>
77963>>>>>        //*** Check arguments
77963>>>>>        If (sDrvrID = "" And sConnect = "") Begin
77965>>>>>            Get psDefaultDriver      To sDrvrId
77966>>>>>            Get psDefaultConnection  To sConnect
77967>>>>>        End
77967>>>>>>
77967>>>>>
77967>>>>>        //*** Allocate a new handle
77967>>>>>        Get CreateHandle To hDFHandle
77968>>>>>        Get SQLConnect of hDFHandle sDrvrID sConnect To bOK
77969>>>>>
77969>>>>>        //*** If failure, kill the handle and return a 0 handle
77969>>>>>        If (Not(bOK)) Begin
77971>>>>>            Send FreeHandle to hDFHandle
77972>>>>>            Move 0 to hDFHandle
77973>>>>>        End
77973>>>>>>
77973>>>>>
77973>>>>>        Function_return hDFHandle
77974>>>>>    End_function // SQLConnect
77975>>>>>
77975>>>>>
77975>>>>>
77975>>>>>    //***
77975>>>>>    //*** Function: SQLFileConnect
77975>>>>>    //*** Purpose : Make an existing connection available for use with Embedded
77975>>>>>    //***           SQL. The connection is identified by the number opf a file
77975>>>>>    //***           that is open for that connection.
77975>>>>>    //***
77975>>>>>
77975>>>>>    Function SQLFileConnect Integer iFileNum Returns Integer
77977>>>>>        Local Integer hDFHandle
77977>>>>>        Local Integer bOK
77977>>>>>
77977>>>>>        //*** Allocate a new handle
77977>>>>>        Get CreateHandle To hDFHandle
77978>>>>>        Get SQLFileConnect of hDFHandle iFileNum To bOK
77979>>>>>
77979>>>>>        //*** If failure, kill the handle and return a 0 handle
77979>>>>>        If (Not(bOK)) Begin
77981>>>>>            Send FreeHandle to hDFHandle
77982>>>>>            Move 0 to hDFHandle
77983>>>>>        End
77983>>>>>>
77983>>>>>
77983>>>>>        Function_return hDFHandle
77984>>>>>    End_Function // SQLFileConnect
77985>>>>>
77985>>>>>End_Class // cSQLHandleManager
77986>>>>>
77986>>>>>
77986>>>>>
77986>>>>>//***
77986>>>>>//*** Function: CreateSQLManager
77986>>>>>//*** Purpose : Create the embedded SQL manager, this is an internal function!
77986>>>>>//***
77986>>>>>
77986>>>>>Function CreateSQLmanager For Desktop Returns Integer
77988>>>>>    Local Integer hoSQlMngr
77988>>>>>
77988>>>>>    Object oSQLHandleManager Is A cSQLHandleManager
77990>>>>>        MOve Current_object To hoSQLMngr
77991>>>>>    End_Object // oSQLHandleManager
77992>>>>>
77992>>>>>    Function_Return hoSQLMngr
77993>>>>>End_Function // CreateSQLMngr
77994>>>>>
77994>>>>>//*** Make sure the object is global by creating it under DESKTOP
77994>>>>>Get CreateSQLManager Of Desktop To _embsqlghoSQLHandleMngr
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLSetConnect                                                ***
77995>>>>>//*** Purpose: Setup default connection information for embedded SQL.       ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLSetConnect sSDriverId sConnectString                      ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLConnect                                                   ***
77995>>>>>//*** Purpose: Connect to a server for embedded SQL usage.                  ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLConnect To hdbc                                           ***
77995>>>>>//***          SQLConnect [sDriverId sConnectString] To hdbc                ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLFileConnect                                               ***
77995>>>>>//*** Purpsoe: Return the handle to a connection of an open file. This      ***
77995>>>>>//***          connection is (obviously) already opened. We are just using  ***
77995>>>>>//***          the same connection for Embedded SQL. This allows the        ***
77995>>>>>//***          programmer not to know connection details.                   ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLFileConnect Filex To hdbc                                 ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLDisconnect                                                ***
77995>>>>>//*** Purpose: Connect to a server for embedded SQL usage.                  ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLDisConnect hdbc                                           ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLOpen                                                      ***
77995>>>>>//*** Purpose: Allocate the memory to stroe statement information.          ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLOpen hdbc To hstmt                                        ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLClose                                                     ***
77995>>>>>//*** Purpose: Close a statement and free all associated memory.            ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLClose hstmt                                               ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLPrepare                                                   ***
77995>>>>>//*** Purpose: Prepare a statement for execution.                           ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLPrepare hstmt sStatement                                  ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLExecute                                                   ***
77995>>>>>//*** Purpose: Execute a prepared statement                                 ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLExecute hstmt                                             ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLExecDirect                                                ***
77995>>>>>//*** Purpose: Prepare and execute a statement.                             ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLExecDirect hstmt sStatement                               ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLFileFetch                                                 ***
77995>>>>>//*** Purpose: Get a row from a statement result set.                       ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLFileFetch hstmt [To File1 [File2 ...]]                    ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLBindFetchFile                                             ***
77995>>>>>//*** Purpose: Binds a file number to a statement so it can be used for     ***
77995>>>>>//***          fetching data. Only needed in non fileconnect. Note that     ***
77995>>>>>//***          can be assigned to the connection or the statement handle    ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLBindFileForFetch hstmt|hdbc FileName|FileNumber           ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLFetch                                                     ***
77995>>>>>//*** Purpose: Get a row from a statement result set.                       ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLFetch hstmt [To Var1 [Var2 ...]]                          ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLGetData                                                   ***
77995>>>>>//*** Purpose: Get a column's data.                                         ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLGetData hstmt iColumnNUmber [Length iLen] To Var          ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLColumnMap                                                 ***
77995>>>>>//*** Purpose: Determine the column number based on the column name.        ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLColumnMap hstmt sColName To iColNumber                    ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLColAttribute                                              ***
77995>>>>>//*** Purpose: Get an attribute of a column in a statements result set.     ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLColAttribute hstmt iCol iAttrId To sAttrib                ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLStmtAttribute                                             ***
77995>>>>>//*** Purpose: Get an atribute of a statement.                              ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLStmtAttribute hstmt iAttribId To sAttrib                  ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLCall                                                      ***
77995>>>>>//*** Purpose: Call a stored procedure.                                     ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLCall hstmt ProcedureName [Arg1 ...] [To Var]              ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLGetArguments                                              ***
77995>>>>>//*** Purpsoe: Get the arguments of a stored procedure. This command should ***
77995>>>>>//***          be used when a procedure has multiple result sets. Some      ***
77995>>>>>//***          backends (SQL SErver for example) will return these as the   ***
77995>>>>>//***          last result set. This emans you first process all other      ***
77995>>>>>//***          result sets and then get the arguments and return value.     ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLGetArguments hstmt [Arg1...] [To Var]                     ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLNextResultSet                                             ***
77995>>>>>//*** Purpose: Go the the next result set. This command should be used when ***
77995>>>>>//***          a procedure call results in multiple result sets. Processing ***
77995>>>>>//***          such procedures can be done by loping through the result     ***
77995>>>>>//***          sets.                                                        ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLNextResultSet hstmt                                       ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>
77995>>>>>//*****************************************************************************
77995>>>>>//*** Command: SQLFetchActivatesBuffer                                      ***
77995>>>>>//*** Purpose: Setup fetch behavior for a file. When set to true a          ***
77995>>>>>//***          succesfull fetch of the statement resutl set will            ***
77995>>>>>//***          automatically set the status of the file's bufer to          ***
77995>>>>>//***          DF_FILE_ACTIVE.                                              ***
77995>>>>>//***                                                                       ***
77995>>>>>//*** Syntax : SQLFetchActivatesBuffer hstmt FileNUmber|FileName sState     ***
77995>>>>>//*****************************************************************************
77995>>>>>
77995>>>>>//Doc/ Ignore=False
77995>>>Use dfLine.pkg
77995>>>Use dfTabDlg.pkg
77995>>>Use TARJETAS.sl
Including file: TARJETAS.sl    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\TARJETAS.sl)
77995>>>>>Use Windows.pkg
77995>>>>>Use DFClient.pkg
77995>>>>>Use cDbCJGridPromptList.pkg
77995>>>>>Use cTIPO_GASTO_DataDictionary.dd
Including file: cTIPO_GASTO_DataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cTIPO_GASTO_DataDictionary.dd)
77995>>>>>>>Use DataDict.pkg
77995>>>>>>>
77995>>>>>>>Open TIPO_GASTO
Including file: TIPO_GASTO.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\TIPO_GASTO.fd)
77997>>>>>>>
77997>>>>>>>Class cTIPO_GASTO_DataDictionary is a DataDictionary
77998>>>>>>>    
77998>>>>>>>    Procedure Construct_Object
78000>>>>>>>        Forward Send Construct_Object
78002>>>>>>>        Set Main_File to TIPO_GASTO.File_Number
78003>>>>>>>
78003>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
78004>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
78005>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
78006>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
78007>>>>>>>
78007>>>>>>>    End_Procedure
78008>>>>>>>
78008>>>>>>>End_Class
78009>>>>>Use TARJETA.dd
Including file: TARJETA.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\TARJETA.dd)
78009>>>>>>>Use DataDict.pkg
78009>>>>>>>
78009>>>>>>>Open TARJETA
Including file: TARJETA.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\TARJETA.fd)
78011>>>>>>>Open NPROX
Including file: NPROX.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\NPROX.fd)
78013>>>>>>>Open EGRESOS
Including file: EGRESOS.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\EGRESOS.fd)
78015>>>>>>>
78015>>>>>>>Class TARJETA_DataDictionary is a DataDictionary
78016>>>>>>>    
78016>>>>>>>    Procedure Construct_Object
78018>>>>>>>        Forward Send Construct_Object
78020>>>>>>>        Set Main_File to TARJETA.File_Number
78021>>>>>>>
78021>>>>>>>        Set Add_System_File to NPROX.File_Number DD_Lock_On_All
78022>>>>>>>
78022>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
78023>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
78024>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
78025>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
78026>>>>>>>
78026>>>>>>>        Set Field_Auto_Increment Field TARJETA.NUMERO to File_Field NPROX.TARJETA
78027>>>>>>>
78027>>>>>>>        Set Field_Option Field TARJETA.CLAVE DD_CAPSLOCK to True
78028>>>>>>>
78028>>>>>>>    End_Procedure
78029>>>>>>>
78029>>>>>>>End_Class
78030>>>>>Use cdbCJGridColumn.pkg
78030>>>>>
78030>>>>>Object TARJETAS_SL is a dbModalPanel
78032>>>>>    Object oTARJETA_DD is a TARJETA_DataDictionary
78034>>>>>    End_Object
78035>>>>>
78035>>>>>    Set Main_DD to oTARJETA_DD
78036>>>>>    Set Server to oTARJETA_DD
78037>>>>>
78037>>>>>
78037>>>>>    Set Size to 88 171
78038>>>>>    Set Location     to 4 5
78039>>>>>    Set Border_Style to Border_Thick
78040>>>>>    Set Label to "TIPO_GASTO"
78041>>>>>    Set Column_Offset to 1
78042>>>>>    
78042>>>>>     Object oSelList is a dbList
78044>>>>>        Set Main_File to TARJETA.File_Number
78045>>>>>        Set Size to 62 159
78046>>>>>        Set Location to 6 6
78047>>>>>    
78047>>>>>        Begin_Row
78050>>>>>            Entry_Item TARJETA.Numero
78051>>>>>            Entry_Item TARJETA.CLAVE
78052>>>>>            Entry_Item TARJETA.DIA_CORTE
78053>>>>>            Entry_Item TARJETA.DIA_PAGO
78054>>>>>        End_Row
78059>>>>>    
78059>>>>>        Set Form_Width 0 to 19
78060>>>>>        Set Header_Label  item 0 to "#"
78061>>>>>        
78061>>>>>        Set Form_Width 1 to 42
78062>>>>>        Set Header_Label  item 1 to "Clave"
78063>>>>>        
78063>>>>>        Set Form_Width 2 to 49
78064>>>>>        Set Header_Label  item 2 to "Dia Corte"
78065>>>>>        
78065>>>>>        Set Form_Width 3 to 43
78066>>>>>        Set Header_Label  item 3 to "Dia Pago"
78067>>>>>        
78067>>>>>        Set Export_Column to 0
78068>>>>>        Set Initial_Column to 0
78069>>>>>        
78069>>>>>    End_Object    // oSelList
78070>>>>>
78070>>>>>    Object oOK_bn is a Button
78072>>>>>        Set Label     to "&OK"
78073>>>>>        Set Location to 71 7
78074>>>>>        Set peAnchors to anBottomRight
78075>>>>>
78075>>>>>        Procedure OnClick
78078>>>>>            Send Ok of oSelList
78079>>>>>        End_Procedure
78080>>>>>
78080>>>>>    End_Object
78081>>>>>
78081>>>>>    Object oCancel_bn is a Button
78083>>>>>        Set Label     to "&Cancel"
78084>>>>>        Set Location to 71 61
78085>>>>>        Set peAnchors to anBottomRight
78086>>>>>
78086>>>>>        Procedure OnClick
78089>>>>>            Send Cancel of oSelList
78090>>>>>        End_Procedure
78091>>>>>
78091>>>>>    End_Object
78092>>>>>
78092>>>>>    Object oSearch_bn is a Button
78094>>>>>        Set Label     to "&Search..."
78095>>>>>        Set Location to 71 115
78096>>>>>        Set peAnchors to anBottomRight
78097>>>>>
78097>>>>>        Procedure OnClick
78100>>>>>            Send Search of oSelList
78101>>>>>        End_Procedure
78102>>>>>
78102>>>>>    End_Object
78103>>>>>
78103>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
78104>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
78105>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
78106>>>>>
78106>>>>>End_Object
78107>>>>>
78107>>>Use cPRESUPUESTO_DataDictionary.dd
Including file: cPRESUPUESTO_DataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cPRESUPUESTO_DataDictionary.dd)
78107>>>>>Use DataDict.pkg
78107>>>>>
78107>>>>>Open PRESUPUESTO
Including file: PRESUPUESTO.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\PRESUPUESTO.fd)
78109>>>>>Open EGRESOS
78111>>>>>Open NPROX
78113>>>>>
78113>>>>>Class cPRESUPUESTODataDictionary is a DataDictionary
78114>>>>>    
78114>>>>>    Procedure Construct_Object
78116>>>>>        Forward Send Construct_Object
78118>>>>>        Set Main_File to PRESUPUESTO.File_Number
78119>>>>>
78119>>>>>        Set Add_System_File to NPROX.File_Number DD_Lock_On_All
78120>>>>>
78120>>>>>        Set Add_Client_File to EGRESOS.File_Number
78121>>>>>
78121>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
78122>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
78123>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
78124>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
78125>>>>>
78125>>>>>        Set Field_Auto_Increment Field PRESUPUESTO.NUMERO to File_Field NPROX.PRESUPUESTO
78126>>>>>
78126>>>>>    End_Procedure
78127>>>>>
78127>>>>>End_Class
78128>>>Use cEGRESOSDataDictionary.dd
Including file: cEGRESOSDataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cEGRESOSDataDictionary.dd)
78128>>>>>Use DataDict.pkg
78128>>>>>
78128>>>>>Open EGRESOS
78130>>>>>Open PRESUPUESTO
78132>>>>>Open SUB_EGRESOS
Including file: SUB_EGRESOS.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\SUB_EGRESOS.fd)
78134>>>>>Open TIPO_GASTO
78136>>>>>Open TARJETA
78138>>>>>
78138>>>>>Register_Object TIPO_GASTO_SL
78138>>>>>Register_Object TARJETAS_SL
78138>>>>>
78138>>>>>Class cEGRESOSDataDictionary is a DataDictionary
78139>>>>>    
78139>>>>>//        Procedure OnConstrain
78139>>>>>//            Forward Send OnConstrain
78139>>>>>//            Set pbUseDDSQLFilters to True
78139>>>>>//            Local String @Filtro @Filtro2 @Tipo_Gasto
78139>>>>>//            Local Integer @Vista 
78139>>>>>//            
78139>>>>>//            Move '' to @Filtro2
78139>>>>>//            
78139>>>>>//            Get psFiltro of (oClientArea(oMain(Current_object))) to @Filtro
78139>>>>>//            Get piOpcionVista of (oClientArea(oMain(Current_object))) to @Vista
78139>>>>>//            Get psOpcionPago of (oClientArea(oMain(Current_object))) to @Tipo_Gasto
78139>>>>>//            
78139>>>>>//            If (@Filtro ne '') Begin
78139>>>>>//                Append @Filtro2 @Filtro 
78139>>>>>//            End
78139>>>>>//            
78139>>>>>//            If (@Tipo_Gasto ne 'TODOS') Begin
78139>>>>>//                If (@Filtro ne '') Append @Filtro2 ' AND FORMA_PAGO = ' ("'"+@Tipo_Gasto+"'")
78139>>>>>//                Else               Append @Filtro2 ' FORMA_PAGO = ' ("'"+@Tipo_Gasto+"'")
78139>>>>>//            End
78139>>>>>//            
78139>>>>>//            If (@Vista ne 3) Begin
78139>>>>>//                If (@Filtro ne '') Append @Filtro2 " AND "
78139>>>>>//                If (@Vista EQ 0) Append @Filtro2   " PAGADO_SN = 'N'"
78139>>>>>//                If (@Vista EQ 1) Append @Filtro2   " PAGADO_SN = 'S'"
78139>>>>>//                If (@Vista EQ 2) Append @Filtro2   " MONTO > MONTO_PROYECTADO"
78139>>>>>//            End
78139>>>>>//            
78139>>>>>//            Set psSQLFilter to @Filtro2
78139>>>>>//        End_Procedure
78139>>>>>    
78139>>>>>    Procedure Construct_Object
78141>>>>>        Forward Send Construct_Object
78143>>>>>        Set Main_File to EGRESOS.File_Number
78144>>>>>
78144>>>>>        Set Add_Server_File to TIPO_GASTO.File_Number
78145>>>>>        Set Add_Server_File to PRESUPUESTO.File_Number
78146>>>>>
78146>>>>>        Set Add_Client_File to SUB_EGRESOS.File_Number
78147>>>>>
78147>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
78148>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
78149>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
78150>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
78151>>>>>
78151>>>>>        Set Field_Prompt_Object Field EGRESOS.TIPO to TIPO_GASTO_SL
78152>>>>>
78152>>>>>        Set Field_Class_Name Field EGRESOS.ES_FIJO_SN to "Checkbox"
78153>>>>>        Set Field_Checkbox_Values Field EGRESOS.ES_FIJO_SN to "S" "N"
78154>>>>>
78154>>>>>        Set Field_Class_Name Field EGRESOS.PAGADO_SN to "Checkbox"
78155>>>>>        Set Field_Checkbox_Values Field EGRESOS.PAGADO_SN to "S" "N"
78156>>>>>
78156>>>>>        Set Field_Value_Check Field EGRESOS.FORMA_PAGO to "EF|TC|TD"
78157>>>>>
78157>>>>>        Set Field_Checkbox_Values Field EGRESOS.MARCAR to "S" "N"
78158>>>>>
78158>>>>>        Set Field_Class_Name Field EGRESOS.LIQUIDAR to "Checkbox"
78159>>>>>        Set Field_Checkbox_Values Field EGRESOS.LIQUIDAR to "S" "N"
78160>>>>>
78160>>>>>        Set Field_Checkbox_Values Field EGRESOS.LIQUIDADO to "S" "N"
78161>>>>>        Set Field_Class_Name Field EGRESOS.LIQUIDADO to "Checkbox"
78162>>>>>
78162>>>>>        Set Field_Prompt_Object Field EGRESOS.TC to TARJETAS_SL
78163>>>>>
78163>>>>>    End_Procedure
78164>>>>>
78164>>>>>    Procedure Field_Defaults
78166>>>>>        Forward Send Field_Defaults
78168>>>>>        Set Field_Changed_Value Field EGRESOS.ES_FIJO_SN to "N"
78169>>>>>        Set Field_Changed_Value Field EGRESOS.PAGADO_SN to "N"
78170>>>>>        Set Field_Changed_Value Field EGRESOS.MARCAR to "N"
78171>>>>>        Set Field_Changed_Value Field EGRESOS.LIQUIDAR to "N"
78172>>>>>        Set Field_Changed_Value Field EGRESOS.LIQUIDADO to "N"
78173>>>>>    End_Procedure
78174>>>>>
78174>>>>>End_Class
78175>>>>>
78175>>>>>Use TARJETAS.sl
78175>>>>>Use TIPO_GASTO.sl
Including file: TIPO_GASTO.sl    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\TIPO_GASTO.sl)
78175>>>>>>>Use Windows.pkg
78175>>>>>>>Use DFClient.pkg
78175>>>>>>>Use cDbCJGridPromptList.pkg
78175>>>>>>>Use cTIPO_GASTO_DataDictionary.dd
78175>>>>>>>Use cdbCJGridColumn.pkg
78175>>>>>>>
78175>>>>>>>Object TIPO_GASTO_SL is a dbModalPanel
78177>>>>>>>    Object oTIPO_GASTO_DD is a cTIPO_GASTO_DataDictionary
78179>>>>>>>    End_Object
78180>>>>>>>
78180>>>>>>>    Set Main_DD to oTIPO_GASTO_DD
78181>>>>>>>    Set Server to oTIPO_GASTO_DD
78182>>>>>>>
78182>>>>>>>    Set Size to 133 171
78183>>>>>>>    Set Location     to 4 5
78184>>>>>>>    Set Border_Style to Border_Thick
78185>>>>>>>    Set Label to "TIPO_GASTO"
78186>>>>>>>    Set Column_Offset to 1
78187>>>>>>>    
78187>>>>>>>     Object oSelList is a dbList
78189>>>>>>>        Set Main_File to TIPO_GASTO.File_Number
78190>>>>>>>        Set Size to 105 168
78191>>>>>>>        Set Location to 6 2
78192>>>>>>>    
78192>>>>>>>        Begin_Row
78195>>>>>>>            Entry_Item TIPO_GASTO.Numero
78196>>>>>>>            Entry_Item TIPO_GASTO.CLAVE
78197>>>>>>>            Entry_Item TIPO_GASTO.DESCRIPCION
78198>>>>>>>        End_Row
78203>>>>>>>    
78203>>>>>>>        Set Form_Width 0 to 19
78204>>>>>>>        Set Header_Label  item 0 to "#"
78205>>>>>>>        
78205>>>>>>>        Set Form_Width 1 to 34
78206>>>>>>>        Set Header_Label  item 1 to "Clave"
78207>>>>>>>        
78207>>>>>>>        Set Form_Width 2 to 111
78208>>>>>>>        Set Header_Label  item 2 to "Descripcion"
78209>>>>>>>         Set Export_Column to 1
78210>>>>>>>         Set Initial_Column to 1
78211>>>>>>>        
78211>>>>>>>    End_Object    // oSelList
78212>>>>>>>
78212>>>>>>>    Object oOK_bn is a Button
78214>>>>>>>        Set Label     to "&OK"
78215>>>>>>>        Set Location to 115 7
78216>>>>>>>        Set peAnchors to anBottomRight
78217>>>>>>>
78217>>>>>>>        Procedure OnClick
78220>>>>>>>            Send Ok of oSelList
78221>>>>>>>        End_Procedure
78222>>>>>>>
78222>>>>>>>    End_Object
78223>>>>>>>
78223>>>>>>>    Object oCancel_bn is a Button
78225>>>>>>>        Set Label     to "&Cancel"
78226>>>>>>>        Set Location to 115 61
78227>>>>>>>        Set peAnchors to anBottomRight
78228>>>>>>>
78228>>>>>>>        Procedure OnClick
78231>>>>>>>            Send Cancel of oSelList
78232>>>>>>>        End_Procedure
78233>>>>>>>
78233>>>>>>>    End_Object
78234>>>>>>>
78234>>>>>>>    Object oSearch_bn is a Button
78236>>>>>>>        Set Label     to "&Search..."
78237>>>>>>>        Set Location to 115 115
78238>>>>>>>        Set peAnchors to anBottomRight
78239>>>>>>>
78239>>>>>>>        Procedure OnClick
78242>>>>>>>            Send Search of oSelList
78243>>>>>>>        End_Procedure
78244>>>>>>>
78244>>>>>>>    End_Object
78245>>>>>>>
78245>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
78246>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
78247>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
78248>>>>>>>
78248>>>>>>>End_Object
78249>>>>>>>
78249>>>Use SUB_EGRESOS.dd
Including file: SUB_EGRESOS.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\SUB_EGRESOS.dd)
78249>>>>>Use DataDict.pkg
78249>>>>>
78249>>>>>Open SUB_EGRESOS
78251>>>>>Open EGRESOS
78253>>>>>
78253>>>>>Class SUB_EGRESOS_DataDictionary is a DataDictionary
78254>>>>>    
78254>>>>>    Procedure Construct_Object
78256>>>>>        Forward Send Construct_Object
78258>>>>>        Set Main_File to SUB_EGRESOS.File_Number
78259>>>>>
78259>>>>>        Set Add_Server_File to EGRESOS.File_Number
78260>>>>>
78260>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
78261>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
78262>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
78263>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
78264>>>>>
78264>>>>>    End_Procedure
78265>>>>>    
78265>>>>>    Procedure Update 
78267>>>>>        Forward Send Update
78269>>>>>        Add SUB_EGRESOS.MONTO to EGRESOS.MONTO
78270>>>>>    End_Procedure
78271>>>>>    
78271>>>>>    Procedure Backout
78273>>>>>        Forward Send Backout
78275>>>>>        Subtract SUB_EGRESOS.MONTO from EGRESOS.MONTO
78276>>>>>    End_Procedure
78277>>>>>
78277>>>>>End_Class
78278>>>Use cTIPO_GASTO_DataDictionary.dd
78278>>>Use dfTable.pkg
78278>>>
78278>>>Deferred_View Activate_Egresos for ;Object Egresos is a dbView
78303>>>    
78303>>>    Property String psFiltro ''
78305>>>    Property String psOpcionPago 'TODOS'
78307>>>    Property Integer piOpcionVista 3
78309>>>    
78309>>>    
78309>>>    Object oTIPO_GASTO_DD is a cTIPO_GASTO_DataDictionary
78311>>>    End_Object
78312>>>
78312>>>    Object oPRESUPUESTO_DD is a cPRESUPUESTODataDictionary
78314>>>        Procedure Relate_Main_File
78317>>>            Forward Send Relate_Main_File 
78319>>>            Send Totales
78320>>>        End_Procedure
78321>>>    End_Object
78322>>>    
78322>>>    Function GetClientArea Returns Handle
78325>>>        Handle hoClient
78325>>>        Move (oClientArea(oMain(ghoApplication))) to hoClient
78326>>>        Function_Return hoClient
78327>>>    End_Function
78328>>>
78328>>>    Object oEGRESOS_DD is a cEGRESOSDataDictionary
78330>>>        Set Constrain_file to PRESUPUESTO.File_number
78331>>>        Set DDO_Server to oPRESUPUESTO_DD
78332>>>        Set DDO_Server to oTIPO_GASTO_DD
78333>>>        
78333>>>       Procedure OnConstrain
78336>>>            Forward Send OnConstrain
78338>>>            Set pbUseDDSQLFilters to True
78339>>>            Local String @Filtro @Filtro2 @Tipo_Gasto
78339>>>            Local Integer @Vista 
78339>>>            
78339>>>            Move '' to @Filtro2
78340>>>            
78340>>>            // Usa una referencia directa al oClientArea
78340>>>            Get psFiltro       to @Filtro
78341>>>            Get piOpcionVista  to @Vista
78342>>>            Get psOpcionPago   to @Tipo_Gasto
78343>>>            
78343>>>            If (@Filtro ne '') Begin
78345>>>                Append @Filtro2 @Filtro 
78346>>>            End
78346>>>>
78346>>>            
78346>>>            If (@Tipo_Gasto ne 'TODOS' and @Tipo_Gasto ne '') Begin
78348>>>                If (@Filtro ne '') Append @Filtro2 ' AND FORMA_PAGO = ' ("'"+@Tipo_Gasto+"'")
78352>>>                Else               Append @Filtro2 ' FORMA_PAGO = ' ("'"+@Tipo_Gasto+"'")
78355>>>            End
78355>>>>
78355>>>            
78355>>>            If (@Vista ne 3) Begin
78357>>>                If (@Filtro ne '') Append @Filtro2 " AND "
78360>>>                If (@Vista EQ 0) Append @Filtro2   " PAGADO_SN = 'N'"
78363>>>                If (@Vista EQ 1) Append @Filtro2   " PAGADO_SN = 'S'"
78366>>>                If (@Vista EQ 2) Append @Filtro2   " MONTO > MONTO_PROYECTADO"
78369>>>            End
78369>>>>
78369>>>            
78369>>>            Set psSQLFilter to @Filtro2
78370>>>        End_Procedure
78371>>>    End_Object
78372>>>
78372>>>    Object oSUB_EGRESOS_DD is a SUB_EGRESOS_DataDictionary
78374>>>        Set Constrain_file to EGRESOS.File_number
78375>>>        Set DDO_Server to oEGRESOS_DD
78376>>>        
78376>>>        Procedure Request_Save
78379>>>            Forward Send Request_Save
78381>>>            Move PRESUPUESTO.NUMERO to SUB_EGRESOS.PRESUPUESTO
78382>>>            Move EGRESOS.NUMERO to SUB_EGRESOS.EGRESO
78383>>>        End_Procedure
78384>>>    End_Object
78385>>>
78385>>>    Set Main_DD to oEGRESOS_DD
78386>>>    Set Server to oEGRESOS_DD
78387>>>    
78387>>>    Procedure Request_Delete
78390>>>        Send Totales
78391>>>    End_Procedure
78392>>>    
78392>>>    
78392>>>    Procedure Request_Clear
78395>>>        Forward Send Request_Clear
78397>>>        Set Shadow_State of oPRESUPUESTO_CLAVE          to False
78398>>>        Set Shadow_State of oPRESUPUESTO_FECHA_INICIO   to False
78399>>>        Set Shadow_State of oPRESUPUESTO_FECHA_FIN      to False
78400>>>        Set Shadow_State of oPRESUPUESTO_VLR_QUINCENA   to False 
78401>>>        Set Value of oTOTAL_E    to ''
78402>>>        Set Value of oTOTAL_PGDO to ''
78403>>>        Set Value of oDISPONIBLE to ''
78404>>>        Set Color of Egresos  to 16641499
78405>>>        Set Color of oTOTAL_E to 16777088 
78406>>>    End_Procedure
78407>>>    Procedure Request_Clear_All
78410>>>        Forward Send Request_Clear_All
78412>>>        Set Shadow_State of oPRESUPUESTO_CLAVE          to False
78413>>>        Set Shadow_State of oPRESUPUESTO_FECHA_INICIO   to False
78414>>>        Set Shadow_State of oPRESUPUESTO_FECHA_FIN      to False
78415>>>        Set Shadow_State of oPRESUPUESTO_VLR_QUINCENA   to False 
78416>>>        Set Value of oTOTAL_E    to ''
78417>>>        Set Value of oTOTAL_PGDO to ''
78418>>>        Set Value of oDISPONIBLE to ''
78419>>>        Set Color of Egresos  to 16641499
78420>>>        Set Color of oTOTAL_E to 16777088 
78421>>>    End_Procedure
78422>>>    Set Color to 16641499
78423>>>    Set Auto_Top_View_State to True
78424>>>
78424>>>    //FUNCIONES Y PROCEDIMIENTOS
78424>>>    
78424>>>    Procedure Liquidar 
78427>>>        Local String sQ 
78427>>>        Local Handle hdbc69 hstmt69
78427>>>        Local Number nValor_Disponible nValor_Liquidar
78427>>>        
78427>>>        Move '' to sQ
78428>>>        Move 0  to nValor_Disponible
78429>>>        Append sQ " SELECT DISPONIBLE FROM dbo.fn_ObtenerTotalesPresupuesto(" PRESUPUESTO.NUMERO ",3, 'todos'); " 
78432>>>        SQLFileConnect EGRESOS to hdbc69
78433>>>        SQLOpen hdbc69 to hstmt69
78436>>>        SQLExecDirect hstmt69 sQ
78439>>>        Repeat
78439>>>>
78439>>>           SQLFileFetch hstmt69
78445>>>           If (SQLResult) Begin
78447>>>              Get SQLColumnValue of hstmt69   1 to nValor_Disponible
78448>>>           End
78448>>>>
78448>>>        Until (not(SQLResult))
78450>>>        SQLClose hstmt69
78453>>>        SQLDisconnect hdbc69
78456>>>        
78456>>>        Move '' to sQ
78457>>>        Move 0  to nValor_Liquidar
78458>>>        Append sQ " SELECT SUM(MONTO) FROM EGRESOS WHERE LIQUIDAR = 'S' AND PRESUPUESTO = " PRESUPUESTO.NUMERO 
78460>>>        SQLFileConnect EGRESOS to hdbc69
78461>>>        SQLOpen hdbc69 to hstmt69
78464>>>        SQLExecDirect hstmt69 sQ
78467>>>        Repeat
78467>>>>
78467>>>           SQLFileFetch hstmt69
78473>>>           If (SQLResult) Begin
78475>>>              Get SQLColumnValue of hstmt69   1 to nValor_Liquidar
78476>>>           End
78476>>>>
78476>>>        Until (not(SQLResult))
78478>>>        SQLClose hstmt69
78481>>>        SQLDisconnect hdbc69
78484>>>        
78484>>>        If (nValor_Disponible < nValor_Liquidar) Begin
78486>>>            Local Integer iRespuesta
78486>>>            Get Confirm 'Monto a liquidar es mayor al disponible. Desea usar todo el disponible?' to iRespuesta
78487>>>            
78487>>>            If (iRespuesta eq 1) Begin
78489>>>                Send Stop_Box 'Liquidacion detenida...' '!'
78490>>>                Procedure_Return
78491>>>            End
78491>>>>
78491>>>        End
78491>>>>
78491>>>    
78491>>>        Move '' to sQ
78492>>>        Append sQ " UPDATE EGRESOS SET LIQUIDAR = 'N', LIQUIDADO = 'S', PAGADO_SN = 'S' where LIQUIDAR = 'S' AND PRESUPUESTO = " PRESUPUESTO.NUMERO 
78494>>>        SQLFileConnect EGRESOS to hdbc69
78495>>>        SQLOpen hdbc69 to hstmt69
78498>>>        SQLExecDirect hstmt69 sQ
78501>>>        SQLClose hstmt69
78504>>>        SQLDisconnect hdbc69
78507>>>        
78507>>>        Send Request_Find of oEGRESOS_DD ge Egresos.File_Number 1
78508>>>        Send Beginning_of_Data to oEgresos
78509>>>    End_Procedure
78510>>>    
78510>>>    Procedure Totales 
78513>>>        Local String sQ sOptionTipoPago
78513>>>        Local Handle hdbc69 hstmt69
78513>>>        local Integer iOptionTipoPago iOpcionVista
78513>>>        Local Number nVal_TD nValPgdo nValPgdo_EF nValDispo nValDispo_EF nEgresos_EF nTotalTD_EF
78513>>>        Local Number nTOTAL_EGRESOS nTOTAL_INGRESOS nDIFERENCIA nPENDIENTE_PAGO nTOTAL_PGO nDISPONIBLE
78513>>>        
78513>>>        Get piOpcionVista  to iOpcionVista
78514>>>        Get psOpcionPago   to sOptionTipoPago
78515>>>    
78515>>>        Move '' to sQ
78516>>>        Move 0  to nVal_TD
78517>>>        Append sQ " SELECT * FROM dbo.fn_ObtenerTotalesPresupuesto(" PRESUPUESTO.NUMERO ", " iOpcionVista ", '" sOptionTipoPago "'); " 
78524>>>        SQLFileConnect EGRESOS to hdbc69
78525>>>        SQLOpen hdbc69 to hstmt69
78528>>>        SQLExecDirect hstmt69 sQ
78531>>>        Repeat
78531>>>>
78531>>>           SQLFileFetch hstmt69
78537>>>           If (SQLResult) Begin
78539>>>              Get SQLColumnValue of hstmt69   1 to nTOTAL_INGRESOS
78540>>>              Get SQLColumnValue of hstmt69   2 to nTOTAL_EGRESOS
78541>>>              Get SQLColumnValue of hstmt69   3 to nDIFERENCIA
78542>>>              Get SQLColumnValue of hstmt69   4 to nTOTAL_PGO
78543>>>              Get SQLColumnValue of hstmt69   5 to nPENDIENTE_PAGO
78544>>>              Get SQLColumnValue of hstmt69   6 to nDISPONIBLE
78545>>>           End
78545>>>>
78545>>>        Until (not(SQLResult))
78547>>>        SQLClose hstmt69
78550>>>        SQLDisconnect hdbc69
78553>>>        
78553>>>        Set Value of oTOTAL_E           to nTOTAL_EGRESOS
78554>>>        Set Value of oTOTAL_INGRESOS    to nTOTAL_INGRESOS
78555>>>        Set Value of oDIFERENCIA2       to nDIFERENCIA
78556>>>        Set Value of oPENDIENTE         to nPENDIENTE_PAGO
78557>>>        Set Value of oTOTAL_PGDO        to nTOTAL_PGO
78558>>>        Set Value of oDISPONIBLE        to nDISPONIBLE
78559>>>        
78559>>>        
78559>>>        If (nTOTAL_EGRESOS > nTOTAL_INGRESOS) Begin
78561>>>            Set Color of oTOTAL_E to 9079551
78562>>>        End
78562>>>>
78562>>>        
78562>>>        If (nDISPONIBLE > 0) Begin
78564>>>            Set Color of oDISPONIBLE to 16777088
78565>>>        End
78565>>>>
78565>>>        
78565>>>    End_Procedure
78566>>>    
78566>>>    Procedure Cargar_Eg_Fijos 
78569>>>        Local String sQ
78569>>>        Local Handle hdbc69 hstmt69
78569>>>        Local Integer iProx
78569>>>        Local Date dToday
78569>>>        Sysdate dToday
78570>>>    
78570>>>        Move '' to sQ
78571>>>        Append sQ "INSERT INTO EGRESOS (NUMERO, TIPO, DESCRIPCION, FECHA_REALIZADO, ES_FIJO_SN, MONTO, MONTO_PROYECTADO, PRESUPUESTO, FORMA_PAGO) "
78572>>>        Append sQ "SELECT (SELECT COALESCE(MAX(NUMERO), 0) FROM EGRESOS WHERE PRESUPUESTO = " PRESUPUESTO.NUMERO ") + ROW_NUMBER() OVER (ORDER BY TIPO), TIPO, DESCRIPCION, " (fSQL_date(dToday)) ", 'S', 0, MONTO_PROYECTADO, " PRESUPUESTO.NUMERO ", 'TD'"
78579>>>        Append sQ " FROM EGRESOS WHERE ES_FIJO_SN = 'S' AND PRESUPUESTO = " (PRESUPUESTO.NUMERO-1)
78581>>>        SQLFileConnect EGRESOS to hdbc69
78582>>>        SQLOpen hdbc69 to hstmt69
78585>>>        SQLExecDirect hstmt69 sQ
78588>>>        
78588>>>        Send Request_Find of oEGRESOS_DD ge Egresos.File_Number 1
78589>>>        
78589>>>        SQLClose hstmt69
78592>>>        SQLDisconnect hdbc69
78595>>>    End_Procedure
78596>>>    
78596>>>     Procedure Cargar_Eg_Pendientes 
78599>>>        Local String sQ
78599>>>        Local Handle hdbc69 hstmt69
78599>>>        Local Integer iProx
78599>>>        Local Date dToday
78599>>>        Sysdate dToday
78600>>>    
78600>>>        Move '' to sQ
78601>>>        Append sQ "INSERT INTO EGRESOS (NUMERO, TIPO, DESCRIPCION, FECHA_REALIZADO, ES_FIJO_SN, MONTO, MONTO_PROYECTADO, PRESUPUESTO, FORMA_PAGO) "
78602>>>        Append sQ "SELECT (SELECT COALESCE(MAX(NUMERO), 0) FROM EGRESOS WHERE PRESUPUESTO = " PRESUPUESTO.NUMERO ") + ROW_NUMBER() OVER (ORDER BY TIPO), TIPO, DESCRIPCION, " (fSQL_date(dToday)) ", 'N', 0, MONTO_PROYECTADO, " PRESUPUESTO.NUMERO ", 'TD'"
78609>>>        Append sQ " FROM EGRESOS WHERE FORMA_PAGO = 'TC' AND PAGADO_SN = 'S' AND PRESUPUESTO = " (PRESUPUESTO.NUMERO-1)
78611>>>        SQLFileConnect EGRESOS to hdbc69
78612>>>        SQLOpen hdbc69 to hstmt69
78615>>>        SQLExecDirect hstmt69 sQ
78618>>>        
78618>>>        Send Request_Find of oEGRESOS_DD ge Egresos.File_Number 1
78619>>>        
78619>>>        SQLClose hstmt69
78622>>>        SQLDisconnect hdbc69
78625>>>    End_Procedure
78626>>>    Set Size to 348 501
78627>>>    Set Location to 2 2
78628>>>    Set Label to "„gados"
78629>>>    
78629>>>    Object oDbContainer3d2 is a dbContainer3d
78631>>>        Set Size to 209 460
78632>>>        Set Location to 117 16
78633>>>
78633>>>        Object oDbGroup2 is a dbGroup
78635>>>            Set Size to 90 440
78636>>>            Set Location to 111 5
78637>>>            Set Label to 'Integraci¢n de Gastos'
78638>>>            Set Color to clScrollBar
78639>>>
78639>>>            Object oSubdetalle_title is a TextBox
78641>>>                Set Auto_Size_State to False
78642>>>                Set Size to 9 290
78643>>>                Set Location to 9 75
78644>>>                Set Label to "-"
78645>>>                Set Color to 16777088
78646>>>            End_Object
78647>>>
78647>>>            Object oSubEgresos is a dbGrid
78649>>>                Set Size to 66 275
78650>>>                Set Location to 19 86
78651>>>
78651>>>                Begin_Row
78654>>>                    Entry_Item SUB_EGRESOS.NUMERO
78655>>>                    Entry_Item SUB_EGRESOS.FECHA_REALIZADO
78656>>>                    Entry_Item SUB_EGRESOS.DESCRIPCION
78657>>>                    Entry_Item SUB_EGRESOS.MONTO
78658>>>                End_Row
78663>>>
78663>>>                Set Main_File to SUB_EGRESOS.File_Number
78664>>>
78664>>>                Set Server to oSUB_EGRESOS_DD
78665>>>
78665>>>                Set Form_Width      item 0 to 19
78666>>>                Set Header_Label    item 0 to "#"
78667>>>                Set Form_Width      item 1 to 60
78668>>>                Set Header_Label    item 1 to "Fecha"
78669>>>                Set Form_Width 2 to 142
78670>>>                Set Header_Label    item 2 to "Descripcion"
78671>>>                Set Form_Width      item 3 to 50
78672>>>                Set Header_Label    item 3 to "Monto"
78673>>>                Set CurrentCellColor to 16777088
78674>>>                Set CurrentRowColor to 8454143
78675>>>            End_Object
78676>>>        End_Object
78677>>>
78677>>>        Object oPanel_TC is a dbContainer3d
78679>>>            Set Size to 40 124
78680>>>            Set Location to 43 159
78681>>>            Set Color to 16776960
78682>>>            Set Popup_State to true
78683>>>    
78683>>>            Object oEGRESOS_TC is a dbForm
78685>>>                Entry_Item EGRESOS.TC
78686>>>    
78686>>>                Set Server to oEGRESOS_DD
78687>>>                Set Location to 15 16
78688>>>                Set Size to 13 51
78689>>>                Set Label to "Tarjeta Credito"
78690>>>                Set Label_Justification_Mode to JMode_Top
78691>>>                Set Label_Col_Offset to 1
78692>>>                Set Prompt_Button_Mode to PB_PromptOn
78693>>>            End_Object
78694>>>    
78694>>>            Object oButton1 is a Button
78696>>>                Set Size to 20 25
78697>>>                Set Location to 10 80
78698>>>                Set Label to 'ok'
78699>>>                Set Bitmap to 'aceptar.bmp'
78700>>>            
78700>>>                // fires when the button is clicked
78700>>>                Procedure OnClick
78703>>>                    Send Msg_Exit to oPanel_TC
78704>>>                End_Procedure
78705>>>            
78705>>>            End_Object
78706>>>        End_Object
78707>>>
78707>>>        Object oEgresos is a dbGrid
78709>>>            Set Size to 100 448
78710>>>            Set Location to 6 5
78711>>>
78711>>>            Begin_Row
78714>>>                Entry_Item EGRESOS.NUMERO
78715>>>                Entry_Item TIPO_GASTO.CLAVE
78716>>>                Entry_Item EGRESOS.DESCRIPCION
78717>>>                Entry_Item EGRESOS.FECHA_REALIZADO
78718>>>                Entry_Item EGRESOS.ES_FIJO_SN
78719>>>                Entry_Item EGRESOS.MONTO_PROYECTADO
78720>>>                Entry_Item EGRESOS.MONTO
78721>>>                Entry_Item EGRESOS.PAGADO_SN
78722>>>                Entry_Item EGRESOS.FORMA_PAGO
78723>>>                Entry_Item EGRESOS.LIQUIDAR
78724>>>                Entry_Item EGRESOS.LIQUIDADO
78725>>>            End_Row
78730>>>
78730>>>            Set Main_File to EGRESOS.File_Number
78731>>>
78731>>>            Set Form_Width 0 to 18
78732>>>            Set Header_Label 0 to "#"
78733>>>            Set Form_Width 1 to 28
78734>>>            Set Header_Label 1 to "Tipo"
78735>>>            Set Form_Width 2 to 105
78736>>>            Set Header_Label 2 to "Descripcion"
78737>>>            Set Form_Width 3 to 47
78738>>>            Set Header_Label 3 to "Fecha"
78739>>>            Set Form_Width 4 to 25
78740>>>            Set Header_Label 4 to "Fijo?"
78741>>>            Set Column_CheckBox_State 4 to True
78742>>>            Set Form_Width 5 to 47
78743>>>            Set Header_Label 5 to "Proyectado"
78744>>>            Set Form_Width 6 to 41
78745>>>            Set Header_Label 6 to "Monto"
78746>>>            Set Form_Width 7 to 27
78747>>>            Set Header_Label 7 to "Pgdo?"
78748>>>            Set Column_CheckBox_State 7 to True
78749>>>            Set Form_Width 8 to 33
78750>>>            Set Header_Label 8 to "F.Pago"
78751>>>            Set Form_Width 9 to 34
78752>>>            Set Header_Label 9 to "Liquidar?"
78753>>>            Set Column_CheckBox_State 9 to True
78754>>>            Set Form_Width 10 to 38
78755>>>            Set Header_Label 10 to "Liquidado"
78756>>>            Set Column_CheckBox_State 10 to True
78757>>>            Set CurrentRowColor to 65535
78758>>>            Set CurrentCellColor to 16777088
78759>>>            Set peGridLineColor to 12369084
78760>>>        End_Object
78761>>>    End_Object
78762>>>
78762>>>    Object oDbContainer3d1 is a dbContainer3d
78764>>>        Set Size to 112 458
78765>>>        Set Location to 3 17
78766>>>
78766>>>        Object oDbGroup1 is a dbGroup
78768>>>            Set Size to 45 360
78769>>>            Set Location to 3 6
78770>>>            Set Label to "PRESUPUESTO"
78771>>>
78771>>>            Object oPRESUPUESTO_NUMERO is a dbForm
78773>>>                Use PRESUPUESTO.sl
Including file: PRESUPUESTO.sl    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\PRESUPUESTO.sl)
78773>>>>>Use Windows.pkg
78773>>>>>Use DFClient.pkg
78773>>>>>Use cDbCJGridPromptList.pkg
78773>>>>>Use cPRESUPUESTO_DataDictionary.dd
78773>>>>>Use cdbCJGridColumn.pkg
78773>>>>>
78773>>>>>Object PRESUPUESTO_SL is a dbModalPanel
78775>>>>>    Object oPRESUPUESTO_DD is a cPRESUPUESTODataDictionary
78777>>>>>    End_Object
78778>>>>>
78778>>>>>    Set Main_DD to oPRESUPUESTO_DD
78779>>>>>    Set Server to oPRESUPUESTO_DD
78780>>>>>
78780>>>>>    Set Size to 94 197
78781>>>>>    Set Location     to 4 5
78782>>>>>    Set Border_Style to Border_Thick
78783>>>>>    Set Label to "PRESUPUESTO"
78784>>>>>
78784>>>>>    Object oSelList is a dbList
78786>>>>>        Set Main_File to PRESUPUESTO.File_Number
78787>>>>>        Set Size to 65 185
78788>>>>>        Set Location to 6 7
78789>>>>>    
78789>>>>>        Begin_Row
78792>>>>>            Entry_Item PRESUPUESTO.Numero
78793>>>>>            Entry_Item PRESUPUESTO.CLAVE
78794>>>>>            Entry_Item PRESUPUESTO.FECHA_INICIO
78795>>>>>            Entry_Item PRESUPUESTO.FECHA_FIN
78796>>>>>        End_Row
78801>>>>>    
78801>>>>>        Set Form_Width 0 to 19
78802>>>>>        Set Header_Label  item 0 to "#"
78803>>>>>        
78803>>>>>        Set Form_Width 1 to 43
78804>>>>>        Set Header_Label  item 1 to "Clave"
78805>>>>>        
78805>>>>>        Set Form_Width 2 to 58
78806>>>>>        Set Header_Label  item 2 to "Fecha Inicio"
78807>>>>>        
78807>>>>>        Set Form_Width 3 to 56
78808>>>>>        Set Header_Label  item 3 to "Fecha Fin"
78809>>>>>        
78809>>>>>         Set Export_Column to  0
78810>>>>>         Set Initial_Column to 0
78811>>>>>        
78811>>>>>    End_Object    // oSelList
78812>>>>>
78812>>>>>    Object oOK_bn is a Button
78814>>>>>        Set Label     to "&OK"
78815>>>>>        Set Location to 76 19
78816>>>>>        Set peAnchors to anBottomRight
78817>>>>>
78817>>>>>        Procedure OnClick
78820>>>>>            Send Ok of oSelList
78821>>>>>        End_Procedure
78822>>>>>
78822>>>>>    End_Object
78823>>>>>
78823>>>>>    Object oCancel_bn is a Button
78825>>>>>        Set Label     to "&Cancel"
78826>>>>>        Set Location to 76 73
78827>>>>>        Set peAnchors to anBottomRight
78828>>>>>
78828>>>>>        Procedure OnClick
78831>>>>>            Send Cancel of oSelList
78832>>>>>        End_Procedure
78833>>>>>
78833>>>>>    End_Object
78834>>>>>
78834>>>>>    Object oSearch_bn is a Button
78836>>>>>        Set Label     to "&Search..."
78837>>>>>        Set Location to 76 127
78838>>>>>        Set peAnchors to anBottomRight
78839>>>>>
78839>>>>>        Procedure OnClick
78842>>>>>            Send Search of oSelList
78843>>>>>        End_Procedure
78844>>>>>
78844>>>>>    End_Object
78845>>>>>
78845>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
78846>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
78847>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
78848>>>>>
78848>>>>>End_Object
78849>>>>>
78849>>>                Entry_Item PRESUPUESTO.NUMERO
78850>>>                Set Location to 10 83
78851>>>                Set Size to 13 48
78852>>>                Set Label to "N£mero:"
78853>>>                Set Label_Col_Offset to 2
78854>>>                Set Label_Justification_Mode to JMode_Right
78855>>>                Set Prompt_Button_Mode to PB_PromptOn
78856>>>                Set Prompt_Object to PRESUPUESTO_SL
78857>>>
78857>>>                Procedure Exiting Handle hoDestination Returns Integer
78860>>>                    Integer iRetVal
78860>>>                    Forward Get msg_Exiting hoDestination to iRetVal
78862>>>                    Local Integer iNumero_presupuesto
78862>>>                    Get Value of oPRESUPUESTO_NUMERO to iNumero_presupuesto
78863>>>                    
78863>>>                    If (iNumero_presupuesto ne 0 or iNumero_presupuesto ne '') Begin
78865>>>                        Clear PRESUPUESTO
78866>>>                        Move iNumero_presupuesto to PRESUPUESTO.NUMERO
78867>>>                        Find eq PRESUPUESTO by Index.1
78868>>>>
78868>>>                        If [not Found] Begin
78870>>>                            Send Stop_Box 'Numero presupuesto Inv lido...' "!"
78871>>>                            Move 1 to iRetVal
78872>>>                        End
78872>>>>
78872>>>                        Else Begin
78873>>>                            Send Request_Find of oPRESUPUESTO_DD GE PRESUPUESTO.File_Number 1 
78874>>>                        End
78874>>>>
78874>>>                    End
78874>>>>
78874>>>                    
78874>>>                    
78874>>>                    Procedure_Return iRetVal
78875>>>                End_Procedure
78876>>>            End_Object
78877>>>
78877>>>            Object oPRESUPUESTO_CLAVE is a dbForm
78879>>>                Entry_Item PRESUPUESTO.CLAVE
78880>>>                Set Location to 10 173
78881>>>                Set Size to 13 48
78882>>>                Set Label to "Clave:"
78883>>>                Set Label_Justification_Mode to JMode_Right
78884>>>                Set Label_Col_Offset to 2
78885>>>            End_Object
78886>>>
78886>>>            Object oPRESUPUESTO_VLR_EFECTIVO is a dbForm
78888>>>                Entry_Item PRESUPUESTO.VLR_EFECTIVO
78889>>>                Set Location to 25 83
78890>>>                Set Size to 13 48
78891>>>                Set Label to "Efectivo"
78892>>>                Set Numeric_Mask 0 to 4 2
78893>>>                Set Label_Col_Offset to 2
78894>>>                Set Label_Justification_Mode to JMode_Right
78895>>>            End_Object
78896>>>
78896>>>            Object oPRESUPUESTO_VLR_QUINCENA is a dbForm
78898>>>                Entry_Item PRESUPUESTO.VLR_QUINCENA
78899>>>                Set Location to 25 173
78900>>>                Set Size to 13 48
78901>>>                Set Label to "Quincena"
78902>>>                Set Numeric_Mask 0 to 4 2
78903>>>                Set Label_Col_Offset to 2
78904>>>                Set Label_Justification_Mode to JMode_Right
78905>>>            End_Object
78906>>>            Object oPRESUPUESTO_FECHA_INICIO is a dbForm
78908>>>                Entry_Item PRESUPUESTO.FECHA_INICIO
78909>>>                Set Location to 10 267
78910>>>                Set Size to 13 48
78911>>>                Set Label to "Fecha Inicio:"
78912>>>                Set Label_Col_Offset to 2
78913>>>                Set Label_Justification_Mode to JMode_Right
78914>>>            End_Object
78915>>>            Object oPRESUPUESTO_FECHA_FIN is a dbForm
78917>>>                Entry_Item PRESUPUESTO.FECHA_FIN
78918>>>                Set Location to 25 267
78919>>>                Set Size to 13 48
78920>>>                Set Label to "Fecha Fin:"
78921>>>                Set Label_Col_Offset to 2
78922>>>                Set Label_Justification_Mode to JMode_Right
78923>>>
78923>>>                Procedure Exiting Handle hoDestination Returns Integer
78926>>>                    Integer iRetVal
78926>>>                    Forward Get msg_Exiting hoDestination to iRetVal
78928>>>                    Send Request_Save of oPRESUPUESTO_DD
78929>>>                    Procedure_Return iRetVal
78930>>>                End_Procedure
78931>>>            End_Object
78932>>>        End_Object
78933>>>
78933>>>        Object oDbContainer3d4 is a dbContainer3d
78935>>>            Set Size to 37 360
78936>>>            Set Location to 50 6
78937>>>            Set Border_Style to Border_StaticEdge
78938>>>
78938>>>            Object oTOTAL_INGRESOS is a Form
78940>>>                Set Size to 13 47
78941>>>                Set Location to 4 73
78942>>>                Set Label_Col_Offset to 2
78943>>>                Set Label to "Total Ingresos:"
78944>>>                Set Label_Justification_Mode to JMode_Right
78945>>>                Set Numeric_Mask item 0 to 8 2 ",*"
78946>>>                Set Entry_State to False
78947>>>            
78947>>>                // OnChange is called on every changed character
78947>>>            //    Procedure OnChange
78947>>>            //        String sValue
78947>>>            //    
78947>>>            //        Get Value to sValue
78947>>>            //    End_Procedure
78947>>>            
78947>>>            End_Object
78948>>>            Object oTOTAL_E is a Form
78950>>>                Set Size to 13 47
78951>>>                Set Location to 19 73
78952>>>                Set Numeric_Mask 0 to 4 2
78953>>>                Set Label to "Total Egresos:"
78954>>>                Set Label_Col_Offset to 2
78955>>>                Set Label_Justification_Mode to JMode_Right
78956>>>                Set Numeric_Mask item 0 to 8 2 ",*"
78957>>>                Set Entry_State to False
78958>>>            End_Object
78959>>>
78959>>>            Object oDIFERENCIA2 is a Form
78961>>>                Set Size to 13 47
78962>>>                Set Location to 19 124
78963>>>                Set Numeric_Mask 0 to 4 2
78964>>>                Set Label_Col_Offset to -1
78965>>>                Set Label to "Diferencia:"
78966>>>                Set Label_Justification_Mode to JMode_Top
78967>>>                Set Numeric_Mask item 0 to 8 2 ",*"
78968>>>                Set Enabled_State to False
78969>>>                Set Entry_State to False
78970>>>            End_Object
78971>>>
78971>>>            Object oTOTAL_PGDO is a Form
78973>>>                Set Size to 13 47
78974>>>                Set Location to 4 231
78975>>>                Set Numeric_Mask 0 to 4 2
78976>>>                Set Entry_State to False
78977>>>                Set Label to "Total Pagado:"
78978>>>                Set Label_Col_Offset to 2
78979>>>                Set Label_Justification_Mode to JMode_Right
78980>>>                Set Numeric_Mask item 0 to 8 2 ",*"
78981>>>                Set Enabled_State to False
78982>>>            End_Object
78983>>>            Object oPENDIENTE is a Form
78985>>>                Set Size to 13 47
78986>>>                Set Location to 19 231
78987>>>                Set Numeric_Mask 0 to 4 2
78988>>>                Set Entry_State to False
78989>>>                Set Label to "Pendiente Pgo:"
78990>>>                Set Label_Col_Offset to 2
78991>>>                Set Label_Justification_Mode to JMode_Right
78992>>>                Set Numeric_Mask item 0 to 8 2 ",*"
78993>>>            End_Object
78994>>>
78994>>>            Object oDISPONIBLE is a Form
78996>>>                Set Size to 13 47
78997>>>                Set Location to 19 280
78998>>>                Set Numeric_Mask 0 to 4 2
78999>>>                Set Entry_State to False
79000>>>                Set Label_Col_Offset to 0
79001>>>                Set Label_Justification_Mode to JMode_Top
79002>>>                Set Label to "Disponible:"
79003>>>                Set Numeric_Mask item 0 to 8 2 ",*"
79004>>>            End_Object
79005>>>        End_Object
79006>>>
79006>>>        Object oVISTA is a RadioGroup
79008>>>            Set Location to 86 6
79009>>>            Set Size to 21 207
79010>>>            Set Current_Radio to 3  // Inicializa en "Todos"
79011>>>        
79011>>>            Object oRadio1 is a Radio
79013>>>                Set Label to "Pendientes"
79014>>>                Set Size to 10 47
79015>>>                Set Location to 8 5
79016>>>                
79016>>>            End_Object
79017>>>        
79017>>>            Object oRadio2 is a Radio
79019>>>                Set Label to "Pagados"
79020>>>                Set Size to 10 40
79021>>>                Set Location to 8 58
79022>>>            End_Object
79023>>>        
79023>>>            Object oRadio3 is a Radio
79025>>>                Set Label to "No esperados"
79026>>>                Set Size to 10 60
79027>>>                Set Location to 8 102
79028>>>            End_Object
79029>>>        
79029>>>            Procedure Notify_Select_State Integer iToItem Integer iFromItem
79032>>>                Forward Send Notify_Select_State iToItem iFromItem
79034>>>                If (iToItem eq 0) Set psFiltro to " PAGADO_SN = 'N'"
79037>>>                If (iToItem eq 1) Set psFiltro to " PAGADO_SN = 'S'"
79040>>>                If (iToItem eq 2) Set psFiltro to " MONTO > MONTO_PROYECTADO "
79043>>>                If (iToItem eq 3) Set psFiltro to ""
79046>>>                Set piOpcionVista to iToItem
79047>>>                Send Totales
79048>>>                Send OnConstrain of oEGRESOS_DD
79049>>>                Send Beginning_of_Data to oEgresos
79050>>>            End_Procedure
79051>>>
79051>>>            Object oRadio4 is a Radio
79053>>>                Set Size to 10 50
79054>>>                Set Location to 9 169
79055>>>                Set Label to "Todos"
79056>>>            End_Object
79057>>>        
79057>>>            // If you set Current_Radio, you must set it AFTER the
79057>>>            // radio objects have been created AND AFTER Notify_Select_State has been
79057>>>            // created. i.e. Set in bottom-code of object at the end!!
79057>>>        //    Set Current_Radio to 0
79057>>>        
79057>>>        End_Object
79058>>>
79058>>>        Object oTIPO_GASTO is a RadioGroup
79060>>>            Set Location to 86 217
79061>>>            Set Size to 21 149
79062>>>        
79062>>>            Procedure Notify_Select_State Integer iToItem Integer iFromItem
79065>>>                Forward Send Notify_Select_State iToItem iFromItem
79067>>>                If (iToItem eq 0) Set psOpcionPago to 'TODOS'
79070>>>                If (iToItem eq 1) Set psOpcionPago to 'TD'
79073>>>                If (iToItem eq 2) Set psOpcionPago to 'TC'
79076>>>                If (iToItem eq 3) Set psOpcionPago to 'EF'
79079>>>                Send Totales
79080>>>                Send OnConstrain of oEGRESOS_DD
79081>>>                send Beginning_of_Data to oEgresos
79082>>>                // for augmentation
79082>>>            End_Procedure
79083>>>
79083>>>            Object oRadio1 is a Radio
79085>>>                Set Label to "Todos"
79086>>>                Set Size to 10 32
79087>>>                Set Location to 8 10
79088>>>            End_Object
79089>>>            Object oRadio2 is a Radio
79091>>>                Set Label to "TD"
79092>>>                Set Size to 10 23
79093>>>                Set Location to 8 50
79094>>>            End_Object
79095>>>            Object oRadio3 is a Radio
79097>>>                Set Label to "TC"
79098>>>                Set Size to 10 23
79099>>>                Set Location to 8 83
79100>>>            End_Object
79101>>>            Object oRadio4 is a Radio
79103>>>                Set Size to 10 23
79104>>>                Set Location to 9 116
79105>>>                Set Label to "EF"
79106>>>            End_Object
79107>>>        
79107>>>            // If you set Current_Radio, you must set it AFTER the
79107>>>            // radio objects have been created AND AFTER Notify_Select_State has been
79107>>>            // created. i.e. Set in bottom-code of object at the end!!
79107>>>        //    Set Current_Radio to 0
79107>>>        
79107>>>        End_Object
79108>>>
79108>>>        Object oCargaFijos is a Button
79110>>>            Set Size to 23 30
79111>>>            Set Location to 8 374
79112>>>            Set Label to 'CargaFijos'
79113>>>            Set Bitmap to 'upload.bmp'
79114>>>        
79114>>>            // fires when the button is clicked
79114>>>            Procedure OnClick
79117>>>                Send Cargar_Eg_Fijos
79118>>>            End_Procedure
79119>>>        
79119>>>        End_Object
79120>>>        Object oTextBox1 is a TextBox
79122>>>            Set Size to 9 40
79123>>>            Set Location to 33 371
79124>>>            Set Label to 'Cargar Fijos'
79125>>>        End_Object
79126>>>        Object oCargaPendientes is a Button
79128>>>            Set Size to 23 30
79129>>>            Set Location to 50 375
79130>>>            Set Label to 'Carga Pendientes'
79131>>>            Set Bitmap to 'getmoney.bmp'
79132>>>        
79132>>>            // fires when the button is clicked
79132>>>            Procedure OnClick
79135>>>                Local Integer iConfirm
79135>>>                Get Confirm 'Se cargar n los Movimientos a cr‚dito pagados de la quincena anterior, desea continuar?' 'Atencion!' to iConfirm
79136>>>                
79136>>>                If (iConfirm eq 1) Procedure_Return
79139>>>                
79139>>>                Send Cargar_Eg_Pendientes
79140>>>            End_Procedure
79141>>>        
79141>>>        End_Object
79142>>>        Object oTextBox2 is a TextBox
79144>>>            Set Auto_Size_State to False
79145>>>            Set Size to 23 38
79146>>>            Set Location to 76 376
79147>>>            Set Label to 'Cargar Gastos Pendientes'
79148>>>            Set Justification_Mode to JMode_Left
79149>>>        End_Object
79150>>>
79150>>>        Object oLiquidar is a Button
79152>>>            Set Size to 23 30
79153>>>            Set Location to 8 417
79154>>>            Set Label to 'CargaFijos'
79155>>>            Set Bitmap to 'Tarjeta_mini.bmp'
79156>>>        
79156>>>            // fires when the button is clicked
79156>>>            Procedure OnClick
79159>>>                Send Liquidar
79160>>>            End_Procedure
79161>>>        
79161>>>        End_Object
79162>>>
79162>>>        Object oTextBox1 is a TextBox
79164>>>            Set Size to 9 40
79165>>>            Set Location to 33 419
79166>>>            Set Label to "Liquidar"
79167>>>        End_Object
79168>>>    End_Object
79169>>>
79169>>>Cd_End_Object
79171>>>>
79171>        Use TIPO_GASTO.vw
Including file: TIPO_GASTO.vw    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\TIPO_GASTO.vw)
79171>>>Use Windows.pkg
79171>>>Use DFClient.pkg
79171>>>Use cTIPO_GASTO_DataDictionary.dd
79171>>>Use cDbCJGrid.pkg
79171>>>Use cdbCJGridColumn.pkg
79171>>>
79171>>>Deferred_View Activate_TIPO_GASTO for ;Object TIPO_GASTO is a dbView
79196>>>    Object oTIPO_GASTO_DD is a cTIPO_GASTO_DataDictionary
79198>>>    End_Object
79199>>>
79199>>>    Set Main_DD to oTIPO_GASTO_DD
79200>>>    Set Server to oTIPO_GASTO_DD
79201>>>
79201>>>    Set Border_Style to Border_Thick
79202>>>    Set Size to 142 300
79203>>>    Set Location to 2 2
79204>>>    Set Label to "Catalogo Tipos de Gastos"
79205>>>
79205>>>    Object oDbGroup1 is a dbGroup
79207>>>        Set Size to 130 277
79208>>>        Set Location to 6 9
79209>>>        Set Label to 'Cat logo Tipo de Gastos'
79210>>>
79210>>>        Object oDbCJGrid1 is a cDbCJGrid
79212>>>            Set Size to 100 267
79213>>>            Set Location to 12 5
79214>>>
79214>>>            Object oTIPO_GASTO_NUMERO is a cDbCJGridColumn
79216>>>                Entry_Item TIPO_GASTO.NUMERO
79217>>>                Set piWidth to 70
79218>>>                Set psCaption to "#"
79219>>>            End_Object
79220>>>
79220>>>            Object oTIPO_GASTO_CLAVE is a cDbCJGridColumn
79222>>>                Entry_Item TIPO_GASTO.CLAVE
79223>>>                Set piWidth to 77
79224>>>                Set psCaption to "Clave"
79225>>>                Set pbCapslock to True
79226>>>            End_Object
79227>>>
79227>>>            Object oTIPO_GASTO_DESCRIPCION is a cDbCJGridColumn
79229>>>                Entry_Item TIPO_GASTO.DESCRIPCION
79230>>>                Set piWidth to 387
79231>>>                Set psCaption to "Descripcion"
79232>>>            End_Object
79233>>>        End_Object
79234>>>    End_Object
79235>>>
79235>>>Cd_End_Object
79237>>>>
79237>        Use GASTOS_01.rv
Including file: GASTOS_01.rv    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\GASTOS_01.rv)
79237>>>Use Windows.pkg
79237>>>Use DFRptVw.pkg
79237>>>Use DFRpt.pkg
79237>>>Use File_Dlg.Pkg
79237>>>Use PRESUPUESTO.sl
79237>>>
79237>>>Activate_View Activate_GASTOS_01 for GASTOS_01
79247>>>>
79247>>>Object GASTOS_01 is a ReportView
79249>>>    Set Location to 6 6
79250>>>    Set Size to 56 181
79251>>>    Set Label to "Grafica de Gastos"
79252>>>
79252>>>    Object oOkButton is a Button
79254>>>        Set Label to "&OK"
79255>>>        Set Location to 35 38
79256>>>        Set Default_State to TRUE
79257>>>
79257>>>        Procedure OnClick
79260>>>            Send Comenzar_reporte
79261>>>        End_Procedure
79262>>>
79262>>>    End_Object
79263>>>
79263>>>    Object oCancelButton is a Button
79265>>>        Set Label to "&Cancel"
79266>>>        Set Location to 35 93
79267>>>
79267>>>        Procedure OnClick
79270>>>            Send Request_Cancel
79271>>>        End_Procedure
79272>>>
79272>>>    End_Object
79273>>>
79273>>>    Object oSaveAsDialog is a SaveAsDialog
79275>>>    End_Object
79276>>>
79276>>>     Procedure Comenzar_reporte
79279>>>        Set Report_name of (S4006(Current_Object)) to "Report2.rpt"
79280>>>        Send Run_Report to (S4006(Current_Object))
79281>>>    End_Procedure
79282>>>    
79282>>>    Object S4006 is a WinQLReport
79284>>>        Set Output_Destination to WQL_PRINT_TO_WINDOW
79285>>>    
79285>>>        Procedure OnInitializeReport
79288>>>            Forward Send OninitializeReport
79290>>>            Local Number nPresupuesto
79290>>>            Local String @Seleccion
79290>>>            
79290>>>            Get Value of oPRESUPUESTO to nPresupuesto
79291>>>            Move '' to @Seleccion
79292>>>            
79292>>>            Clear PRESUPUESTO
79293>>>            Move nPresupuesto to PRESUPUESTO.NUMERO
79294>>>            Find eq PRESUPUESTO by Index.1
79295>>>>
79295>>>            If [not Found] Begin
79297>>>                Send Stop_Box 'Ingrese un presupuesto valido' '!'
79298>>>                Procedure_Return
79299>>>            End
79299>>>>
79299>>>            
79299>>>            If (nPresupuesto ne 0)   Begin
79301>>>                Append @Seleccion '  {PRESUPUESTO.NUMERO} = ' PRESUPUESTO.NUMERO
79303>>>            End
79303>>>>
79303>>>            
79303>>>            Set SelectionFormula      to @Seleccion
79304>>>        End_Procedure
79305>>>        
79305>>>    End_Object
79306>>>
79306>>>    Object oPRESUPUESTO is a Form
79308>>>        Set Size to 13 69
79309>>>        Set Location to 10 72
79310>>>        Set Label_Col_Offset to 2
79311>>>        Set Label to "Presupuesto:"
79312>>>        Set Label_Justification_Mode to JMode_Right
79313>>>        Set Prompt_Button_Mode to PB_PromptOn
79314>>>        Set Prompt_Object to PRESUPUESTO_SL
79315>>>    
79315>>>        // OnChange is called on every changed character
79315>>>    //    Procedure OnChange
79315>>>    //        String sValue
79315>>>    //    
79315>>>    //        Get Value to sValue
79315>>>    //    End_Procedure
79315>>>    
79315>>>    End_Object
79316>>>    
79316>>>    On_Key Key_Alt+Key_O Send KeyAction of oOkButton
79317>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancelButton
79318>>>
79318>>>End_Object
79319>        Use GASTOS_02.rv
Including file: GASTOS_02.rv    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\GASTOS_02.rv)
79319>>>Use Windows.pkg
79319>>>Use DFRptVw.pkg
79319>>>Use DFRpt.pkg
79319>>>Use File_Dlg.Pkg
79319>>>Use PRESUPUESTO.sl
79319>>>
79319>>>Activate_View Activate_GASTOS_02 for GASTOS_02
79329>>>>
79329>>>Object GASTOS_02 is a ReportView
79331>>>    Set Location to 6 6
79332>>>    Set Size to 59 181
79333>>>    Set Label to "Listado de Gastos"
79334>>>
79334>>>    Object oOkButton is a Button
79336>>>        Set Label to "&OK"
79337>>>        Set Location to 34 42
79338>>>        Set Default_State to TRUE
79339>>>
79339>>>        Procedure OnClick
79342>>>            Send Comenzar_reporte
79343>>>        End_Procedure
79344>>>
79344>>>    End_Object
79345>>>
79345>>>    Object oCancelButton is a Button
79347>>>        Set Label to "&Cancel"
79348>>>        Set Location to 34 97
79349>>>
79349>>>        Procedure OnClick
79352>>>            Send Request_Cancel
79353>>>        End_Procedure
79354>>>
79354>>>    End_Object
79355>>>
79355>>>    Object oSaveAsDialog is a SaveAsDialog
79357>>>    End_Object
79358>>>
79358>>>     Procedure Comenzar_reporte
79361>>>        Set Report_name of (S4006(Current_Object)) to "Report1.rpt"
79362>>>        Send Run_Report to (S4006(Current_Object))
79363>>>        
79363>>>    End_Procedure
79364>>>    
79364>>>    Object S4006 is a WinQLReport
79366>>>        Set Output_Destination to WQL_PRINT_TO_WINDOW
79367>>>    
79367>>>        Procedure OnInitializeReport
79370>>>            Forward Send OninitializeReport
79372>>>            Local Number nPresupuesto
79372>>>            Local String @Seleccion
79372>>>            
79372>>>            Get Value of oPRESUPUESTO to nPresupuesto
79373>>>            Move '' to @Seleccion
79374>>>            
79374>>>            Clear PRESUPUESTO
79375>>>            Move nPresupuesto to PRESUPUESTO.NUMERO
79376>>>            Find eq PRESUPUESTO by Index.1
79377>>>>
79377>>>            If [not Found] Begin
79379>>>                Send Stop_Box 'Ingrese un presupuesto valido' '!'
79380>>>                Procedure_Return
79381>>>            End
79381>>>>
79381>>>            
79381>>>            If (nPresupuesto ne 0)   Begin
79383>>>                Append @Seleccion '  {PRESUPUESTO.NUMERO} = ' PRESUPUESTO.NUMERO
79385>>>            End
79385>>>>
79385>>>            
79385>>>            Set SelectionFormula      to @Seleccion
79386>>>        End_Procedure
79387>>>        
79387>>>    End_Object
79388>>>
79388>>>    Object oPRESUPUESTO is a Form
79390>>>        Set Size to 13 69
79391>>>        Set Location to 10 67
79392>>>        Set Label_Col_Offset to 2
79393>>>        Set Label to "Presupuesto:"
79394>>>        Set Label_Justification_Mode to JMode_Right
79395>>>        Set Prompt_Button_Mode to PB_PromptOn
79396>>>        Set Prompt_Object to PRESUPUESTO_SL
79397>>>    
79397>>>        // OnChange is called on every changed character
79397>>>    //    Procedure OnChange
79397>>>    //        String sValue
79397>>>    //    
79397>>>    //        Get Value to sValue
79397>>>    //    End_Procedure
79397>>>    
79397>>>    End_Object
79398>>>    
79398>>>    On_Key Key_Alt+Key_O Send KeyAction of oOkButton
79399>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancelButton
79400>>>
79400>>>End_Object
79401>        Use AHORRO.vw
Including file: AHORRO.vw    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\AHORRO.vw)
79401>>>Use Windows.pkg
79401>>>Use DFClient.pkg
79401>>>Use cAHORRO_H_DataDictionary.dd
Including file: cAHORRO_H_DataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cAHORRO_H_DataDictionary.dd)
79401>>>>>Use DataDict.pkg
79401>>>>>
79401>>>>>Open AHORRO_H
Including file: AHORRO_H.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\AHORRO_H.fd)
79403>>>>>Open AHORRO_D
Including file: AHORRO_D.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\AHORRO_D.fd)
79405>>>>>
79405>>>>>Class cAHORRO_H_DataDictionary is a DataDictionary
79406>>>>>    
79406>>>>>    Procedure Construct_Object
79408>>>>>        Forward Send Construct_Object
79410>>>>>        Set Main_File to AHORRO_H.File_Number
79411>>>>>
79411>>>>>        Set Add_Client_File to AHORRO_D.File_Number
79412>>>>>
79412>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79413>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79414>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79415>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79416>>>>>
79416>>>>>        Set Field_Class_Name Field AHORRO_H.PRIORIDAD to "Combo"
79417>>>>>
79417>>>>>    End_Procedure
79418>>>>>
79418>>>>>    Procedure Field_Defaults
79420>>>>>        Forward Send Field_Defaults
79422>>>>>    End_Procedure
79423>>>>>
79423>>>>>End_Class
79424>>>Use cAHORRO_D_DataDictionary.dd
Including file: cAHORRO_D_DataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cAHORRO_D_DataDictionary.dd)
79424>>>>>Use DataDict.pkg
79424>>>>>
79424>>>>>Open AHORRO_D
79426>>>>>Open AHORRO_H
79428>>>>>
79428>>>>>Class cAHORRO_D_DataDictionary is a DataDictionary
79429>>>>>    
79429>>>>>    Procedure Construct_Object
79431>>>>>        Forward Send Construct_Object
79433>>>>>        Set Main_File to AHORRO_D.File_Number
79434>>>>>
79434>>>>>        Set Add_Server_File to AHORRO_H.File_Number
79435>>>>>
79435>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79436>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79437>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79438>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79439>>>>>
79439>>>>>        Set Field_Class_Name Field AHORRO_D.PAGADO_SN to "Checkbox"
79440>>>>>        Set Field_Checkbox_Values Field AHORRO_D.PAGADO_SN to "S" "N"
79441>>>>>
79441>>>>>    End_Procedure
79442>>>>>
79442>>>>>    Procedure Field_Defaults
79444>>>>>        Forward Send Field_Defaults
79446>>>>>        Set Field_Changed_Value Field AHORRO_D.PAGADO_SN to "N"
79447>>>>>    End_Procedure
79448>>>>>
79448>>>>>End_Class
79449>>>Use DFEntry.pkg
79449>>>Use cDbCJGrid.pkg
79449>>>Use cdbCJGridColumn.pkg
79449>>>Use DfCentry.pkg
79449>>>
79449>>>Deferred_View Activate_AHORRO for ;Object AHORRO is a dbView
79474>>>    Object oAHORRO_H_DD is a cAHORRO_H_DataDictionary
79476>>>        Procedure Relate_Main_File 
79479>>>            Forward Send Relate_Main_File
79481>>>                Set Shadow_State of oAHORRO_H_DESCRIPCION         to True
79482>>>                Set Shadow_State of oAHORRO_H_FECHA_INICIO        to True
79483>>>                Set Shadow_State of oAHORRO_H_FECHA_OBJETIVO      to True 
79484>>>                Set Shadow_State of oAHORRO_H_PRIORIDAD           to True
79485>>>            Send Totales
79486>>>        End_Procedure
79487>>>    End_Object
79488>>>    
79488>>>    Procedure Request_Clear
79491>>>        Forward Send Request_Clear
79493>>>        Set Shadow_State of oAHORRO_H_DESCRIPCION         to False
79494>>>        Set Shadow_State of oAHORRO_H_FECHA_INICIO        to False
79495>>>        Set Shadow_State of oAHORRO_H_FECHA_OBJETIVO      to False 
79496>>>        Set Shadow_State of oAHORRO_H_PRIORIDAD           to False
79497>>>        Set Value of oTOTAL         to ''
79498>>>        Set Value of oTOTAL_PROYECT to ''
79499>>>    End_Procedure
79500>>>    
79500>>>    Procedure Request_Clear_All
79503>>>        Forward Send Request_Clear_All
79505>>>        Set Shadow_State of oAHORRO_H_DESCRIPCION         to False
79506>>>        Set Shadow_State of oAHORRO_H_FECHA_INICIO        to False
79507>>>        Set Shadow_State of oAHORRO_H_FECHA_OBJETIVO      to False 
79508>>>        Set Shadow_State of oAHORRO_H_PRIORIDAD           to False
79509>>>        Set Value of oTOTAL         to ''
79510>>>        Set Value of oTOTAL_PROYECT to ''
79511>>>    End_Procedure
79512>>>
79512>>>    Object oAHORRO_D_DD is a cAHORRO_D_DataDictionary
79514>>>        Set Constrain_file to AHORRO_H.File_number
79515>>>        Set DDO_Server to oAHORRO_H_DD
79516>>>        
79516>>>        
79516>>>        Procedure request_save
79519>>>            Forward Send Request_Save
79521>>>            Move AHORRO_H.NUMERO to AHORRO_D.AHORRO_H
79522>>>        End_Procedure
79523>>>    End_Object
79524>>>    
79524>>>    //FUNCIONES Y PROCEDIMIENTOS
79524>>>    Procedure Totales 
79527>>>        Local String sQ
79527>>>        Local Handle hdbc69 hstmt69
79527>>>        Local Number nMonto nMontoEsp nValPgdo nValDispo
79527>>>    
79527>>>        Move '' to sQ
79528>>>        Move 0  to nMonto
79529>>>        Move 0  to nMontoEsp
79530>>>        Append sQ " SELECT SUM(MONTO) FROM AHORRO_D WHERE PAGADO_SN = 'S' AND AHORRO_H =  " AHORRO_H.NUMERO 
79532>>>        SQLFileConnect EGRESOS to hdbc69
79533>>>        SQLOpen hdbc69 to hstmt69
79536>>>        SQLExecDirect hstmt69 sQ
79539>>>        Repeat
79539>>>>
79539>>>           SQLFileFetch hstmt69
79545>>>           If (SQLResult) Begin
79547>>>              Get SQLColumnValue of hstmt69   1 to nMonto
79548>>>           End
79548>>>>
79548>>>        Until (not(SQLResult))
79550>>>        SQLClose hstmt69
79553>>>        SQLDisconnect hdbc69
79556>>>        
79556>>>        Move '' to sQ
79557>>>        Append sQ " SELECT SUM(MONTO_PROYECTADO) FROM AHORRO_D WHERE AHORRO_H =  " AHORRO_H.NUMERO //SUM(MONTO_PROYECTADO)
79559>>>        SQLFileConnect EGRESOS to hdbc69
79560>>>        SQLOpen hdbc69 to hstmt69
79563>>>        SQLExecDirect hstmt69 sQ
79566>>>        Repeat
79566>>>>
79566>>>           SQLFileFetch hstmt69
79572>>>           If (SQLResult) Begin
79574>>>              Get SQLColumnValue of hstmt69   1 to nMontoEsp
79575>>>           End
79575>>>>
79575>>>        Until (not(SQLResult))
79577>>>        SQLClose hstmt69
79580>>>        SQLDisconnect hdbc69
79583>>>        
79583>>>        Set Value of oTOTAL         to nMonto
79584>>>        Set Value of oTOTAL_PROYECT to nMontoEsp
79585>>>        
79585>>>    End_Procedure
79586>>>
79586>>>    Set Main_DD to oAHORRO_H_DD
79587>>>    Set Server to oAHORRO_H_DD
79588>>>
79588>>>    Set Border_Style to Border_Thick
79589>>>    Set Size to 266 336
79590>>>    Set Location to 2 2
79591>>>    Set Label to "Control De Ahorros..."
79592>>>    Set Color to 9824917
79593>>>
79593>>>    Object oDbContainer3d1 is a dbContainer3d
79595>>>        Set Size to 108 315
79596>>>        Set Location to 3 11
79597>>>
79597>>>        Object oDbGroup1 is a dbGroup
79599>>>            Set Size to 101 238
79600>>>            Set Location to 1 5
79601>>>            Set Label to 'Ahorro'
79602>>>
79602>>>            Object oAHORRO_H_NUMERO is a dbForm
79604>>>                Entry_Item AHORRO_H.NUMERO
79605>>>                Set Location to 17 67
79606>>>                Set Size to 13 66
79607>>>                Set Label to "NUMERO:"
79608>>>            End_Object
79609>>>
79609>>>            Object oAHORRO_H_DESCRIPCION is a dbForm
79611>>>                Entry_Item AHORRO_H.DESCRIPCION
79612>>>                Set Location to 32 67
79613>>>                Set Size to 13 139
79614>>>                Set Label to "DESCRIPCION:"
79615>>>            End_Object
79616>>>
79616>>>            Object oAHORRO_H_FECHA_INICIO is a dbForm
79618>>>                Entry_Item AHORRO_H.FECHA_INICIO
79619>>>                Set Location to 47 67
79620>>>                Set Size to 13 66
79621>>>                Set Label to "FECHA INICIO:"
79622>>>            End_Object
79623>>>
79623>>>            Object oAHORRO_H_FECHA_OBJETIVO is a dbForm
79625>>>                Entry_Item AHORRO_H.FECHA_OBJETIVO
79626>>>                Set Location to 62 67
79627>>>                Set Size to 13 66
79628>>>                Set Label to "FECHA OBJETIVO:"
79629>>>            End_Object
79630>>>
79630>>>            Object oAHORRO_H_PRIORIDAD is a dbComboForm
79632>>>                Entry_Item AHORRO_H.PRIORIDAD
79633>>>                Set Location to 79 67
79634>>>                Set Size to 13 66
79635>>>                Set Label to "PRIORIDAD:"
79636>>>                
79636>>>                Procedure Combo_Fill_List
79639>>>                    Send Combo_Add_Item "ALTA"
79640>>>                    Send Combo_Add_Item "MEDIA"
79641>>>                    Send Combo_Add_Item "BAJA"
79642>>>                End_Procedure
79643>>>
79643>>>            End_Object
79644>>>        End_Object
79645>>>
79645>>>        Object oTOTAL is a dbForm
79647>>>            Set Size to 13 57
79648>>>            Set Location to 87 249
79649>>>            Set Entry_State to False
79650>>>            Set Color to 4643654
79651>>>            Set Numeric_Mask 0 to 4 2
79652>>>        End_Object
79653>>>
79653>>>        Object oTOTAL_PROYECT is a dbForm
79655>>>            Set Size to 13 57
79656>>>            Set Location to 64 249
79657>>>            Set Entry_State to False
79658>>>            Set Numeric_Mask 0 to 4 2
79659>>>        End_Object
79660>>>
79660>>>        Object oTextBox1 is a TextBox
79662>>>            Set Size to 9 40
79663>>>            Set Location to 78 250
79664>>>            Set Label to 'Total Actual'
79665>>>        End_Object
79666>>>
79666>>>        Object oTextBox1 is a TextBox
79668>>>            Set Size to 9 57
79669>>>            Set Location to 55 250
79670>>>            Set Label to 'Total Proyectado'
79671>>>        End_Object
79672>>>    End_Object
79673>>>
79673>>>    Object oDbContainer3d2 is a dbContainer3d
79675>>>        Set Size to 148 314
79676>>>        Set Location to 114 12
79677>>>
79677>>>        Object oDbCJGrid1 is a cDbCJGrid
79679>>>            Set Server to oAHORRO_D_DD
79680>>>            Set Size to 139 301
79681>>>            Set Location to 3 4
79682>>>
79682>>>            Object oAHORRO_D_NUMERO is a cDbCJGridColumn
79684>>>                Entry_Item AHORRO_D.NUMERO
79685>>>                Set piWidth to 45
79686>>>                Set psCaption to "#"
79687>>>            End_Object
79688>>>
79688>>>            Object oAHORRO_D_DESCRIPCION is a cDbCJGridColumn
79690>>>                Entry_Item AHORRO_D.DESCRIPCION
79691>>>                Set piWidth to 239
79692>>>                Set psCaption to "Descripcion"
79693>>>            End_Object
79694>>>
79694>>>            Object oAHORRO_D_MONTO is a cDbCJGridColumn
79696>>>                Entry_Item AHORRO_D.MONTO
79697>>>                Set piWidth to 79
79698>>>                Set psCaption to "Monto"
79699>>>            End_Object
79700>>>
79700>>>            Object oAHORRO_D_MONTO_PROYECTADO is a cDbCJGridColumn
79702>>>                Entry_Item AHORRO_D.MONTO_PROYECTADO
79703>>>                Set piWidth to 89
79704>>>                Set psCaption to "Mnto Espe."
79705>>>            End_Object
79706>>>
79706>>>            Object oAHORRO_D_PAGADO_SN is a cDbCJGridColumn
79708>>>                Entry_Item AHORRO_D.PAGADO_SN
79709>>>                Set piWidth to 52
79710>>>                Set psCaption to "Pgdo?"
79711>>>                Set pbCheckbox to True
79712>>>            End_Object
79713>>>
79713>>>            Object oAHORRO_D_FECHA_REALIZADO is a cDbCJGridColumn
79715>>>                Entry_Item AHORRO_D.FECHA_REALIZADO
79716>>>                Set piWidth to 98
79717>>>                Set psCaption to "Fecha"
79718>>>            End_Object
79719>>>        End_Object
79720>>>    End_Object
79721>>>
79721>>>Cd_End_Object
79723>>>>
79723>        Use Deudas.vw
Including file: Deudas.vw    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\Deudas.vw)
79723>>>Use Windows.pkg
79723>>>Use DFClient.pkg
79723>>>Use cDEUDA_H_DataDictionary.dd
Including file: cDEUDA_H_DataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cDEUDA_H_DataDictionary.dd)
79723>>>>>Use DataDict.pkg
79723>>>>>
79723>>>>>Open DEUDA_H
Including file: DEUDA_H.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\DEUDA_H.fd)
79725>>>>>Open DEUDA_D
Including file: DEUDA_D.fd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\DEUDA_D.fd)
79727>>>>>
79727>>>>>Class cDEUDA_H_DataDictionary is a DataDictionary
79728>>>>>    
79728>>>>>    Procedure Construct_Object
79730>>>>>        Forward Send Construct_Object
79732>>>>>        Set Main_File to DEUDA_H.File_Number
79733>>>>>
79733>>>>>        Set Add_Client_File to DEUDA_D.File_Number
79734>>>>>
79734>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79735>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79736>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79737>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79738>>>>>
79738>>>>>        Set Field_Checkbox_Values Field DEUDA_H.A_FAVOR to "S" "N"
79739>>>>>        Set Field_Class_Name Field DEUDA_H.A_FAVOR to "Checkbox"
79740>>>>>
79740>>>>>    End_Procedure
79741>>>>>
79741>>>>>    Procedure Field_Defaults
79743>>>>>        Forward Send Field_Defaults
79745>>>>>        Set Field_Changed_Value Field DEUDA_H.A_FAVOR to "N"
79746>>>>>    End_Procedure
79747>>>>>
79747>>>>>End_Class
79748>>>Use cDEUDA_D_DataDictionary.dd
Including file: cDEUDA_D_DataDictionary.dd    (C:\DataFlex Projects\PRESUPUESTO18\DDSrc\cDEUDA_D_DataDictionary.dd)
79748>>>>>Use DataDict.pkg
79748>>>>>
79748>>>>>Open DEUDA_D
79750>>>>>Open DEUDA_H
79752>>>>>
79752>>>>>Class cDEUDA_D_DataDictionary is a DataDictionary
79753>>>>>    
79753>>>>>    Procedure Construct_Object
79755>>>>>        Forward Send Construct_Object
79757>>>>>        Set Main_File to DEUDA_D.File_Number
79758>>>>>
79758>>>>>        Set Add_Server_File to DEUDA_H.File_Number
79759>>>>>
79759>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79760>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79761>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79762>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79763>>>>>
79763>>>>>        Set Field_Class_Name Field DEUDA_D.PAGADO_SN to "Checkbox"
79764>>>>>        Set Field_Checkbox_Values Field DEUDA_D.PAGADO_SN to "S" "N"
79765>>>>>
79765>>>>>    End_Procedure
79766>>>>>
79766>>>>>    Procedure Field_Defaults
79768>>>>>        Forward Send Field_Defaults
79770>>>>>        Set Field_Changed_Value Field DEUDA_D.PAGADO_SN to "N"
79771>>>>>    End_Procedure
79772>>>>>
79772>>>>>End_Class
79773>>>Use DFEntry.pkg
79773>>>Use cDbCJGrid.pkg
79773>>>Use cdbCJGridColumn.pkg
79773>>>Use DFEnChk.pkg
79773>>>
79773>>>Deferred_View Activate_Deudas for ;Object Deudas is a dbView
79798>>>    Procedure Request_Clear
79801>>>        Forward Send Request_Clear
79803>>>            Set Shadow_State of oDEUDA_H_CLAVE        to False
79804>>>            Set Shadow_State of oDEUDA_H_MONTO        to False
79805>>>            Set Shadow_State of oDEUDA_H_TIPO         to False 
79806>>>            Set Shadow_State of oDEUDA_H_FECHA_INICIO to False
79807>>>            Set Shadow_State of oDEUDA_H_FECHA_FIN    to False
79808>>>            Set Shadow_State of oDEUDA_H_DESCRIPCION  to False
79809>>>            Set Value of oTOTAL         to ''
79810>>>            Set Value of oTOTAL_PROYECT to ''
79811>>>    End_Procedure
79812>>>    
79812>>>    Procedure Request_Clear_All
79815>>>        Forward Send Request_Clear_All
79817>>>            Set Shadow_State of oDEUDA_H_CLAVE        to False
79818>>>            Set Shadow_State of oDEUDA_H_MONTO        to False
79819>>>            Set Shadow_State of oDEUDA_H_TIPO         to False 
79820>>>            Set Shadow_State of oDEUDA_H_FECHA_INICIO to False
79821>>>            Set Shadow_State of oDEUDA_H_FECHA_FIN    to False
79822>>>            Set Shadow_State of oDEUDA_H_DESCRIPCION  to False
79823>>>            Set Value of oTOTAL         to ''
79824>>>            Set Value of oTOTAL_PROYECT to ''
79825>>>    End_Procedure
79826>>>    
79826>>>    
79826>>>    Object oDEUDA_H_DD is a cDEUDA_H_DataDictionary
79828>>>        Procedure Relate_Main_File
79831>>>            Forward Send Relate_Main_File
79833>>>            
79833>>>            // SI ES A FAVOR LOS TOTALES SON CON DIFERENTE LOGICA 
79833>>>            If (DEUDA_H.A_FAVOR eq 'N') Send Totales
79836>>>            Else Send Totales2
79838>>>            
79838>>>            Set Shadow_State of oDEUDA_H_CLAVE        to True
79839>>>            Set Shadow_State of oDEUDA_H_MONTO        to True
79840>>>            Set Shadow_State of oDEUDA_H_TIPO         to True 
79841>>>            Set Shadow_State of oDEUDA_H_FECHA_INICIO to True
79842>>>            Set Shadow_State of oDEUDA_H_FECHA_FIN    to True
79843>>>            Set Shadow_State of oDEUDA_H_DESCRIPCION  to True
79844>>>        End_Procedure
79845>>>        
79845>>>    End_Object
79846>>>
79846>>>    Object oDEUDA_D_DD is a cDEUDA_D_DataDictionary
79848>>>        Set Constrain_file to DEUDA_H.File_number
79849>>>        Set DDO_Server to oDEUDA_H_DD
79850>>>        
79850>>>        
79850>>>        Procedure Request_Save 
79853>>>            Forward Send Request_Save
79855>>>                Move DEUDA_H.NUMERO to DEUDA_D.DEUDA_H
79856>>>        End_Procedure
79857>>>        
79857>>>    End_Object
79858>>>    
79858>>>    
79858>>>    //FUNCIONES Y PROCEDIMIENTOS
79858>>>    Procedure Totales 
79861>>>        Local String sQ
79861>>>        Local Handle hdbc69 hstmt69
79861>>>        Local Number nMonto nMontoEsp nTotalDeuda 
79861>>>    
79861>>>        Move '' to sQ
79862>>>        Move 0  to nMonto
79863>>>        Move 0  to nMontoEsp
79864>>>        Append sQ " SELECT SUM(MONTO) FROM DEUDA_D WHERE PAGADO_SN = 'S' AND DEUDA_H =  " DEUDA_H.NUMERO 
79866>>>        SQLFileConnect EGRESOS to hdbc69
79867>>>        SQLOpen hdbc69 to hstmt69
79870>>>        SQLExecDirect hstmt69 sQ
79873>>>        Repeat
79873>>>>
79873>>>           SQLFileFetch hstmt69
79879>>>           If (SQLResult) Begin
79881>>>              Get SQLColumnValue of hstmt69   1 to nMonto
79882>>>           End
79882>>>>
79882>>>        Until (not(SQLResult))
79884>>>        SQLClose hstmt69
79887>>>        SQLDisconnect hdbc69
79890>>>        
79890>>>        Move '' to sQ
79891>>>        Append sQ " SELECT SUM(MONTO_PROYECTADO) FROM DEUDA_D WHERE DEUDA_H =  " DEUDA_H.NUMERO 
79893>>>        SQLFileConnect EGRESOS to hdbc69
79894>>>        SQLOpen hdbc69 to hstmt69
79897>>>        SQLExecDirect hstmt69 sQ
79900>>>        Repeat
79900>>>>
79900>>>           SQLFileFetch hstmt69
79906>>>           If (SQLResult) Begin
79908>>>              Get SQLColumnValue of hstmt69   1 to nMontoEsp
79909>>>           End
79909>>>>
79909>>>        Until (not(SQLResult))
79911>>>        SQLClose hstmt69
79914>>>        SQLDisconnect hdbc69
79917>>>        
79917>>>        Get Value of oDEUDA_H_MONTO to nTotalDeuda
79918>>>        
79918>>>        Move (DEUDA_H.MONTO -nMonto)    to nMonto
79919>>>        Move (DEUDA_H.MONTO -nMontoEsp) to nMontoEsp
79920>>>        
79920>>>        Set Value of oTOTAL         to nMonto
79921>>>        Set Value of oTOTAL_PROYECT to nMontoEsp
79922>>>        Set Value of oTextDIFERENCIA to '--'
79923>>>        
79923>>>    End_Procedure
79924>>>    
79924>>>    
79924>>>    //FUNCIONES Y PROCEDIMIENTOS
79924>>>    Procedure Totales2 
79927>>>        Local String sQ
79927>>>        Local Handle hdbc69 hstmt69
79927>>>        Local Number nMonto nMontoEsp nTotalDeuda nDiferencia
79927>>>    
79927>>>        Move '' to sQ
79928>>>        Move 0  to nMonto
79929>>>        Move 0  to nMontoEsp
79930>>>        Append sQ " SELECT SUM(MONTO) FROM DEUDA_D WHERE PAGADO_SN = 'S' AND DEUDA_H =  " DEUDA_H.NUMERO 
79932>>>        SQLFileConnect EGRESOS to hdbc69
79933>>>        SQLOpen hdbc69 to hstmt69
79936>>>        SQLExecDirect hstmt69 sQ
79939>>>        Repeat
79939>>>>
79939>>>           SQLFileFetch hstmt69
79945>>>           If (SQLResult) Begin
79947>>>              Get SQLColumnValue of hstmt69   1 to nMonto
79948>>>           End
79948>>>>
79948>>>        Until (not(SQLResult))
79950>>>        SQLClose hstmt69
79953>>>        SQLDisconnect hdbc69
79956>>>        
79956>>>        Move '' to sQ
79957>>>        Append sQ " SELECT SUM(MONTO_PROYECTADO) FROM DEUDA_D WHERE DEUDA_H =  " DEUDA_H.NUMERO 
79959>>>        SQLFileConnect EGRESOS to hdbc69
79960>>>        SQLOpen hdbc69 to hstmt69
79963>>>        SQLExecDirect hstmt69 sQ
79966>>>        Repeat
79966>>>>
79966>>>           SQLFileFetch hstmt69
79972>>>           If (SQLResult) Begin
79974>>>              Get SQLColumnValue of hstmt69   1 to nMontoEsp
79975>>>           End
79975>>>>
79975>>>        Until (not(SQLResult))
79977>>>        SQLClose hstmt69
79980>>>        SQLDisconnect hdbc69
79983>>>        
79983>>>        Set Value of oTOTAL         to nMonto
79984>>>        Set Value of oTOTAL_PROYECT to nMontoEsp
79985>>>        Move (nMontoEsp-nMonto) to nDiferencia
79986>>>        Set Value of oTextDIFERENCIA to ("Pendiente: "+String(nDiferencia))
79987>>>        
79987>>>        
79987>>>        Reread DEUDA_H
79991>>>        Move nMontoEsp to DEUDA_H.MONTO
79992>>>        SaveRecord DEUDA_H
79993>>>        Unlock
79994>>>>
79994>>>        
79994>>>    End_Procedure
79995>>>
79995>>>    Set Main_DD to oDEUDA_H_DD
79996>>>    Set Server to oDEUDA_H_DD
79997>>>
79997>>>    Set Border_Style to Border_Thick
79998>>>    Set Size to 284 263
79999>>>    Set Location to 2 2
80000>>>    Set Label to "Deudas"
80001>>>    Set Delegation_Mode to No_Delegate_Or_Error
80002>>>    Set Color to 16641499
80003>>>
80003>>>    Object oDbContainer3d1 is a dbContainer3d
80005>>>        Set Size to 122 247
80006>>>        Set Location to 4 9
80007>>>        Set Color to clMenu
80008>>>
80008>>>        Object oDEUDA_H_NUMERO is a dbForm
80010>>>            Entry_Item DEUDA_H.NUMERO
80011>>>            Set Location to 4 56
80012>>>            Set Size to 12 66
80013>>>            Set Label to "NUMERO:"
80014>>>            Set Label_Col_Offset to 2
80015>>>            Set Label_Justification_Mode to JMode_Right
80016>>>        End_Object
80017>>>
80017>>>        Object oDEUDA_H_CLAVE is a dbForm
80019>>>            Entry_Item DEUDA_H.CLAVE
80020>>>            Set Location to 4 165
80021>>>            Set Size to 12 66
80022>>>            Set Label to "CLAVE:"
80023>>>            Set Label_Col_Offset to 2
80024>>>            Set Label_Justification_Mode to JMode_Right
80025>>>        End_Object
80026>>>
80026>>>        Object oDEUDA_H_DESCRIPCION is a dbForm
80028>>>            Entry_Item DEUDA_H.DESCRIPCION
80029>>>            Set Location to 52 55
80030>>>            Set Size to 12 176
80031>>>            Set Label to "DESCRIPCION:"
80032>>>            Set Label_Col_Offset to 2
80033>>>            Set Label_Justification_Mode to JMode_Right
80034>>>        End_Object
80035>>>
80035>>>        Object oDEUDA_H_MONTO is a dbForm
80037>>>            Entry_Item DEUDA_H.MONTO
80038>>>            Set Location to 20 56
80039>>>            Set Size to 12 66
80040>>>            Set Label to "MONTO:"
80041>>>            Set Label_Col_Offset to 2
80042>>>            Set Label_Justification_Mode to JMode_Right
80043>>>        End_Object
80044>>>
80044>>>        Object oDEUDA_H_FECHA_INICIO is a dbForm
80046>>>            Entry_Item DEUDA_H.FECHA_INICIO
80047>>>            Set Location to 36 56
80048>>>            Set Size to 12 66
80049>>>            Set Label to "FECHA INICIO:"
80050>>>            Set Label_Col_Offset to 2
80051>>>            Set Label_Justification_Mode to JMode_Right
80052>>>        End_Object
80053>>>
80053>>>        Object oDEUDA_H_FECHA_FIN is a dbForm
80055>>>            Entry_Item DEUDA_H.FECHA_FIN
80056>>>            Set Location to 36 165
80057>>>            Set Size to 12 66
80058>>>            Set Label to "FECHA FIN:"
80059>>>            Set Label_Col_Offset to 2
80060>>>            Set Label_Justification_Mode to JMode_Right
80061>>>        End_Object
80062>>>
80062>>>        Object oDEUDA_H_TIPO is a dbForm
80064>>>            Entry_Item DEUDA_H.TIPO
80065>>>            Set Location to 20 165
80066>>>            Set Size to 12 20
80067>>>            Set Label to "TIPO:"
80068>>>            Set Label_Col_Offset to 2
80069>>>            Set Label_Justification_Mode to JMode_Right
80070>>>        End_Object
80071>>>
80071>>>        Object oDbGroup1 is a dbGroup
80073>>>            Set Size to 43 225
80074>>>            Set Location to 66 7
80075>>>            Set Label to 'Totales'
80076>>>            Set Color to 16641499
80077>>>
80077>>>            Object oTextBox1 is a TextBox
80079>>>                Set Size to 9 38
80080>>>                Set Location to 11 18
80081>>>                Set Label to 'Proyect.'
80082>>>            End_Object
80083>>>            Object oTOTAL_PROYECT is a dbForm
80085>>>                Set Size to 13 68
80086>>>                Set Location to 8 48
80087>>>                Set Entry_State to False
80088>>>                Set Numeric_Mask 0 to 4 2
80089>>>                Set Color to 16744576
80090>>>            End_Object
80091>>>
80091>>>            Object oTextBox1 is a TextBox
80093>>>                Set Size to 9 19
80094>>>                Set Location to 27 23
80095>>>                Set Label to 'Pdgo.'
80096>>>            End_Object
80097>>>            Object oTOTAL is a dbForm
80099>>>                Set Size to 13 68
80100>>>                Set Location to 24 48
80101>>>                Set Entry_State to False
80102>>>                Set Color to 16776960
80103>>>                Set Numeric_Mask 0 to 4 2
80104>>>            End_Object
80105>>>
80105>>>            Object oTextDIFERENCIA is a TextBox
80107>>>                Set Auto_Size_State to False
80108>>>                Set Size to 10 83
80109>>>                Set Location to 25 125
80110>>>                Set Label to '--'
80111>>>                Set Color to 16641499
80112>>>                Set Justification_Mode to JMode_Right
80113>>>            End_Object
80114>>>        End_Object
80115>>>
80115>>>        Object oDEUDA_H_A_FAVOR is a dbCheckBox
80117>>>            Entry_Item DEUDA_H.A_FAVOR
80118>>>            Set Location to 22 192
80119>>>            Set Size to 10 60
80120>>>            Set Label to "A FAVOR"
80121>>>        End_Object
80122>>>    End_Object
80123>>>
80123>>>    Object oDbContainer3d2 is a dbContainer3d
80125>>>        Set Size to 154 247
80126>>>        Set Location to 131 9
80127>>>
80127>>>        Object oDbCJGrid1 is a cDbCJGrid
80129>>>            Set Server to oDEUDA_D_DD
80130>>>            Set Size to 157 236
80131>>>            Set Location to 5 3
80132>>>            Set piSelectedRowBackColor to 65535
80133>>>            Set piGridLineColor to clScrollBar
80134>>>            Set piSelectedRowForeColor to 65408
80135>>>            Set peVisualTheme to xtpReportThemeVisualStudio2012Light
80136>>>
80136>>>            Object oDEUDA_D_NUMERO is a cDbCJGridColumn
80138>>>                Entry_Item DEUDA_D.RENGLON
80139>>>                Set piWidth to 20
80140>>>                Set psCaption to "#"
80141>>>            End_Object
80142>>>
80142>>>            Object oDEUDA_H_DESCRIPCION1 is a cDbCJGridColumn
80144>>>                Entry_Item DEUDA_D.DESCRIPCION
80145>>>                Set piWidth to 131
80146>>>                Set psCaption to "Descripcion"
80147>>>            End_Object
80148>>>
80148>>>            Object oDEUDA_D_MONTO is a cDbCJGridColumn
80150>>>                Entry_Item DEUDA_D.MONTO
80151>>>                Set piWidth to 93
80152>>>                Set psCaption to "Monto"
80153>>>            End_Object
80154>>>
80154>>>            Object oDEUDA_D_MONTO_PROYECTADO is a cDbCJGridColumn
80156>>>                Entry_Item DEUDA_D.MONTO_PROYECTADO
80157>>>                Set piWidth to 84
80158>>>                Set psCaption to "Proyectado"
80159>>>            End_Object
80160>>>
80160>>>            Object oDEUDA_D_FECHA_REALIZADO is a cDbCJGridColumn
80162>>>                Entry_Item DEUDA_D.FECHA_REALIZADO
80163>>>                Set piWidth to 91
80164>>>                Set psCaption to "F. Realizado"
80165>>>            End_Object
80166>>>
80166>>>            Object oDEUDA_D_PAGADO_SN is a cDbCJGridColumn
80168>>>                Entry_Item DEUDA_D.PAGADO_SN
80169>>>                Set piWidth to 53
80170>>>                Set psCaption to "Pgdo?"
80171>>>                Set pbCheckbox to True
80172>>>            End_Object
80173>>>        End_Object
80174>>>    End_Object
80175>>>
80175>>>Cd_End_Object
80177>>>>
80177>        Set Bitmap of (oClientArea(oMain(Current_object))) to "logo_sid.bmp"
80178>        Set Bitmap_Style to Bitmap_Center
80179>        Use PRESUPUESTO.sl
80179>        Use TARJETA.vw
Including file: TARJETA.vw    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\TARJETA.vw)
80179>>>Use Windows.pkg
80179>>>Use DFClient.pkg
80179>>>Use cDbCJGrid.pkg
80179>>>Use TARJETA.dd
80179>>>Use cPRESUPUESTO_DataDictionary.dd
80179>>>Use cEGRESOSDataDictionary.dd
80179>>>Use cTIPO_GASTO_DataDictionary.dd
80179>>>Use cdbCJGridColumn.pkg
80179>>>Use DFEntry.pkg
80179>>>
80179>>>Deferred_View Activate_TARJETA for ;Object TARJETA is a dbView
80204>>>    Object oTIPO_GASTO_DD is a cTIPO_GASTO_DataDictionary
80206>>>    End_Object
80207>>>
80207>>>    Object oPRESUPUESTO_DD is a cPRESUPUESTODataDictionary
80209>>>    End_Object
80210>>>
80210>>>    Object oEGRESOS_DD is a cEGRESOSDataDictionary
80212>>>        Set DDO_Server to oPRESUPUESTO_DD
80213>>>        
80213>>>        Procedure OnConstrain
80216>>>            Forward Send OnConstrain
80218>>>                Local String @Filtro
80218>>>                Set pbUseDDSQLFilters to True
80219>>>                
80219>>>                Move " TC <> 0 AND FORMA_PAGO = 'TC'" to @Filtro
80220>>>                
80220>>>                Set psSQLFilter to @Filtro
80221>>>        End_Procedure
80222>>>        
80222>>>    End_Object
80223>>>
80223>>>    Object oTARJETA_DD is a TARJETA_DataDictionary
80225>>>    End_Object
80226>>>
80226>>>    Set Main_DD to oTARJETA_DD
80227>>>    Set Server to oTARJETA_DD
80228>>>
80228>>>    Set Border_Style to Border_Thick
80229>>>    Set Size to 217 479
80230>>>    Set Location to 2 2
80231>>>    Set Label to "TARJETA"
80232>>>    Set Color to 16641499
80233>>>
80233>>>    Object oDbContainer3d1 is a dbContainer3d
80235>>>        Set Size to 176 449
80236>>>        Set Location to 12 15
80237>>>
80237>>>        Object oDbGroup1 is a dbGroup
80239>>>            Set Size to 53 414
80240>>>            Set Location to 7 19
80241>>>            Set Label to "Tarjetas de Credito:"
80242>>>
80242>>>            Object oTARJETA_NUMERO is a dbForm
80244>>>                Use TARJETAS.sl
80244>>>                Entry_Item TARJETA.NUMERO
80245>>>                Set Location to 12 34
80246>>>                Set Size to 13 53
80247>>>                Set Label to "#"
80248>>>                Set Label_Justification_Mode to JMode_Right
80249>>>                Set Label_Col_Offset to 2
80250>>>                Set Prompt_Button_Mode to PB_PromptOn
80251>>>                Set Prompt_Object to TARJETAS_SL
80252>>>            End_Object
80253>>>            Object oTARJETA_CLAVE is a dbForm
80255>>>                Entry_Item TARJETA.CLAVE
80256>>>                Set Location to 28 34
80257>>>                Set Size to 13 53
80258>>>                Set Label to "Clave:"
80259>>>                Set Label_Col_Offset to 2
80260>>>                Set Label_Justification_Mode to JMode_Right
80261>>>            End_Object
80262>>>
80262>>>            Object oTARJETA_DESCRIPCION is a dbForm
80264>>>                Entry_Item TARJETA.DESCRIPCION
80265>>>                Set Location to 28 145
80266>>>                Set Size to 13 124
80267>>>                Set Label to "Descripcion:"
80268>>>                Set Label_Col_Offset to 2
80269>>>                Set Label_Justification_Mode to JMode_Right
80270>>>            End_Object
80271>>>
80271>>>            Object oTARJETA_LIMITE is a dbForm
80273>>>                Entry_Item TARJETA.LIMITE
80274>>>                Set Location to 12 145
80275>>>                Set Size to 13 33
80276>>>                Set Label to "Limite TC:"
80277>>>                Set Label_Col_Offset to 2
80278>>>                Set Label_Justification_Mode to JMode_Right
80279>>>            End_Object
80280>>>
80280>>>            Object oTARJETA_LIMITE_MAX is a dbForm
80282>>>                Entry_Item TARJETA.LIMITE_MAX
80283>>>                Set Location to 11 235
80284>>>                Set Size to 13 33
80285>>>                Set Label to "Limite Personal:"
80286>>>                Set Label_Col_Offset to 2
80287>>>                Set Label_Justification_Mode to JMode_Right
80288>>>            End_Object
80289>>>
80289>>>            Object oTARJETA_DIA_PAGO is a dbForm
80291>>>                Entry_Item TARJETA.DIA_PAGO
80292>>>                Set Location to 11 319
80293>>>                Set Size to 13 54
80294>>>                Set Label to "D¡a Pago:"
80295>>>                Set Label_Col_Offset to 2
80296>>>                Set Label_Justification_Mode to JMode_Right
80297>>>            End_Object
80298>>>
80298>>>            Object oTARJETA_DIA_CORTE is a dbForm
80300>>>                Entry_Item TARJETA.DIA_CORTE
80301>>>                Set Location to 28 319
80302>>>                Set Size to 13 54
80303>>>                Set Label to "D¡a Corte:"
80304>>>                Set Label_Col_Offset to 2
80305>>>                Set Label_Justification_Mode to JMode_Right
80306>>>            End_Object
80307>>>        End_Object
80308>>>
80308>>>        Object oDbGroup2 is a dbGroup
80310>>>            Set Size to 104 414
80311>>>            Set Location to 61 18
80312>>>            Set Label to 'Movimientos'
80313>>>
80313>>>            Object oDbCJGrid1 is a cDbCJGrid
80315>>>                Set Server to oEGRESOS_DD
80316>>>                Set Size to 81 397
80317>>>                Set Location to 14 11
80318>>>
80318>>>                Object oEGRESOS_TIPO is a cDbCJGridColumn
80320>>>                    Entry_Item EGRESOS.TIPO
80321>>>                    Set piWidth to 41
80322>>>                    Set psCaption to "Tipo"
80323>>>                End_Object
80324>>>
80324>>>                Object oEGRESOS_DESCRIPCION is a cDbCJGridColumn
80326>>>                    Entry_Item EGRESOS.DESCRIPCION
80327>>>                    Set piWidth to 153
80328>>>                    Set psCaption to "Descripcion"
80329>>>                End_Object
80330>>>
80330>>>                Object oEGRESOS_FECHA_REALIZADO is a cDbCJGridColumn
80332>>>                    Entry_Item EGRESOS.FECHA_REALIZADO
80333>>>                    Set piWidth to 83
80334>>>                    Set psCaption to "F.Realizado"
80335>>>                End_Object
80336>>>
80336>>>//                Object oEGRESOS_ES_FIJO_SN is a cDbCJGridColumn
80336>>>//                    Entry_Item EGRESOS.ES_FIJO_SN
80336>>>//                    Set piWidth to 38
80336>>>//                    Set psCaption to "Fijo?"
80336>>>//                    Set pbCheckbox to True
80336>>>//                End_Object
80336>>>
80336>>>//                Object oEGRESOS_MONTO is a cDbCJGridColumn
80336>>>//                    Entry_Item EGRESOS.MONTO
80336>>>//                    Set piWidth to 72
80336>>>//                    Set psCaption to "Pagado"
80336>>>//                End_Object
80336>>>
80336>>>                Object oEGRESOS_MONTO is a cDbCJGridColumn
80338>>>                    Entry_Item EGRESOS.MONTO
80339>>>                    Set piWidth to 80
80340>>>                    Set psCaption to "Pagado"
80341>>>                End_Object
80342>>>
80342>>>                Object oEGRESOS_PRESUPUESTO is a cDbCJGridColumn
80344>>>                    Entry_Item PRESUPUESTO.NUMERO
80345>>>                    Set piWidth to 87
80346>>>                    Set psCaption to "Presupuesto"
80347>>>                End_Object
80348>>>
80348>>>//                Object oEGRESOS_PAGADO_SN is a cDbCJGridColumn
80348>>>//                    Entry_Item EGRESOS.PAGADO_SN
80348>>>//                    Set piWidth to 60
80348>>>//                    Set psCaption to "Pgdo?"
80348>>>//                    Set pbCheckbox to True
80348>>>//                End_Object
80348>>>
80348>>>                Object oEGRESOS_LIQUIDAR is a cDbCJGridColumn
80350>>>                    Entry_Item EGRESOS.LIQUIDAR
80351>>>                    Set piWidth to 96
80352>>>                    Set psCaption to "Liquidar"
80353>>>                    Set pbCheckbox to True
80354>>>                End_Object
80355>>>
80355>>>                Object oEGRESOS_LIQUIDADO is a cDbCJGridColumn
80357>>>                    Entry_Item EGRESOS.LIQUIDADO
80358>>>                    Set piWidth to 84
80359>>>                    Set psCaption to "Liquidado"
80360>>>                    Set pbCheckbox to True
80361>>>                End_Object
80362>>>            End_Object
80363>>>        End_Object
80364>>>    End_Object
80365>>>
80365>>>Cd_End_Object
80367>>>>
80367>        Use movimientos.vw
Including file: movimientos.vw    (C:\DataFlex Projects\PRESUPUESTO18\AppSrc\movimientos.vw)
80367>>>Use Windows.pkg
80367>>>Use DFClient.pkg
80367>>>Use cTIPO_GASTO_DataDictionary.dd
80367>>>Use cPRESUPUESTO_DataDictionary.dd
80367>>>Use cEGRESOSDataDictionary.dd
80367>>>Use SUB_EGRESOS.dd
80367>>>Use DFEntry.pkg
80367>>>Use dfTable.pkg
80367>>>
80367>>>Deferred_View Activate_movimientos for ;Object movimientos is a dbView
80392>>>    Object oPRESUPUESTO_DD is a cPRESUPUESTODataDictionary
80394>>>    End_Object
80395>>>
80395>>>    Object oTIPO_GASTO_DD is a cTIPO_GASTO_DataDictionary
80397>>>    End_Object
80398>>>
80398>>>    Object oEGRESOS_DD is a cEGRESOSDataDictionary
80400>>>        Set DDO_Server to oPRESUPUESTO_DD
80401>>>        Set DDO_Server to oTIPO_GASTO_DD
80402>>>    End_Object
80403>>>
80403>>>    Object oSUB_EGRESOS_DD is a SUB_EGRESOS_DataDictionary
80405>>>        Set Constrain_file to EGRESOS.File_number
80406>>>        Set DDO_Server to oEGRESOS_DD
80407>>>    End_Object
80408>>>
80408>>>    Set Main_DD to oEGRESOS_DD
80409>>>    Set Server to oEGRESOS_DD
80410>>>
80410>>>    Set Border_Style to Border_Thick
80411>>>    Set Size to 233 497
80412>>>    Set Location to 1 2
80413>>>    Set Label to "movimientos"
80414>>>
80414>>>    Object oPRESUPUESTO_NUMERO is a dbForm
80416>>>        Entry_Item PRESUPUESTO.NUMERO
80417>>>        Set Location to 6 82
80418>>>        Set Size to 13 66
80419>>>        Set Label to "NUMERO:"
80420>>>        Set Prompt_Object to PRESUPUESTO_SL
80421>>>        Set Prompt_Button_Mode to PB_PromptOn
80422>>>    End_Object
80423>>>
80423>>>    Object oDbGrid1 is a dbGrid
80425>>>        Set Size to 100 470
80426>>>        Set Location to 25 13
80427>>>
80427>>>        Begin_Row
80430>>>            Entry_Item EGRESOS.NUMERO
80431>>>            Entry_Item TIPO_GASTO.CLAVE
80432>>>            Entry_Item EGRESOS.DESCRIPCION
80433>>>            Entry_Item EGRESOS.FECHA_REALIZADO
80434>>>            Entry_Item EGRESOS.MONTO
80435>>>            Entry_Item EGRESOS.MONTO_PROYECTADO
80436>>>        End_Row
80441>>>
80441>>>        Set Main_File to EGRESOS.File_Number
80442>>>
80442>>>        Set Form_Width 0 to 45
80443>>>        Set Header_Label 0 to "NUMERO"
80444>>>        Set Form_Width 1 to 52
80445>>>        Set Header_Label 1 to "TIPO"
80446>>>        Set Form_Width 2 to 105
80447>>>        Set Header_Label 2 to "DESCRIPCION"
80448>>>        Set Form_Width 3 to 60
80449>>>        Set Header_Label 3 to "FECHA REALIZADO"
80450>>>        Set Form_Width 4 to 72
80451>>>        Set Header_Label 4 to "MONTO"
80452>>>        Set Form_Width 5 to 72
80453>>>        Set Header_Label 5 to "MONTO PROYECTADO"
80454>>>    End_Object
80455>>>
80455>>>    Object oDbGrid2 is a dbGrid
80457>>>        Set Size to 67 458
80458>>>        Set Location to 135 18
80459>>>
80459>>>        Begin_Row
80462>>>            Entry_Item SUB_EGRESOS.NUMERO
80463>>>            Entry_Item SUB_EGRESOS.DESCRIPCION
80464>>>            Entry_Item SUB_EGRESOS.MONTO
80465>>>            Entry_Item SUB_EGRESOS.FECHA_REALIZADO
80466>>>        End_Row
80471>>>
80471>>>        Set Main_File to SUB_EGRESOS.File_Number
80472>>>
80472>>>        Set Server to oSUB_EGRESOS_DD
80473>>>
80473>>>        Set Form_Width 0 to 60
80474>>>        Set Header_Label 0 to "NUMERO"
80475>>>        Set Form_Width 1 to 239
80476>>>        Set Header_Label 1 to "DESCRIPCION"
80477>>>        Set Form_Width 2 to 72
80478>>>        Set Header_Label 2 to "MONTO"
80479>>>        Set Form_Width 3 to 69
80480>>>        Set Header_Label 3 to "FECHA REALIZADO"
80481>>>    End_Object
80482>>>
80482>>>Cd_End_Object
80484>>>>
80484>
80484>        Procedure Activate_About
80487>            Send DoAbout "" "" "" "" ""
80488>        End_Procedure
80489>
80489>    End_Object
80490>
80490>End_Object
80491>
80491>
80491>Send Activate_Egresos to (oClientArea(oMain(Current_object)))
80492>
80492>Start_UI
80493>
Summary
Memory Available: 2147483647
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 45212
Total Resources: 0
Total Commands : 80492
Total Windows  : 1
Total Pages    : 1
Static Data    : 493787
Message area   : 563688
Total Blocks   : 28829
